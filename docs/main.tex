% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Ling 411 - Fall 2024},
  pdfauthor={Ümit Atlamaz},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Ling 411 - Fall 2024}
\author{Ümit Atlamaz}
\date{2024-12-16}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Seed for random number generation}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{42}\NormalTok{)}
\NormalTok{knitr}\SpecialCharTok{::}\NormalTok{opts\_chunk}\SpecialCharTok{$}\FunctionTok{set}\NormalTok{(}\AttributeTok{cache.extra =}\NormalTok{ knitr}\SpecialCharTok{::}\NormalTok{rand\_seed, }\AttributeTok{class.output=}\StringTok{"r{-}output"}\NormalTok{)}
\FunctionTok{source}\NormalTok{(}\StringTok{"./source/r\_functions.R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\chapter{Getting Started}\label{getting-started}

Welcome to the R tutorial for Ling 411. The purpose of these lecture notes is to help remind you some of the R related material we covered in the class. The material here is not intended to be complete and self-contained. These are just lecture notes. You need to attend the classes and Problem Sessions to get a full grasp of the concepts.

\section{Disclaimer}\label{disclaimer}

Some of the material in this book are from \href{https://scholar.google.com/citations?user=fhbdTJIAAAAJ&hl=tr}{Pavel Logaçev}'s class notes for LING 411. I'm indebted to Pavel for his friendship, guidance and support. Without him LING 411 could not exist in its current form.

\section{Some great resources}\label{some-great-resources}

\begin{itemize}
\tightlist
\item
  Throughout the semester, I will draw on from the following resources. These are just useful resources and feel free to take a look at them as you wish.

  \begin{itemize}
  \tightlist
  \item
    Bodo Winter's excellent book: \href{https://www.routledge.com/Statistics-for-Linguists-An-Introduction-Using-R/Winter/p/book/9781138056091}{Statistics for Linguists: An Introduction Using R}
  \item
    The great introduction materials developed at the University of Glasgow: \url{https://psyteachr.github.io/}, in particular \href{https://psyteachr.github.io/msc-data-skills/}{`Data Skills for Reproducible Science'}.
  \item
    The also pretty great introduction to R and statistics by Danielle Navarro available \href{https://learningstatisticswithr.com}{here}.
  \item
    Matt Crump's \href{https://crumplab.github.io/statistics/}{`Answering Questions with Data'}.
  \item
    Primers on a variety of topics: \url{https://rstudio.cloud/learn/primers}
  \item
    Cheat sheets on a variety of topics: \url{https://rstudio.cloud/learn/cheat-sheets}
  \end{itemize}
\item
  The following tutorials are great too.

  \begin{itemize}
  \tightlist
  \item
    \href{https://rstudio-education.github.io/tidyverse-cookbook/}{`The Tidyverse Cookbook'}
  \item
    \href{https://cedricscherer.netlify.app/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/}{`A Ggplot2 Tutorial for Beautiful Plotting in R'}
  \item
    \href{https://r-graphics.org/}{`R Graphics Cookbook, 2nd edition'}
  \end{itemize}
\end{itemize}

\section{Blocks}\label{blocks}

Code, output, and special functions will be shown in designated boxes. The first box below illustrates a \textbf{code block}. The code block contains code that you can type in your R interpreter as the source code. You can simply copy and paste it in your R code. The second box indicates the \textbf{output} of R given the code in the first box.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{+}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 4}
\end{Highlighting}
\end{Shaded}

Functions will be introduced in grey boxes. The following grey box describes the \texttt{summary()} function.

\texttt{summary(x)}

Returns the summary statistics of a dataframe.

\begin{itemize}
\tightlist
\item
  \texttt{x} A dataframe.
\end{itemize}

\hfill\break
\hfill\break
The following code block uses the \texttt{summary()} function on the \texttt{mtcars} dataframe that comes pre-installed with R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(mtcars)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#       mpg             cyl             disp             hp       }
\NormalTok{\#\#  Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  }
\NormalTok{\#\#  1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  }
\NormalTok{\#\#  Median :19.20   Median :6.000   Median :196.3   Median :123.0  }
\NormalTok{\#\#  Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  }
\NormalTok{\#\#  3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  }
\NormalTok{\#\#  Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  }
\NormalTok{\#\#       drat             wt             qsec             vs        }
\NormalTok{\#\#  Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  }
\NormalTok{\#\#  1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  }
\NormalTok{\#\#  Median :3.695   Median :3.325   Median :17.71   Median :0.0000  }
\NormalTok{\#\#  Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  }
\NormalTok{\#\#  3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  }
\NormalTok{\#\#  Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  }
\NormalTok{\#\#        am              gear            carb      }
\NormalTok{\#\#  Min.   :0.0000   Min.   :3.000   Min.   :1.000  }
\NormalTok{\#\#  1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  }
\NormalTok{\#\#  Median :0.0000   Median :4.000   Median :2.000  }
\NormalTok{\#\#  Mean   :0.4062   Mean   :3.688   Mean   :2.812  }
\NormalTok{\#\#  3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  }
\NormalTok{\#\#  Max.   :1.0000   Max.   :5.000   Max.   :8.000}
\end{Highlighting}
\end{Shaded}

\hfill\break
If you want to learn more about the \texttt{mtcars} dataset, you can simply put a question mark in front of its name, which will show the documentation for the dataset. The documentation will pop up in the \texttt{Help} tab on the bottom right window in RStudio.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?mtcars}
\end{Highlighting}
\end{Shaded}

\chapter{Basics}\label{basics}

You can think of R as a fancy calculator. We could do almost all of the operations we do in R on a calculator. However, that would take a lot of time and effort when we are dealing with a large amount of data. That's (partly) why we're using R. I hope this helps those who might have a bit of anxiety about coding.

You should also note that everything we do in R can also be done in other programming languages. However, R is used a lot by data analysts and statisticians. It is relatively easier to use for data analysis and there are lots of libraries (code someone else has written that makes our life easier) that come quite handy.

Without further ado, let's dive in.

\section{Basic Math Operations}\label{basic-math-operations}

You can use R to make carry out basic mathematical operations.

\textbf{Addition}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{+}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 4}
\end{Highlighting}
\end{Shaded}

\textbf{Subtraction}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{4{-}2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

\textbf{Multiplication}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{47}\SpecialCharTok{*}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 141}
\end{Highlighting}
\end{Shaded}

\textbf{Division}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{9}\SpecialCharTok{/}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2.25}
\end{Highlighting}
\end{Shaded}

\textbf{Floor Division}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{9}\SpecialCharTok{\%/\%}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

\textbf{Exponentiation}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{\^{}}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 8}
\end{Highlighting}
\end{Shaded}

\section{Operators}\label{operators}

You can use basic mathematical operators in R.

\textbf{Equals}

\texttt{==} is the equals operator. Notice that this is distinct from the \texttt{=} operator we are used to. The latter is used for variable assignment in R. We won't use it. When you run \texttt{2==2}, R will evaluate this statement and return \texttt{TRUE} of \texttt{FALSE}.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{==} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] TRUE}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{==} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] FALSE}
\end{Highlighting}
\end{Shaded}

\textbf{Not Equal}

\texttt{!=} is the not equal operator.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{!=}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] FALSE}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{!=}\DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] TRUE}
\end{Highlighting}
\end{Shaded}

\textbf{Other logical operators}

\texttt{\textless{}},\texttt{\textgreater{}},\texttt{\textless{}=},\texttt{\textgreater{}=}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{\textless{}}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] TRUE}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{\textgreater{}}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] FALSE}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{\textless{}=}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] TRUE}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{\textgreater{}=}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] FALSE}
\end{Highlighting}
\end{Shaded}

\section{Variables and Assignment}\label{variables-and-assignment}

In R (like in many programming languages), values can be assigned to a variable to be used later. For example, you might want to store someone's age in a variable and then use it later for some purpose. In R, variables created via assignment \texttt{\textless{}-}. The following code creates a variable called \emph{alex} and assigns it the value 35. Let's assume that this is Alex's age.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alex }\OtherTok{\textless{}{-}} \DecValTok{35}
\end{Highlighting}
\end{Shaded}

Next time you want to do anything with the age, you can simply call the variable \emph{alex} and do whatever you want with it (e.g.~print, multiply, reassign, etc.). For example, the following code simply prints the value of the \emph{alex} variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alex}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 35}
\end{Highlighting}
\end{Shaded}

The following code multiples it by 2.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alex }\SpecialCharTok{*} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 70}
\end{Highlighting}
\end{Shaded}

Now assume that Alex's friend Emma's is 2 years younger than Alex. Let's assign Emma's age by subtracting 2 from Alex' age. In the following code block, the first line creates the variable \emph{emma} and assigns it the value \texttt{alex\ -\ 2}. The second line simply prints the value of the variable \emph{emma}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{emma }\OtherTok{\textless{}{-}}\NormalTok{ alex }\SpecialCharTok{{-}} \DecValTok{2}
\NormalTok{emma}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 33}
\end{Highlighting}
\end{Shaded}

A variable can hold different \textbf{types} of data. In the previous examples, we assigned \textbf{integers} to variables. We can also assign characters, vectors, etc.

\textbf{character}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{name }\OtherTok{\textless{}{-}} \StringTok{"emma"}
\NormalTok{name}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "emma"}
\end{Highlighting}
\end{Shaded}

\textbf{vector}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{age\_list }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{35}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{age\_list}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 35 27 48 10}
\end{Highlighting}
\end{Shaded}

\section{Data Types}\label{data-types}

In R, values have \textbf{types}:

\begin{longtable}[]{@{}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2667}}
  >{\centering\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7333}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedleft
Data Type
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Examples
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Integer (Numeric): & \ldots, -3, -2, -1, 0, +1, +2, +3, \ldots{} \\
Double (Numeric): & most rational numbers; e.g., 1.0, 1.5, 20.0, pi \\
Character: & \texttt{"a"}, \texttt{"b"}, \texttt{"word"}, \texttt{"hello\ dear\ friend,\ ..."} \\
Logical: & \texttt{TRUE} or \texttt{FALSE} (or: \texttt{T} or \texttt{F} ) \\
Factor: & Restricted, user-defined set of values, internally represented numerically (e.g., Gender \{`male', `female', `other'\}) \\
Ordered factor: & Factor with an ordering (e.g., Starbucks coffee sizes \{`venti' \textgreater{} `grande' \textgreater{} `tall'\}) \\
\end{longtable}

You need to understand the data types well as some operations are defined only on some data types. For example, you can add two integers or doubles but you cannot add an integer with a character.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_integer\_1 }\OtherTok{\textless{}{-}} \FunctionTok{as.integer}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{my\_integer\_2 }\OtherTok{\textless{}{-}} \FunctionTok{as.integer}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\NormalTok{my\_character }\OtherTok{\textless{}{-}} \StringTok{"two"}
\NormalTok{my\_double }\OtherTok{\textless{}{-}} \FloatTok{2.2}
\end{Highlighting}
\end{Shaded}

Adding, multiplying, deducting, etc. two integers is fine. So is combining two doubles or a double with an integer.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_integer\_1 }\SpecialCharTok{+}\NormalTok{ my\_integer\_2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 7}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_integer\_1 }\SpecialCharTok{*}\NormalTok{ my\_double}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 4.4}
\end{Highlighting}
\end{Shaded}

However, combining an integer with a character will lead to an error. You should read the errors carefully as they will help you understand where things went wrong.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_integer\_1 }\SpecialCharTok{+}\NormalTok{ my\_character}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in my_integer_1 + my_character: non-numeric argument to binary operator
\end{verbatim}

\section{Determining the data type}\label{determining-the-data-type}

If you don't know the type of some data, you can use the \texttt{typeof()} function to get the type of a particular data item.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(my\_double)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "double"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(my\_integer\_1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "integer"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(my\_character)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "character"}
\end{Highlighting}
\end{Shaded}

\section{Changing the types}\label{changing-the-types}

You can change the type of a data item as long as the data is compatible with the type. For example, you can change an integer to a double.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.double}\NormalTok{(my\_integer\_2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.integer}\NormalTok{(my\_double)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

You can also change a character into an integer if it is a compatible value.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.integer}\NormalTok{(}\StringTok{"2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

However, you cannot change any character into an integer.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.integer}\NormalTok{(}\StringTok{"two"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: NAs introduced by coercion
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] NA}
\end{Highlighting}
\end{Shaded}

\section{Installing packages}\label{installing-packages}

Packages of code written by other developers for particular needs. They save you a lot of time and effort in carrying out your jobs. All you have to do is to find the right package for your task and learn what the package is capable of and how it works. In this class, we will use several packages that will simplify our lives.

To install a package, simply run \texttt{install.packages("your\_package\_name")}. For example, we will make use of the \texttt{tidyverse} package. The official CRAN page for tidyverse is \href{https://cran.r-project.org/package=tidyverse}{here}. This is a more user friendly \href{https://www.tidyverse.org}{link} about tidyverse. Finally, \href{https://bookdown.org/yih_huynh/Guide-to-R-Book/tidyverse.html}{this is a bookdown} version that looks helpful.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{\textquotesingle{}tidyverse\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

You need to install a package once. For this reason, you can use the console (bottom left window RStudio) rather than a script (top left window in RStudio). However, either way should work.

Once you install a package, you need to load it before you can use its functions. Just use \texttt{library(package\_name)} to load the package. The convention is to load all the packages you will use at the beginning of your script. For example, we can import the \texttt{tidyverse} package as follows.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.3     v readr     2.1.4
## v forcats   1.0.0     v stringr   1.5.0
## v ggplot2   3.4.3     v tibble    3.2.1
## v lubridate 1.9.2     v tidyr     1.3.0
## v purrr     1.0.2     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

Tidyverse is a package that contains many useful packages including \texttt{ggplot2} (used for plotting), \texttt{tibble} (used for efficient dataframes) etc. We will dedicate a chapter to tidyverse but feel free to learn about as you like.

\section{Plotting}\label{plotting}

When you are analyzing data, plots are very useful to package information visually. There are various packages that help build nice plots. In this class, we will use the \texttt{ggplot2} package for plotting. You might have notices in the output box above that loading \texttt{tidyverse} automatically loads \texttt{ggplot2} as well. We can go ahead and use the \texttt{ggplot2} functions without having to import it again. If we hadn't imported \texttt{tidyverse}, then we would have to load \texttt{ggplot2} to use its functionality.

Let us start with a simple plot for a linear function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let us create a simple data set that satisfies the linear function y = 2x + 1}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{*}\NormalTok{x}\SpecialCharTok{+}\DecValTok{1}

\CommentTok{\# print x and y to see what it looks like}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  1  2  3  4  5  6  7  8  9 10}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  3  5  7  9 11 13 15 17 19 21}
\end{Highlighting}
\end{Shaded}

Let us now plot the data as points.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(x,y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-36-1.pdf}

Let us now plot a line to make our plot more informative and better looking.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let us now plot x and y using ggplot2}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(x,y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-37-1.pdf}

Notice that playing with the scale sizes will yield dramatic changes in the effects we observe. For this, we can simply use the \texttt{xlim()} and \texttt{ylim()} functions to identify the lower and upper limits of x and y axes.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(x,y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{xlim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{15}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-38-1.pdf}

Let us now plot a quadratic function. A quadratic function is one where the base is a variable and the exponent is constant. The following graph plots \texttt{n\^{}2}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let us now plot a and b using ggplot2}

\NormalTok{a}\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{b }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(a,b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{formula =}\NormalTok{ y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x }\SpecialCharTok{+}\FunctionTok{I}\NormalTok{(x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{), }\AttributeTok{color=}\StringTok{\textquotesingle{}orange\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-39-1.pdf}

Finally, we can plot an exponential function where the variable is the exponent and the base is constant.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let us now plot a and b using ggplot2}

\NormalTok{a}\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(a)}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(a,b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{color =} \StringTok{"orange"}\NormalTok{,}\AttributeTok{formula=}\NormalTok{ (y }\SpecialCharTok{\textasciitilde{}} \FunctionTok{exp}\NormalTok{(x)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-40-1.pdf}

You can mix and match.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let us now plot x and y using ggplot2}
\NormalTok{a}\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{b}\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(x,y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(a,b), }\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula =}\NormalTok{ y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x }\SpecialCharTok{+}\FunctionTok{I}\NormalTok{(x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{),}\AttributeTok{color=} \StringTok{\textquotesingle{}orange\textquotesingle{}}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-41-1.pdf}

\section{Operators and functions in this section}\label{operators-and-functions-in-this-section}

\subsection{Operators}\label{operators-1}

\texttt{x\ +\ y}

Addition

\texttt{x\ -\ y}

Subtraction

\texttt{x\ *\ y}

Multiplication

\texttt{x\ /\ y}

Division

\texttt{x\^{}y}

Exponentiation

\texttt{x\ \textless{}-\ y}

Assignment

\texttt{==}

Test for equality. \textbf{Don't confuse with a single =, which is an assignment operator (and also always returns TRUE).}

\texttt{!=}

Test for inequality

\texttt{\textless{}}

Test, smaller than

\texttt{\textgreater{}}

Test, greater than

\texttt{\textless{}=}

Test, smaller than or equal to

\texttt{\textgreater{}=}

Test, greater than or equal to

\subsection{Functions}\label{functions}

\texttt{install.packages(package\_name)}

Installs one or several package(s).
The argument \texttt{package\_name} can either be a character (\texttt{install.packages(\textquotesingle{}dplyr\textquotesingle{})}) like or a character vector (\texttt{install.packages(c(\textquotesingle{}dplyr\textquotesingle{},\textquotesingle{}ggplot2\textquotesingle{}))}).

\texttt{library(package\_name)}

Loads a package called \texttt{package\_name}.

\hfill\break

\texttt{typeof(x)}

Determines the type of a variable/vector.

\hfill\break

\texttt{as.double(x)}

Converts a variable/vector to type \textbf{double}.

\chapter{Data Structures}\label{data-structures}

\section{Data Types in R}\label{data-types-in-r}

In R, value has a \emph{type}:

\begin{longtable}[]{@{}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2667}}
  >{\centering\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7333}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedleft
Data Type
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Examples
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Integer (Numeric): & \ldots, -3, -2, -1, 0, +1, +2, +3, \ldots{} \\
Double (Numeric): & most rational numbers; e.g., 1.0, 1.5, 20.0, pi \\
Character: & \texttt{"a"}, \texttt{"b"}, \texttt{"word"}, \texttt{"hello\ dear\ friend,\ ..."} \\
Logical: & \texttt{TRUE} or \texttt{FALSE} (or: \texttt{T} or \texttt{F} ) \\
Factor: & Restricted, user-defined set of values, internally represented numerically (e.g., Gender \{`male', `female', `other'\}) \\
Ordered factor: & Factor with an ordering (e.g., Starbucks coffee sizes \{`venti' \textgreater{} `grande' \textgreater{} `tall'\}) \\
\end{longtable}

\section{Data Structures in R}\label{data-structures-in-r}

\begin{itemize}
\item
  All values in R are organized in data structures. Structures differ in their number of dimensions and in whether they allow mixed data types.
\item
  In this course, we will mainly use vectors and data frames.
\end{itemize}

\begin{longtable}[]{@{}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1667}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.3571}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedleft
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
dimensions
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
types
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Vector & 1-dimensional & one type & \includegraphics[width=0.25\textwidth,height=\textheight]{img/vector.jpg} \\
Matrix & 2-dimensional & one type & \includegraphics[width=0.2\textwidth,height=\textheight]{img/matrix.jpg} \\
Array & n-dimensional & one type & \includegraphics[width=0.2\textwidth,height=\textheight]{img/array.jpg} \\
Data frame (or tibble) & 2-dimensional & mixed types & \includegraphics[width=0.2\textwidth,height=\textheight]{img/data_frame.jpg} \\
List & 1-dimensional & mixed types & \includegraphics[width=0.5\textwidth,height=\textheight]{img/list.jpg} \\
\end{longtable}

(Illustrations from Gaurav Tiwari's article on medium \href{https://medium.com/@tiwarigaurav2512/r-data-types-847fffb01d5b}{here}.)

\begin{itemize}
\tightlist
\item
  Let's look at some examples
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create and print vectors, don\textquotesingle{}t save}
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{, }\DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1]    1    2 1000}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{, }\DecValTok{1000}\NormalTok{, pi)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1]    1.000000    2.000000 1000.000000    3.141593}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 1 2 3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create and print a data.frame}
\FunctionTok{data.frame}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   X1.3}
\NormalTok{\#\# 1    1}
\NormalTok{\#\# 2    2}
\NormalTok{\#\# 3    3}
\end{Highlighting}
\end{Shaded}

\section{Vectors}\label{vectors}

\begin{itemize}
\tightlist
\item
  Vectors are simply ordered lists of elements, where every element has the same type.
\item
  They are useful for storing sets or sequences of numbers.
\item
  Let's create a simple vector with all integers from 1 to 8 and look at its contents.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vector\_var }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{vector\_var}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 1 2 3 4 5 6 7 8}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  There is even a more elegant ways to do that:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vector\_var }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{8}
\NormalTok{vector\_var}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 1 2 3 4 5 6 7 8}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Now, let's create a simple vector with integers between 1 and 8, going in steps of 2.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vector\_var }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{8}\NormalTok{, }\AttributeTok{by=}\DecValTok{2}\NormalTok{)}
\NormalTok{vector\_var}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 1 3 5 7}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Some useful vectors already exist in R.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{letters}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"}
\NormalTok{\#\# [20] "t" "u" "v" "w" "x" "y" "z"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LETTERS}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S"}
\NormalTok{\#\# [20] "T" "U" "V" "W" "X" "Y" "Z"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  We can select specific elements of a vector by indexing it with \texttt{{[}{]}}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# the first letter}
\NormalTok{letters[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "a"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# the 13{-}th letter}
\NormalTok{letters[}\DecValTok{13}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "m"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Indices can be vectors too.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# both of them}
\NormalTok{letters[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{7}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "a" "g"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  We can even take a whole \emph{`slice'} of a vector.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# both of them}
\NormalTok{letters[}\DecValTok{6}\SpecialCharTok{:}\DecValTok{12}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "f" "g" "h" "i" "j" "k" "l"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Indices can even be negative. A negative index \(-n\) means \emph{`everything' except \(n\)}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# both of them}
\NormalTok{letters[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s" "t"}
\NormalTok{\#\# [20] "u" "v" "w" "x" "y" "z"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Vectors can be named.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{digits }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}one\textquotesingle{}}\OtherTok{=}\DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}two\textquotesingle{}}\OtherTok{=}\DecValTok{2}\NormalTok{, }\StringTok{\textquotesingle{}three\textquotesingle{}}\OtherTok{=}\DecValTok{3}\NormalTok{, }\StringTok{\textquotesingle{}four\textquotesingle{}}\OtherTok{=}\DecValTok{4}\NormalTok{, }\StringTok{\textquotesingle{}five\textquotesingle{}}\OtherTok{=}\DecValTok{5}\NormalTok{, }\StringTok{\textquotesingle{}six\textquotesingle{}}\OtherTok{=}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  In this case, we can index by the name
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{digits[}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}one\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}six\textquotesingle{}}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# one six }
\NormalTok{\#\#   1   6}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Believe it or not, everything in R is actually a vector. For example \texttt{9} is a vector with only one element, which is \texttt{9}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{9}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 9}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  This is why every output begins with \texttt{{[}1{]}}. R tries to help you find numbers in printed vectors. Every time a vector is printed, it reminds you at which position in the vector we are.
\item
  The \texttt{{[}1{]}} in the output below tells you that \texttt{"a"} is the first element, and the \texttt{{[}20{]}} tells you that \texttt{"t"} is the 20-th element.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{letters }\CommentTok{\# print a vector with all lower{-}case letters}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"}
\NormalTok{\#\# [20] "t" "u" "v" "w" "x" "y" "z"}
\end{Highlighting}
\end{Shaded}

\subsection{What are vectors good for?}\label{what-are-vectors-good-for}

\begin{itemize}
\tightlist
\item
  Let's put this knowledge to use.
\item
  Here are two vectors representing the winnings from my recent gambling:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horse\_bets\_payout\_tl }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{50}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{100}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{20}\NormalTok{, }\DecValTok{250}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{40}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{30}\NormalTok{, }\DecValTok{23}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{23}\NormalTok{, }\DecValTok{55}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{24}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poker\_payout\_tl }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{, }\DecValTok{5}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{38.1}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{103}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{187}\NormalTok{, }\DecValTok{13}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{23}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{45}\NormalTok{, }\DecValTok{36}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's find out which game is more profitable.
\item
  To get our average profit, we first need to compute the sum of a vector.
\item
  Then, we will divide the sum by the length of the vector.
\item
  First, let's compute the sums of these vectors.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(horse\_bets\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 399}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(poker\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 293.9}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Now, we need to determine the length of these vectors:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(horse\_bets\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 16}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(poker\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 12}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Dividing the sum by the length would give us our average profit.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(horse\_bets\_payout\_tl)}\SpecialCharTok{/}\FunctionTok{length}\NormalTok{(horse\_bets\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 24.9375}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(poker\_payout\_tl)}\SpecialCharTok{/}\FunctionTok{length}\NormalTok{(poker\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 24.49167}
\end{Highlighting}
\end{Shaded}

\ldots{} so which game is more profitable?

\begin{itemize}
\item
  It seems that betting is more profitable.
\item
  Next time, we can accomplish this calulation by calling the function \texttt{mean()}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(horse\_bets\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 24.9375}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(poker\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 24.49167}
\end{Highlighting}
\end{Shaded}

\ldots Now, I forgot to mention that my bookie charges me 1.5 TL per bet on a horse, on average. The poker payouts correspond to the profits, though. \ldots 

\begin{itemize}
\item
  Luckily, we can just add numbers and vectors. Let's just create two new vectors which contain the profits.
\item
  Let's subtract 1.5 from elements of \texttt{horse\_bets\_payout\_tl} and save the result as \texttt{horse\_bets\_profits\_tl}.
\item
  As you see, this subtraction is applied to every element of the vector.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horse\_bets\_profits\_tl }\OtherTok{\textless{}{-}}\NormalTok{ horse\_bets\_payout\_tl }\SpecialCharTok{{-}} \FloatTok{1.5}
\FunctionTok{head}\NormalTok{(horse\_bets\_profits\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1]  98.5 {-}51.5  {-}0.5  98.5 {-}11.5 {-}21.5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(horse\_bets\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 100 {-}50   1 100 {-}10 {-}20}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  For poker, we don't need to change anything. So, we assign the already existing \texttt{poker\_payout\_tl} vector to another vector called \texttt{poker\_profits\_tl}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poker\_profits\_tl }\OtherTok{\textless{}{-}}\NormalTok{ poker\_payout\_tl}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's compare:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horse\_bets\_payout\_tl}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] 100 {-}50   1 100 {-}10 {-}20 250 {-}40 {-}30  23 {-}23  55  14   8  24  {-}3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{horse\_bets\_profits\_tl}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  98.5 {-}51.5  {-}0.5  98.5 {-}11.5 {-}21.5 248.5 {-}41.5 {-}31.5  21.5 {-}24.5  53.5}
\NormalTok{\#\# [13]  12.5   6.5  22.5  {-}4.5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poker\_payout\_tl}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  24.0   5.0 {-}38.1  12.0 103.0  15.0   5.0 187.0  13.0 {-}23.0 {-}45.0  36.0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poker\_profits\_tl}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  24.0   5.0 {-}38.1  12.0 103.0  15.0   5.0 187.0  13.0 {-}23.0 {-}45.0  36.0}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Which game is more profitable now?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(horse\_bets\_profits\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 23.4375}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(poker\_profits\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 24.49167}
\end{Highlighting}
\end{Shaded}

\section{Data Frames}\label{data-frames}

\begin{itemize}
\tightlist
\item
  What I forgot to mention is that I generally gamble on Wednesdays and Fridays. Maybe that matters?
\item
  How can we associate this information with the profits vectors?
\end{itemize}

\begin{itemize}
\tightlist
\item
  One way is to represent it in two vectors containing days of the week. In that case, every \(i\)-th element in \texttt{poker\_week\_days} corresponds to the \(i\)-th element in \texttt{poker\_week\_days}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create two vectors with week days}
\NormalTok{horse\_bets\_week\_days }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Wed"}\NormalTok{, }\StringTok{"Fr"}\NormalTok{), }\DecValTok{8}\NormalTok{)}
\NormalTok{poker\_week\_days }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Wed"}\NormalTok{, }\StringTok{"Fr"}\NormalTok{), }\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  But this is getting messy. We have to keep track of two pairs a vectors, and the relations between them. Let's represent all poker-related information in one data structure, and all horse race-related information in another structure.
\item
  The best way to represent a pair of vectors where the \(i\)-th element in vector 1 corresponds to the \(i\)-th element in vector 2 is with data frames. We can create a new data frame with the function \texttt{data.frame()}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_horse\_bets }\OtherTok{\textless{}{-}} 
  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{wday =}\NormalTok{ horse\_bets\_week\_days, }
             \AttributeTok{profit =}\NormalTok{ horse\_bets\_profits\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_poker }\OtherTok{\textless{}{-}} 
  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{wday =}\NormalTok{ poker\_week\_days, }
             \AttributeTok{profit =}\NormalTok{ poker\_payout\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's take a look at what we've created.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_horse\_bets}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#    wday profit}
\NormalTok{\#\# 1   Wed   98.5}
\NormalTok{\#\# 2    Fr  {-}51.5}
\NormalTok{\#\# 3   Wed   {-}0.5}
\NormalTok{\#\# 4    Fr   98.5}
\NormalTok{\#\# 5   Wed  {-}11.5}
\NormalTok{\#\# 6    Fr  {-}21.5}
\NormalTok{\#\# 7   Wed  248.5}
\NormalTok{\#\# 8    Fr  {-}41.5}
\NormalTok{\#\# 9   Wed  {-}31.5}
\NormalTok{\#\# 10   Fr   21.5}
\NormalTok{\#\# 11  Wed  {-}24.5}
\NormalTok{\#\# 12   Fr   53.5}
\NormalTok{\#\# 13  Wed   12.5}
\NormalTok{\#\# 14   Fr    6.5}
\NormalTok{\#\# 15  Wed   22.5}
\NormalTok{\#\# 16   Fr   {-}4.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Wow. That's a rather long output \ldots{}
\item
  Generally, it's sufficient to see the first couple of rows of a \texttt{data.frame} to get a sense of what it contains.
\item
  We'll use the function \texttt{head()}, which takes a \texttt{data.frame} and a number \(n\), and outputs the first \(n\) lines.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# let\textquotesingle{}s see the first two rows of the data frame called df\_horse\_bets}
\FunctionTok{head}\NormalTok{(df\_horse\_bets, }\DecValTok{2}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   wday profit}
\NormalTok{\#\# 1  Wed   98.5}
\NormalTok{\#\# 2   Fr  {-}51.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  An alternative is \texttt{View()}, which shows you the entire \texttt{data.frame} within a new tab in the RStudio GUI.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{View}\NormalTok{(df\_poker)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Turning back to our gambling example, we still have two objects, which really belong together.
\item
  Let's merge them into one long data frame.
\item
  The function \texttt{rbind()} takes two data frames as its arguments, and returns a single concatenated data frame, where all the rows of the first data frame are on top, and all the rows of the second data frame are at the bottom.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_gambling }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df\_horse\_bets, df\_poker)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Unfortunately, now, we don't have any information on which profits are from which game.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df\_gambling)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   wday profit}
\NormalTok{\#\# 1  Wed   98.5}
\NormalTok{\#\# 2   Fr  {-}51.5}
\NormalTok{\#\# 3  Wed   {-}0.5}
\NormalTok{\#\# 4   Fr   98.5}
\NormalTok{\#\# 5  Wed  {-}11.5}
\NormalTok{\#\# 6   Fr  {-}21.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's fix this problem by enriching both data frames with this information.
\item
  We can assign to new (or old) columns with our assignment operator \texttt{\textless{}-}.
\item
  When we assign a value to a specific column, R puts the specified value into every row of the column of the given data frame.
\item
  What the following code says is ``Create a new column named \texttt{game} in the data frame named \texttt{df\_horse\_bets} and fill the column with the string \emph{horse\_bets}.''
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_horse\_bets}\SpecialCharTok{$}\NormalTok{game }\OtherTok{\textless{}{-}} \StringTok{"horse\_bets"}
\NormalTok{df\_poker}\SpecialCharTok{$}\NormalTok{game }\OtherTok{\textless{}{-}} \StringTok{"poker"}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Now, let's bind them together again. (This overwrites the old data frame called \texttt{df\_gambling}, which we created previously.)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_gambling }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df\_horse\_bets, df\_poker)}
\FunctionTok{head}\NormalTok{(df\_gambling)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   wday profit       game}
\NormalTok{\#\# 1  Wed   98.5 horse\_bets}
\NormalTok{\#\# 2   Fr  {-}51.5 horse\_bets}
\NormalTok{\#\# 3  Wed   {-}0.5 horse\_bets}
\NormalTok{\#\# 4   Fr   98.5 horse\_bets}
\NormalTok{\#\# 5  Wed  {-}11.5 horse\_bets}
\NormalTok{\#\# 6   Fr  {-}21.5 horse\_bets}
\end{Highlighting}
\end{Shaded}

\section{Working with data frames}\label{working-with-data-frames}

\begin{itemize}
\tightlist
\item
  Now, we can do very cool things very easily.
\item
  But we'll need two packages for that: \texttt{dplyr}, and \texttt{magrittr}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load the two packages}
\FunctionTok{library}\NormalTok{(magrittr) }\CommentTok{\# for \textquotesingle{}\%\textgreater{}\%\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'magrittr'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:purrr':
## 
##     set_names
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:tidyr':
## 
##     extract
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr) }\CommentTok{\# for group\_by() and summarize()}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Now, we can \emph{`aggregate'} data \emph{(= ``combine data from several measurements by replacing it by summary statistics'')}.
\item
  Let's compute the average profit by \texttt{game}.
\item
  Within the \texttt{summarize()} function, we specify new columns.
\item
  In this case, \texttt{avg\_profit} is the name of our column and its content is mean of the profit column.
\item
  Keep in mind that \texttt{summarize()} function is applied at the group level.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_gambling }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(game) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg\_profit =} \FunctionTok{mean}\NormalTok{(profit))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 2}
\NormalTok{\#\#   game       avg\_profit}
\NormalTok{\#\#   \textless{}chr\textgreater{}           \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 horse\_bets       23.4}
\NormalTok{\#\# 2 poker            24.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  We can also aggregate over several grouping variables at the same time, like \texttt{game} and \texttt{wday}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_gambling }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(game, wday) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg\_profit =} \FunctionTok{mean}\NormalTok{(profit))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'game'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 4 x 3}
\NormalTok{\#\# \# Groups:   game [2]}
\NormalTok{\#\#   game       wday  avg\_profit}
\NormalTok{\#\#   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}      \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 horse\_bets Fr          7.62}
\NormalTok{\#\# 2 horse\_bets Wed        39.2 }
\NormalTok{\#\# 3 poker      Fr         38.7 }
\NormalTok{\#\# 4 poker      Wed        10.3}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \ldots{} and we can do so in various ways. Here we compute the proportion of wins.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_gambling }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(game, wday) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg\_proportion\_wins =} \FunctionTok{mean}\NormalTok{(profit}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'game'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 4 x 3}
\NormalTok{\#\# \# Groups:   game [2]}
\NormalTok{\#\#   game       wday  avg\_proportion\_wins}
\NormalTok{\#\#   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}               \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 horse\_bets Fr                  0.5  }
\NormalTok{\#\# 2 horse\_bets Wed                 0.5  }
\NormalTok{\#\# 3 poker      Fr                  0.833}
\NormalTok{\#\# 4 poker      Wed                 0.667}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Now, we can also plot the results.
\item
  But we'll need to save the summary statistics first.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{profits\_by\_game }\OtherTok{\textless{}{-}} 
\NormalTok{  df\_gambling }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{group\_by}\NormalTok{(game) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg\_profit =} \FunctionTok{mean}\NormalTok{(profit))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{profits\_by\_game\_and\_wday }\OtherTok{\textless{}{-}} 
\NormalTok{  df\_gambling }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{group\_by}\NormalTok{(game, wday) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg\_profit =} \FunctionTok{mean}\NormalTok{(profit))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'game'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We will also need yet another package (for plotting): \texttt{ggplot2}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  After loading the package ggplot2, we can create plots with the function \texttt{ggplot()}. We will be going over the details in the upcoming chapters.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(profits\_by\_game, }\FunctionTok{aes}\NormalTok{(game, avg\_profit)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-89-1.pdf}

\begin{itemize}
\tightlist
\item
  We may also want lines that connect the points.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(profits\_by\_game\_and\_wday, }\FunctionTok{aes}\NormalTok{(game, avg\_profit, }\AttributeTok{color =}\NormalTok{ wday, }\AttributeTok{group =}\NormalTok{ wday)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-90-1.pdf}

\begin{itemize}
\tightlist
\item
  Or, we may want to have a bar graph.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(profits\_by\_game, }\FunctionTok{aes}\NormalTok{(game, avg\_profit)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-91-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{ggplot}\NormalTok{(profits\_by\_game\_and\_wday, }\FunctionTok{aes}\NormalTok{(game, avg\_profit, }\AttributeTok{fill =}\NormalTok{ wday)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-92-1.pdf}

\section{Functions in this section}\label{functions-in-this-section}

\texttt{data.frame(a\ =\ x,\ b\ =\ y,\ ...)}

Create a data frame from several vectors. The vectors can be different types.

\begin{itemize}
\tightlist
\item
  \texttt{x} A vector with \(n\) elements.
\item
  \texttt{y} Another vector with \(n\) elements.
\item
  \texttt{...} More vectors can be provided.
\end{itemize}

\texttt{View(x)}

Display a data frame, or another structure.

\texttt{head(df,\ n=6)}

Show the first \(n\) rows in the data frame df.

\begin{itemize}
\tightlist
\item
  \texttt{df} Data frame from which to display the first \(n\) rows.
\item
  \texttt{n} The number of rows to display. The default value for \(n\) is 6.
\end{itemize}

\texttt{sum(x)}

Compute the sum of a vector.

\texttt{length(x)}

Return the length of a vector.

\texttt{mean(x)}

Compute the mean of a vector.

\texttt{rep(x,\ n)}

Repeat the contents of a vector \(n\) times

\begin{itemize}
\tightlist
\item
  \texttt{x} The vector to be repeated.
\item
  \texttt{n} How many times to repeat the vector x.
\end{itemize}

\texttt{seq(from,\ to,\ by)}

Create a sequence of integers from \texttt{from} to \texttt{to} in steps of \texttt{by}.

\begin{itemize}
\tightlist
\item
  \texttt{from} The integer to start from.
\item
  \texttt{to} The integer to stop after.
\item
  \texttt{by} Size of steps to take. (If \texttt{from} \(>\) \texttt{to}, \texttt{by} needs to be negative.)
\end{itemize}

\texttt{rbind(df1,\ df2)}

Append df1 to df2 and return the resulting data frame. Both data frames need to have the same number of columns with the same names.

\begin{itemize}
\tightlist
\item
  \texttt{df1} First data frame.
\item
  \texttt{df2} Second data frame.
\end{itemize}

\chapter{Working with Data}\label{working-with-data}

In this section, we learn how to work with data in a \textbf{dataframe}. A dataframe is a two-dimensional array consisting of \emph{rows} and \emph{columns}. You can simply think of it as a spreadsheet (e.g.~MS Excel, Google Sheets, etc.).

\section{Basic dataframes}\label{basic-dataframes}

R has some prebuilt functions to build dataframes. Let us see a simple example. Consider the following three vectors.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{name }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Sam"}\NormalTok{, }\StringTok{"Paulina"}\NormalTok{, }\StringTok{"Cenk"}\NormalTok{)}
\NormalTok{age }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{23}\NormalTok{, }\DecValTok{34}\NormalTok{, }\DecValTok{19}\NormalTok{)}
\NormalTok{height }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{179}\NormalTok{, }\DecValTok{167}\NormalTok{, }\DecValTok{173}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Let us turn the data stored in different vectors into a single dataframe so that we can visualize the data better.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let us first create the dataframe and assign it to the variable my\_df}
\NormalTok{my\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(name,age,height)}

\CommentTok{\#Let\textquotesingle{}s print the dataframe now}
\NormalTok{my\_df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#      name age height}
\NormalTok{\#\# 1     Sam  23    179}
\NormalTok{\#\# 2 Paulina  34    167}
\NormalTok{\#\# 3    Cenk  19    173}
\end{Highlighting}
\end{Shaded}

We can select a particular row, column, or cell on a dataframe by using indices. For this we can use the slicing method \texttt{my\_dataframe{[}row,column{]}}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let us select the entire first row }
\NormalTok{my\_df[}\DecValTok{1}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   name age height}
\NormalTok{\#\# 1  Sam  23    179}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Now, let us select the first column }
\NormalTok{my\_df[,}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "Sam"     "Paulina" "Cenk"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Now, let us find Paulina\textquotesingle{}s height. For this, we need to get the 2nd row and 3rd column.}
\NormalTok{my\_df[}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 167}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Now, let us find Paulina\textquotesingle{}s age and height. For this, we need to get the 2nd row and 2nd and 3rd columns.}
\NormalTok{my\_df[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   age height}
\NormalTok{\#\# 2  34    167}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Finally, let us get Sam and Paulina\textquotesingle{}s ages.}
\NormalTok{my\_df[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 23 34}
\end{Highlighting}
\end{Shaded}

You can also use the column name to select an entire column. Just add the dollar sign \texttt{\$} after the df and then the column mane.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_df}\SpecialCharTok{$}\NormalTok{age}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 23 34 19}
\end{Highlighting}
\end{Shaded}

\section{Tibbles}\label{tibbles}

The standard dataframes in R are good but not great. Often, we will deal with a lot of data we may not now which index to use to find the value we want. So, we need to be able to have some better ways to access data on our dataframes. We also want to be able to add new data or change some of the existing data easily. For this, we will use various packages in \textbf{tidyverse} for better dataframe management.

Let us first load the tidyverse library, which will load the necessary packages for the functionality described in the following sections.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

Next, let us introduce tibbles. A \textbf{tibble} is a dataframe with some improved properties. We can turn a regular dataframe into a tibble by calling the \texttt{as\_tibble()} function on our dataframe.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let\textquotesingle{}s turn my\_df into a tibble}
\NormalTok{my\_tibble }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(my\_df)}

\CommentTok{\#Let\textquotesingle{}s print my\_tibble}
\NormalTok{my\_tibble}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 3 x 3}
\NormalTok{\#\#   name      age height}
\NormalTok{\#\#   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 Sam        23    179}
\NormalTok{\#\# 2 Paulina    34    167}
\NormalTok{\#\# 3 Cenk       19    173}
\end{Highlighting}
\end{Shaded}

As you can see above, the console output tells you that this is a 3x3 tibble meaning that it has 3 rows and 3 columns. It also tells you the type of the data in each column. You can see the data types right under each column name.

\section{Beyond Toy Data}\label{beyond-toy-data}

So far we have been working with toy data. In real life projects, you will have a lot more data. The data will usually be stored in some file from which you will have to read into a dataframe. Alternatively, it might be some dataset that from a corpus easily accessible to R. Let us see a few ways in which we can load some realistic datasets into a tibble.

\subsection{Reading data from a csv file}\label{reading-data-from-a-csv-file}

In this course, we will use some of the data sets from Bodo Winter's book. Go to \href{https://osf.io/34mq9/}{this website} to download the \texttt{materials} folder. Once your data has been downloaded, navigate to the \texttt{materials/data} folder and locate the \texttt{nettle\_1999\_climate.csv} file.

To read in data from a csv to a tibble, we will use the \texttt{read\_csv()} function. All we need to do is to provide the path to the csv file we want to read in. If your csv file is in the same folder as your script, you can simply give its name. Otherwise, you need to provide the relevant directory information as well in your path.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let\textquotesingle{}s read in the data}
\NormalTok{nettle }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}data/nettle\_1999\_climate.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 74 Columns: 5
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (1): Country
## dbl (4): Population, Area, MGS, Langs
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let\textquotesingle{}s print the head of the data to see what it looks like}
\NormalTok{nettle}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 74 x 5}
\NormalTok{\#\#    Country      Population  Area   MGS Langs}
\NormalTok{\#\#    \textless{}chr\textgreater{}             \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 Algeria            4.41  6.38  6.6     18}
\NormalTok{\#\#  2 Angola             4.01  6.1   6.22    42}
\NormalTok{\#\#  3 Australia          4.24  6.89  6      234}
\NormalTok{\#\#  4 Bangladesh         5.07  5.16  7.4     37}
\NormalTok{\#\#  5 Benin              3.69  5.05  7.14    52}
\NormalTok{\#\#  6 Bolivia            3.88  6.04  6.92    38}
\NormalTok{\#\#  7 Botswana           3.13  5.76  4.6     27}
\NormalTok{\#\#  8 Brazil             5.19  6.93  9.71   209}
\NormalTok{\#\#  9 Burkina Faso       3.97  5.44  5.17    75}
\NormalTok{\#\# 10 CAR                3.5   5.79  8.08    94}
\NormalTok{\#\# \# i 64 more rows}
\end{Highlighting}
\end{Shaded}

If you want to see the last 5 items, use the \texttt{tail()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(nettle)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 6 x 5}
\NormalTok{\#\#   Country   Population  Area   MGS Langs}
\NormalTok{\#\#   \textless{}chr\textgreater{}          \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 Venezuela       4.31  5.96  7.98    40}
\NormalTok{\#\# 2 Vietnam         4.83  5.52  8.8     88}
\NormalTok{\#\# 3 Yemen           4.09  5.72  0        6}
\NormalTok{\#\# 4 Zaire           4.56  6.37  9.44   219}
\NormalTok{\#\# 5 Zambia          3.94  5.88  5.43    38}
\NormalTok{\#\# 6 Zimbabwe        4     5.59  5.29    18}
\end{Highlighting}
\end{Shaded}

If you want to view the entire dataset, you can use \texttt{View(nettle)}. This will open a new tab in RStudio and show your data as a table.

\subsection{Reading data from R data packages}\label{reading-data-from-r-data-packages}

R has various data packages you can install and use. Let us install the \texttt{languageR} which has some nice language datasets. Once you install the package and load the library, you can easily use the datasets as tibles. For all the details and available datasets in \texttt{languageR}, you can check the \href{https://cran.r-project.org/web/packages/languageR/languageR.pdf}{languageR documentation} on CRAN.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let\textquotesingle{}s load the library}
\FunctionTok{library}\NormalTok{(languageR)}

\CommentTok{\#We\textquotesingle{}ll use the dativeSimplified dataset, which is documented. Let\textquotesingle{}s see the documentation}
\NormalTok{?dativeSimplified}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#let\textquotesingle{}s use the dativeSimplified data from the languageR }
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(dativeSimplified)}

\CommentTok{\#Let\textquotesingle{}s print the first few lines of the data}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 5}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               feed  animate      inanimate              2.64 }
\NormalTok{\#\#  2 NP               give  animate      inanimate              1.10 }
\NormalTok{\#\#  3 NP               give  animate      inanimate              2.56 }
\NormalTok{\#\#  4 NP               give  animate      inanimate              1.61 }
\NormalTok{\#\#  5 NP               offer animate      inanimate              1.10 }
\NormalTok{\#\#  6 NP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  7 NP               pay   animate      inanimate              1.39 }
\NormalTok{\#\#  8 NP               bring animate      inanimate              0    }
\NormalTok{\#\#  9 NP               teach animate      inanimate              2.40 }
\NormalTok{\#\# 10 NP               give  animate      inanimate              0.693}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

\textbf{Dative Alternation} is the phenomenon in English where a recipient of a ditransitive verb can occur as an NP or a PP.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Alex gave Sam a book.
\item
  Alex gave a book to Sam.
\end{enumerate}

Both of these constructions are grammatical and they mean essentially the same thing. The question is what factors are involved in picking one of the forms over the other. Bresnan et al.~(2007) used this data to determine the relevant factors.
Let us randomly select 10 examples and see what they look like. For that, we can use the folloing code.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# store all possible row indices in a vector}
\NormalTok{indices\_all }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(data)}

\CommentTok{\# set the random seed to make the results reproducible}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# choose 10 such numbers at random without replacement}
\NormalTok{indices\_random }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(indices\_all, }\AttributeTok{size =} \DecValTok{10}\NormalTok{)}

\CommentTok{\# use them to index the data frame to get the corresponding rows}
\NormalTok{data[indices\_random,]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 10 x 5}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               give  inanimate    inanimate              1.79 }
\NormalTok{\#\#  2 NP               grant animate      inanimate              1.10 }
\NormalTok{\#\#  3 NP               grant animate      inanimate              2.40 }
\NormalTok{\#\#  4 NP               give  animate      inanimate              2.56 }
\NormalTok{\#\#  5 NP               tell  animate      inanimate              3.26 }
\NormalTok{\#\#  6 PP               give  animate      inanimate              0    }
\NormalTok{\#\#  7 NP               pay   animate      inanimate              0.693}
\NormalTok{\#\#  8 NP               hand  animate      inanimate              0.693}
\NormalTok{\#\#  9 NP               give  inanimate    inanimate              1.61 }
\NormalTok{\#\# 10 NP               wish  animate      inanimate              1.10}
\end{Highlighting}
\end{Shaded}

\section{Summarizing Data}\label{summarizing-data}

Looking at the summary statistics of your data is always a good first step. Let's take a look at the percentage of NP realizations of the recipient by animacy of the theme.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# First, let\textquotesingle{}s take a look at the key dependet variable (NP or PP)}

\FunctionTok{unique}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{RealizationOfRec)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] NP PP}
\NormalTok{\#\# Levels: NP PP}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# now, let\textquotesingle{}s compute the percentages (perc\_NP) and the number of observations in each subset}
\NormalTok{data}\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(AnimacyOfRec) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{), }
                   \AttributeTok{N =} \FunctionTok{n}\NormalTok{()}
\NormalTok{                  )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 3}
\NormalTok{\#\#   AnimacyOfRec perc\_NP     N}
\NormalTok{\#\#   \textless{}fct\textgreater{}          \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\NormalTok{\#\# 1 animate        0.634   822}
\NormalTok{\#\# 2 inanimate      0.420    81}
\end{Highlighting}
\end{Shaded}

\textbf{What do the results say?}

\begin{itemize}
\tightlist
\item
  There are a total of 822 instances of animate recipients.
\item
  63\% of the animate recipients are NPs.
\end{itemize}

\section{Working with dplyr}\label{working-with-dplyr}

One of the packages in the \texttt{tidyverse} is \texttt{dplyr}. We use it to do various manipulations on the data frames. Check out the \href{https://nyu-cdsc.github.io/learningr/assets/data-transformation.pdf}{dplyr cheatsheet} for further details.

The \texttt{arrange} function will arrange your data in an ascending order.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{arrange}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 5}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               feed  animate      inanimate              2.64 }
\NormalTok{\#\#  2 NP               give  animate      inanimate              1.10 }
\NormalTok{\#\#  3 NP               give  animate      inanimate              2.56 }
\NormalTok{\#\#  4 NP               give  animate      inanimate              1.61 }
\NormalTok{\#\#  5 NP               offer animate      inanimate              1.10 }
\NormalTok{\#\#  6 NP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  7 NP               pay   animate      inanimate              1.39 }
\NormalTok{\#\#  8 NP               bring animate      inanimate              0    }
\NormalTok{\#\#  9 NP               teach animate      inanimate              2.40 }
\NormalTok{\#\# 10 NP               give  animate      inanimate              0.693}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

You can arrange the data based on a particular column. In that case, you need to provide the column name.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{arrange}\NormalTok{(data,LengthOfTheme)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 5}
\NormalTok{\#\#    RealizationOfRec Verb   AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{}  \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               bring  animate      inanimate                  0}
\NormalTok{\#\#  2 NP               send   animate      inanimate                  0}
\NormalTok{\#\#  3 NP               bet    animate      inanimate                  0}
\NormalTok{\#\#  4 NP               tell   animate      inanimate                  0}
\NormalTok{\#\#  5 NP               tell   animate      inanimate                  0}
\NormalTok{\#\#  6 NP               give   inanimate    inanimate                  0}
\NormalTok{\#\#  7 NP               give   animate      inanimate                  0}
\NormalTok{\#\#  8 NP               charge animate      inanimate                  0}
\NormalTok{\#\#  9 NP               give   animate      inanimate                  0}
\NormalTok{\#\# 10 NP               pay    animate      inanimate                  0}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{arrange}\NormalTok{(data[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{,], LengthOfTheme)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 10 x 5}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               bring animate      inanimate              0    }
\NormalTok{\#\#  2 NP               give  animate      inanimate              0.693}
\NormalTok{\#\#  3 NP               give  animate      inanimate              1.10 }
\NormalTok{\#\#  4 NP               offer animate      inanimate              1.10 }
\NormalTok{\#\#  5 NP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  6 NP               pay   animate      inanimate              1.39 }
\NormalTok{\#\#  7 NP               give  animate      inanimate              1.61 }
\NormalTok{\#\#  8 NP               teach animate      inanimate              2.40 }
\NormalTok{\#\#  9 NP               give  animate      inanimate              2.56 }
\NormalTok{\#\# 10 NP               feed  animate      inanimate              2.64}
\end{Highlighting}
\end{Shaded}

If you want to arrange things in a descending order, then you need to put the \texttt{desc()} function around the relevant column.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{arrange}\NormalTok{(data, }\FunctionTok{desc}\NormalTok{(LengthOfTheme))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 5}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               give  inanimate    inanimate               3.64}
\NormalTok{\#\#  2 NP               send  animate      inanimate               3.56}
\NormalTok{\#\#  3 NP               give  animate      inanimate               3.53}
\NormalTok{\#\#  4 NP               pay   animate      inanimate               3.50}
\NormalTok{\#\#  5 NP               give  animate      inanimate               3.50}
\NormalTok{\#\#  6 NP               give  animate      inanimate               3.47}
\NormalTok{\#\#  7 NP               give  animate      inanimate               3.47}
\NormalTok{\#\#  8 NP               give  animate      inanimate               3.40}
\NormalTok{\#\#  9 NP               send  animate      inanimate               3.40}
\NormalTok{\#\# 10 NP               give  animate      inanimate               3.37}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

Another useful function is the \texttt{select()} function which allows you to create new dataframes using only columns you want.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Create the new dataframe using select}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(data, Verb, LengthOfTheme)}

\CommentTok{\#print the head}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 2}
\NormalTok{\#\#    Verb  LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}         \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 feed          2.64 }
\NormalTok{\#\#  2 give          1.10 }
\NormalTok{\#\#  3 give          2.56 }
\NormalTok{\#\#  4 give          1.61 }
\NormalTok{\#\#  5 offer         1.10 }
\NormalTok{\#\#  6 give          1.39 }
\NormalTok{\#\#  7 pay           1.39 }
\NormalTok{\#\#  8 bring         0    }
\NormalTok{\#\#  9 teach         2.40 }
\NormalTok{\#\# 10 give          0.693}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

Another useful function is \texttt{sample\_n()} which randomly samples some number of datapoints.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sample\_n}\NormalTok{(data, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 5 x 5}
\NormalTok{\#\#   RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#   \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 NP               give  animate      inanimate              0.693}
\NormalTok{\#\# 2 NP               sell  animate      inanimate              0    }
\NormalTok{\#\# 3 PP               give  animate      inanimate              1.61 }
\NormalTok{\#\# 4 PP               pay   animate      inanimate              1.39 }
\NormalTok{\#\# 5 PP               offer inanimate    inanimate              1.95}
\end{Highlighting}
\end{Shaded}

Two other useful functions are \texttt{group\_by()} and \texttt{ungroup()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Let\textquotesingle{}s group a small portion of the data by the realization of recipient}
\FunctionTok{group\_by}\NormalTok{(data[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], RealizationOfRec)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 5}
\NormalTok{\#\# \# Groups:   RealizationOfRec [2]}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               feed  animate      inanimate              2.64 }
\NormalTok{\#\#  2 NP               give  animate      inanimate              1.10 }
\NormalTok{\#\#  3 NP               give  animate      inanimate              2.56 }
\NormalTok{\#\#  4 NP               give  animate      inanimate              1.61 }
\NormalTok{\#\#  5 NP               offer animate      inanimate              1.10 }
\NormalTok{\#\#  6 NP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  7 NP               pay   animate      inanimate              1.39 }
\NormalTok{\#\#  8 NP               bring animate      inanimate              0    }
\NormalTok{\#\#  9 NP               teach animate      inanimate              2.40 }
\NormalTok{\#\# 10 NP               give  animate      inanimate              0.693}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

Now let us group the data by verbs.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_grouped\_by\_verb }\OtherTok{\textless{}{-}} \FunctionTok{group\_by}\NormalTok{(data,Verb)}
\end{Highlighting}
\end{Shaded}

An important but complex function is the \texttt{summarize()} function.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  It divides a grouped data frame into subsets, with each subset corresponding to one value of the grouping variable (or a combination of values for several grouping variables).
\item
  It computes one or several values we specify on each such subset.
\item
  It creates a new data frame and puts everything together. The first column of this new data frame consists of levels of our grouping variable. In the following columns, the summarize() function prints the results of the computations we have specified.
\end{enumerate}

Try to guess the result of the following code. What will you see as an output? What will be the name of the columns?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# summarize several variables}
\FunctionTok{summarize}\NormalTok{(data\_grouped\_by\_verb, }
          \AttributeTok{prop\_animate\_rec =} \FunctionTok{mean}\NormalTok{( AnimacyOfRec }\SpecialCharTok{==} \StringTok{"animate"}\NormalTok{ ),}
          \AttributeTok{prop\_animate\_theme =} \FunctionTok{mean}\NormalTok{( AnimacyOfTheme }\SpecialCharTok{==} \StringTok{"animate"}\NormalTok{ ),}
          \AttributeTok{N =} \FunctionTok{n}\NormalTok{()}
\NormalTok{          )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 65 x 4}
\NormalTok{\#\#    Verb     prop\_animate\_rec prop\_animate\_theme     N}
\NormalTok{\#\#    \textless{}fct\textgreater{}               \textless{}dbl\textgreater{}              \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\NormalTok{\#\#  1 accord              1                      0     1}
\NormalTok{\#\#  2 allocate            0                      0     3}
\NormalTok{\#\#  3 allow               0.833                  0     6}
\NormalTok{\#\#  4 assess              1                      0     1}
\NormalTok{\#\#  5 assure              1                      0     2}
\NormalTok{\#\#  6 award               0.944                  0    18}
\NormalTok{\#\#  7 bequeath            1                      0     1}
\NormalTok{\#\#  8 bet                 1                      0     1}
\NormalTok{\#\#  9 bring               0.818                  0    11}
\NormalTok{\#\# 10 carry               1                      0     1}
\NormalTok{\#\# \# i 55 more rows}
\end{Highlighting}
\end{Shaded}

Try to interpret the output of the following code.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# compute the averages}
\FunctionTok{summarize}\NormalTok{(data\_grouped\_by\_verb, }
          \AttributeTok{prop\_anim =} \FunctionTok{mean}\NormalTok{(AnimacyOfRec }\SpecialCharTok{==} \StringTok{"animate"}\NormalTok{),}
          \AttributeTok{prop\_inanim =} \DecValTok{1}\SpecialCharTok{{-}}\NormalTok{prop\_anim,}
          \AttributeTok{prop\_v\_recip\_anim =} \FunctionTok{ifelse}\NormalTok{(prop\_anim }\SpecialCharTok{\textgreater{}} \FloatTok{0.5}\NormalTok{, }\StringTok{"high"}\NormalTok{, }\StringTok{"low"}\NormalTok{)}
\NormalTok{          )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 65 x 4}
\NormalTok{\#\#    Verb     prop\_anim prop\_inanim prop\_v\_recip\_anim}
\NormalTok{\#\#    \textless{}fct\textgreater{}        \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            }
\NormalTok{\#\#  1 accord       1          0      high             }
\NormalTok{\#\#  2 allocate     0          1      low              }
\NormalTok{\#\#  3 allow        0.833      0.167  high             }
\NormalTok{\#\#  4 assess       1          0      high             }
\NormalTok{\#\#  5 assure       1          0      high             }
\NormalTok{\#\#  6 award        0.944      0.0556 high             }
\NormalTok{\#\#  7 bequeath     1          0      high             }
\NormalTok{\#\#  8 bet          1          0      high             }
\NormalTok{\#\#  9 bring        0.818      0.182  high             }
\NormalTok{\#\# 10 carry        1          0      high             }
\NormalTok{\#\# \# i 55 more rows}
\end{Highlighting}
\end{Shaded}

The last line uses the function ifelse(condition, value1, value2), which, for each element of the condition vector returns the corresponding element of the value1 vector if the condition is true at that element, or an element of vector2 otherwise.

mutate() proceeds similarly to summarize() in dividing a grouped dataset into subsets, but instead of computing one or several values for each subset, it creates or modifies a column.

The main difference between mutate() and summarize() is the output. While mutate() modifies the original and returns a modified version of it, summarize() creates a brand new data frame with one row for every combination of the the grouping variable values.

A very simple application of mutate() is to simply create a new column. In this case, we don't even need to group.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# these two lines performs exactly the same action, }
\CommentTok{\# except the latter stores the result in df }
\NormalTok{data}\SpecialCharTok{$}\NormalTok{is\_realization\_NP }\OtherTok{\textless{}{-}}\NormalTok{ (data}\SpecialCharTok{$}\NormalTok{RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{ ) }
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(data, }\AttributeTok{is\_realization\_NP =}\NormalTok{ (RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}

\FunctionTok{head}\NormalTok{(df, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 6}
\NormalTok{\#\#   RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#   \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 NP               feed  animate      inanimate               2.64}
\NormalTok{\#\# 2 NP               give  animate      inanimate               1.10}
\NormalTok{\#\# \# i 1 more variable: is\_realization\_NP \textless{}lgl\textgreater{}}
\end{Highlighting}
\end{Shaded}

One final useful function is the \texttt{filter()} function. It allows you to find rows by particular values of a column.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{filter}\NormalTok{(data, is\_realization\_NP }\SpecialCharTok{==} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 348 x 6}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 PP               give  animate      inanimate              0    }
\NormalTok{\#\#  2 PP               give  inanimate    inanimate              1.79 }
\NormalTok{\#\#  3 PP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  4 PP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  5 PP               sell  animate      inanimate              1.79 }
\NormalTok{\#\#  6 PP               give  inanimate    inanimate              0.693}
\NormalTok{\#\#  7 PP               give  inanimate    inanimate              0.693}
\NormalTok{\#\#  8 PP               give  animate      inanimate              1.39 }
\NormalTok{\#\#  9 PP               send  animate      inanimate              2.56 }
\NormalTok{\#\# 10 PP               offer animate      inanimate              1.95 }
\NormalTok{\#\# \# i 338 more rows}
\NormalTok{\#\# \# i 1 more variable: is\_realization\_NP \textless{}lgl\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{filter}\NormalTok{(data, LengthOfTheme }\SpecialCharTok{\textgreater{}} \FloatTok{3.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 3 x 6}
\NormalTok{\#\#   RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme}
\NormalTok{\#\#   \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 NP               send  animate      inanimate               3.56}
\NormalTok{\#\# 2 NP               give  animate      inanimate               3.53}
\NormalTok{\#\# 3 NP               give  inanimate    inanimate               3.64}
\NormalTok{\#\# \# i 1 more variable: is\_realization\_NP \textless{}lgl\textgreater{}}
\end{Highlighting}
\end{Shaded}

\section{Pipes}\label{pipes}

\subsection{The problem}\label{the-problem}

\begin{itemize}
\tightlist
\item
  The code below is really hard to read, even harder to maintain, and \texttt{dativeSimplified\_grouped\_by\_AnimacyOfRec\_and\_AnimacyOfTheme} is a terribly long variable name.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dativeSimplified\_grouped\_by\_AnimacyOfRec\_and\_AnimacyOfTheme }\OtherTok{\textless{}{-}}
      \FunctionTok{group\_by}\NormalTok{(dativeSimplified, AnimacyOfRec, AnimacyOfTheme)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{summarize}\NormalTok{(dativeSimplified\_grouped\_by\_AnimacyOfRec\_and\_AnimacyOfTheme, }
                  \AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'AnimacyOfRec'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 4 x 3}
\NormalTok{\#\# \# Groups:   AnimacyOfRec [2]}
\NormalTok{\#\#   AnimacyOfRec AnimacyOfTheme perc\_NP}
\NormalTok{\#\#   \textless{}fct\textgreater{}        \textless{}fct\textgreater{}            \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 animate      animate          0.8  }
\NormalTok{\#\# 2 animate      inanimate        0.633}
\NormalTok{\#\# 3 inanimate    animate          1    }
\NormalTok{\#\# 4 inanimate    inanimate        0.412}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  This alternative is also quite bad. To read this code, you need to know which bracket matches which other bracket.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{summarize}\NormalTok{(}\FunctionTok{group\_by}\NormalTok{(dativeSimplified, AnimacyOfRec, AnimacyOfTheme), }
                  \AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'AnimacyOfRec'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 4 x 3}
\NormalTok{\#\# \# Groups:   AnimacyOfRec [2]}
\NormalTok{\#\#   AnimacyOfRec AnimacyOfTheme perc\_NP}
\NormalTok{\#\#   \textless{}fct\textgreater{}        \textless{}fct\textgreater{}            \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 animate      animate          0.8  }
\NormalTok{\#\# 2 animate      inanimate        0.633}
\NormalTok{\#\# 3 inanimate    animate          1    }
\NormalTok{\#\# 4 inanimate    inanimate        0.412}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  One nested function call may be OK. But try to read this.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{(}\FunctionTok{group\_by}\NormalTok{(}\FunctionTok{mutate}\NormalTok{(dativeSimplified, }\AttributeTok{long\_theme =} \FunctionTok{ifelse}\NormalTok{(LengthOfTheme }\SpecialCharTok{\textgreater{}} \FloatTok{1.6}\NormalTok{, }\StringTok{"long"}\NormalTok{, }\StringTok{"short"}\NormalTok{) ), long\_theme),}
              \AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{)}
\NormalTok{              )}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Or consider this expression (\texttt{sqrt} is the square root.)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{divide\_by}\NormalTok{(}\FunctionTok{sum}\NormalTok{(}\FunctionTok{divide\_by}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), }\FunctionTok{multiply\_by}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)), }\FunctionTok{sum}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.9759001}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Luckily, there a better way to write this expression.
\end{itemize}

\subsection{Pipes}\label{pipes-1}

\begin{itemize}
\tightlist
\item
  The problem is that we have too many levels of embedding.
\item
  In natural language we avoid multiple embeddings of that sort by making shorter sentences, and using anaphors to refer to previous discourse.
\item
  The packages \textbf{dplyr} and \textbf{magrittr} provide a limited version of such functionality, and we'll need to use \textbf{pipe} operators (\texttt{\%\textgreater{}\%} and \texttt{\%\textless{}\textgreater{}\%}) to link expressions with an `anaphoric dependency'.
\item
  Whenever you see \texttt{\%\textgreater{}\%}, you can think about it as the following: ``Take whatever is on the left side, and use it in the function that is on the right side.''
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(magrittr)}
\CommentTok{\# Typical notation. Read as "Divide 10 by 2."}
\FunctionTok{divide\_by}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Equivalent pipe notation. Read as "Take 10, and divide it by 2."}
\DecValTok{10} \SpecialCharTok{\%\textgreater{}\%} \FunctionTok{divide\_by}\NormalTok{(., }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Equivalent pipe notation. Read as "Take 2, and divide 10 by it."}
\DecValTok{2} \SpecialCharTok{\%\textgreater{}\%} \FunctionTok{divide\_by}\NormalTok{(}\DecValTok{10}\NormalTok{, .)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  If the dot operator occurs in the first argument slot, it can be omitted. (R has pro-drop.)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# pipe notation with omission of \textquotesingle{}.\textquotesingle{}}
\DecValTok{10} \SpecialCharTok{\%\textgreater{}\%} \FunctionTok{divide\_by}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's see how it can resolve the mess below. (Repetition of previous example.)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(}\FunctionTok{group\_by}\NormalTok{(dativeSimplified, AnimacyOfRec, AnimacyOfTheme), }
                  \AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 903 x 6}
\NormalTok{\#\# \# Groups:   AnimacyOfRec, AnimacyOfTheme [4]}
\NormalTok{\#\#    RealizationOfRec Verb  AnimacyOfRec AnimacyOfTheme LengthOfTheme perc\_NP}
\NormalTok{\#\#    \textless{}fct\textgreater{}            \textless{}fct\textgreater{} \textless{}fct\textgreater{}        \textless{}fct\textgreater{}                  \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 NP               feed  animate      inanimate              2.64    0.633}
\NormalTok{\#\#  2 NP               give  animate      inanimate              1.10    0.633}
\NormalTok{\#\#  3 NP               give  animate      inanimate              2.56    0.633}
\NormalTok{\#\#  4 NP               give  animate      inanimate              1.61    0.633}
\NormalTok{\#\#  5 NP               offer animate      inanimate              1.10    0.633}
\NormalTok{\#\#  6 NP               give  animate      inanimate              1.39    0.633}
\NormalTok{\#\#  7 NP               pay   animate      inanimate              1.39    0.633}
\NormalTok{\#\#  8 NP               bring animate      inanimate              0       0.633}
\NormalTok{\#\#  9 NP               teach animate      inanimate              2.40    0.633}
\NormalTok{\#\# 10 NP               give  animate      inanimate              0.693   0.633}
\NormalTok{\#\# \# i 893 more rows}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  And here is the much more readable version of this code:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{  dativeSimplified }\SpecialCharTok{\%\textgreater{}\%}
          \FunctionTok{mutate}\NormalTok{(., }\AttributeTok{long\_theme =} \FunctionTok{ifelse}\NormalTok{(LengthOfTheme }\SpecialCharTok{\textgreater{}} \FloatTok{1.6}\NormalTok{, }\StringTok{"long"}\NormalTok{, }\StringTok{"short"}\NormalTok{) ) }\SpecialCharTok{\%\textgreater{}\%} 
          \FunctionTok{group\_by}\NormalTok{(., long\_theme) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{          dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{(., }\AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  We don't actually need the dot:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{  dativeSimplified }\SpecialCharTok{\%\textgreater{}\%}
          \FunctionTok{mutate}\NormalTok{(}\AttributeTok{long\_theme =} \FunctionTok{ifelse}\NormalTok{(LengthOfTheme }\SpecialCharTok{\textgreater{}} \FloatTok{1.6}\NormalTok{, }\StringTok{"long"}\NormalTok{, }\StringTok{"short"}\NormalTok{) ) }\SpecialCharTok{\%\textgreater{}\%} 
          \FunctionTok{group\_by}\NormalTok{(long\_theme) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{          dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{(}\AttributeTok{perc\_NP =} \FunctionTok{mean}\NormalTok{(RealizationOfRec }\SpecialCharTok{==} \StringTok{"NP"}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  The \texttt{\%\textless{}\textgreater{}\%} operator is a convenient combination of \texttt{\%\textgreater{}\%} and \texttt{\textless{}-} which you can use to directly modify an object.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load the package magrittr in order to access the assignment pipe operator}
\FunctionTok{library}\NormalTok{(magrittr)}

\CommentTok{\# create a vector with numbers from 1 to 10}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\CommentTok{\# keep only numbers \textless{} 5:}
\CommentTok{\#   (i) without \%\textless{}\textgreater{}\%}
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ x[x}\SpecialCharTok{\textless{}}\DecValTok{5}\NormalTok{]}
\CommentTok{\#   (i) with \%\textless{}\textgreater{}\%}
\NormalTok{x }\SpecialCharTok{\%\textless{}\textgreater{}\%}\NormalTok{ .[.}\SpecialCharTok{\textless{}}\DecValTok{5}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# lets add several columns to \textquotesingle{}dativeSimplified\textquotesingle{}}
\NormalTok{dativeSimplified }\SpecialCharTok{\%\textless{}\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{A=}\DecValTok{1}\NormalTok{, }\AttributeTok{B=}\DecValTok{2}\NormalTok{, }\AttributeTok{C=}\DecValTok{3}\NormalTok{, }\AttributeTok{D=}\DecValTok{4}\NormalTok{)}
\FunctionTok{head}\NormalTok{(dativeSimplified)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   RealizationOfRec  Verb AnimacyOfRec AnimacyOfTheme LengthOfTheme A B C D}
\NormalTok{\#\# 1               NP  feed      animate      inanimate      2.639057 1 2 3 4}
\NormalTok{\#\# 2               NP  give      animate      inanimate      1.098612 1 2 3 4}
\NormalTok{\#\# 3               NP  give      animate      inanimate      2.564949 1 2 3 4}
\NormalTok{\#\# 4               NP  give      animate      inanimate      1.609438 1 2 3 4}
\NormalTok{\#\# 5               NP offer      animate      inanimate      1.098612 1 2 3 4}
\NormalTok{\#\# 6               NP  give      animate      inanimate      1.386294 1 2 3 4}
\end{Highlighting}
\end{Shaded}

\chapter{Plotting}\label{plotting-1}

(16 December, 2024, 13:49)

\section{The basics of ggplot2}\label{the-basics-of-ggplot2}

\begin{itemize}
\tightlist
\item
  Let's first take a look at some example plots.
\item
  Create a synthetic data set and load the \texttt{ggplot2} package to access the plotting functionality.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{a=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{a\_sq=}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{, }\AttributeTok{my\_group =} \FunctionTok{c}\NormalTok{(}\StringTok{"weekday"}\NormalTok{,}\StringTok{"weekend"}\NormalTok{))}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#     a a\_sq my\_group}
\NormalTok{\#\# 1   1    1  weekday}
\NormalTok{\#\# 2   2    4  weekend}
\NormalTok{\#\# 3   3    9  weekday}
\NormalTok{\#\# 4   4   16  weekend}
\NormalTok{\#\# 5   5   25  weekday}
\NormalTok{\#\# 6   6   36  weekend}
\NormalTok{\#\# 7   7   49  weekday}
\NormalTok{\#\# 8   8   64  weekend}
\NormalTok{\#\# 9   9   81  weekday}
\NormalTok{\#\# 10 10  100  weekend}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Take a look at the following code and the resulting plots. Can you tell what parts that start with geom\_\ldots{} does?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a, }\AttributeTok{y =}\NormalTok{ a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-136-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a, }\AttributeTok{y =}\NormalTok{ a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat=}\StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-137-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a\_sq, }\AttributeTok{y =}\NormalTok{ a)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-138-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a\_sq, }\AttributeTok{y =}\NormalTok{ a)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat=}\StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-139-1.pdf}

\section{The basics of ggplot2}\label{the-basics-of-ggplot2-1}

\begin{itemize}
\item
  So what do those function calls mean?
\item
  Let's take a look at it again: This is pretty much the minimal useful plotting command in R.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a, }\AttributeTok{y =}\NormalTok{ a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Each ggplot2 plot specification consists, at a minimum, of three parts:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    {the data to plot}
  \item
    {\emph{an abstract specification of the plot} (a rough mapping between variables and axes and other plot elements, such as \emph{groups}, \emph{facets}, etc.)}
  \item
    {\emph{concrete instructions on what to draw} (a specification of the actual visual elements to use)}
  \end{enumerate}
\item
  They correspond to three parts of the \texttt{ggplot()} function call

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    {\textbf{data:} \texttt{data\ =\ df}}
  \item
    {\textbf{`aesthetic':} \texttt{mapping\ =\ aes(x,\ y)}}
  \item
    {\textbf{`geoms':} \texttt{+\ geom\_point()}}
  \end{enumerate}
\item
  You can read the instruction below as \emph{``Create a plot {using the data in data frame df}, {placing \texttt{a} on the x-axis and \texttt{a\_sq} on the y-axis}, {and visualize the data using points}''}.
\item
  Keep in mind that information regarding x and y axes is specified within a function called \texttt{aes()}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ a, }\AttributeTok{y =}\NormalTok{ a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  As an aside: A shorter way to write the same code is below, and I'll mostly use some mixed form.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\section{Using lines in plots}\label{using-lines-in-plots}

\begin{itemize}
\item
  We already know \texttt{geom\_point} and \texttt{geom\_bar}. Let's take a look at some other \emph{geoms}:.
\item
  \texttt{geom\_line} connects the (invisible, in this case) points in the plot.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-143-1.pdf}

\begin{itemize}
\tightlist
\item
  We can even combine geoms:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-144-1.pdf}

\begin{itemize}
\tightlist
\item
  \ldots{} in fact, as many as we want. But there is no guarantee that the result will look good, or even make sense.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-145-1.pdf}

\begin{itemize}
\tightlist
\item
  The order of their specification matter a little bit. Here, the line is plotted over the bars, in contrast to the previous plot.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-146-1.pdf}

\section{Color and fill}\label{color-and-fill}

\begin{itemize}
\item
  Relationships between two variables are usually easy to visualize, but often there is a third variable.
\item
  There are various ways for dealing with it.
\item
  Let's first try using color coding for the third variable.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-147-1.pdf}

\begin{itemize}
\tightlist
\item
  Let's try this with bar plots. Not at all what you expected, is it?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-148-1.pdf}

\begin{itemize}
\tightlist
\item
  This is what we wanted. The right argument for bar plots is \texttt{fill}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{fill =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-149-1.pdf}

\begin{itemize}
\item
  So why isn't the aesthetic argument for bar plots not also \texttt{color}?
\item
  Because geoms in ggplot2 have \texttt{fill} (the color of the inner part of the object), and a \texttt{color} (the color of the line with which they are drawn).
\item
  Points don't have a fill. (Don't ask me why.)
\item
  We can try, if you do not believe me. See that even though we specify a \texttt{fill} argument for geom\_point, \texttt{color} argument overwrites it.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{10}\NormalTok{, }\AttributeTok{fill =} \StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-150-1.pdf}
- If points had a fill, we would expect the argument that comes last to overwrite the previous one.
- Bars have both fill and color arguments.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{fill =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat=}\StringTok{"identity"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-151-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat=}\StringTok{"identity"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-152-1.pdf}

\section{Grouping and facets}\label{grouping-and-facets}

\begin{itemize}
\tightlist
\item
  Color, fill, etc. implicitly group the data set into different subgroups.
\item
  You can see that better if you connect the points by lines.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-153-1.pdf}

\begin{itemize}
\tightlist
\item
  This can be done explicitly as well.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{group =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-154-1.pdf}

\begin{itemize}
\tightlist
\item
  Now it's very hard to see which line is which, so let's at least separate it into different \textbf{facets} (aka \emph{`panels'}).
\item
  We can introduce our new facets with the function \texttt{facet\_wrap()}. Keep in mind that the grouping variable is introduced with \texttt{\textasciitilde{}}.
\item
  The name of the groups can be seen at the top of the plots.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-155-1.pdf}

\section{Adding Labels to the Plot}\label{adding-labels-to-the-plot}

\begin{itemize}
\tightlist
\item
  Plots are more meaningful when they have a title and labels indicating what the plot is about and what each axis represents.
\item
  We can add titles and labels using the \texttt{labs()} function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \StringTok{"y axis = a squared"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-156-1.pdf}

\begin{itemize}
\tightlist
\item
  Notice that sometimes we want to use a mathematical expression in the labels or title. For example, we should be able to write \(a^2\) rather than a squared.
\item
  For this we can use the \texttt{expression} function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"y axis ="} \SpecialCharTok{\textasciitilde{}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-157-1.pdf}

\begin{itemize}
\tightlist
\item
  We can further modify the size of the title and the labels either by selecting a predefined theme or manually defining the size, font, color, etc.
\end{itemize}

\subsection{Classic Theme}\label{classic-theme}

\begin{itemize}
\tightlist
\item
  Here is a classic theme
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"y axis ="} \SpecialCharTok{\textasciitilde{}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-158-1.pdf}

\subsection{Minimal Theme}\label{minimal-theme}

Here is a minimal theme

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"y axis ="} \SpecialCharTok{\textasciitilde{}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-159-1.pdf}

\subsection{Dark Theme}\label{dark-theme}

Here is a dark theme

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"y axis ="} \SpecialCharTok{\textasciitilde{}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_dark}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-160-1.pdf}

\subsection{Modifying the size of the title and labels.}\label{modifying-the-size-of-the-title-and-labels.}

We can specify the font size, face, color etc. by adding some arguments into the theme function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(a, a\_sq, }\AttributeTok{color =}\NormalTok{ my\_group)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{my\_group) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"My First Plot"}\NormalTok{, }\AttributeTok{x =} \StringTok{" x axis = a"}\NormalTok{, }\AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"y axis ="} \SpecialCharTok{\textasciitilde{}}\NormalTok{ a}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{20}\NormalTok{, }\AttributeTok{color =}\StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{, }\AttributeTok{face =} \StringTok{\textquotesingle{}bold\textquotesingle{}}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =}\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\AttributeTok{face =} \StringTok{\textquotesingle{}bold\textquotesingle{}}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =}\StringTok{\textquotesingle{}brown\textquotesingle{}}\NormalTok{, }\AttributeTok{face =} \StringTok{\textquotesingle{}bold\textquotesingle{}}\NormalTok{),}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}gray20\textquotesingle{}}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}gray20\textquotesingle{}}\NormalTok{),}
    \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{20}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, }\AttributeTok{face =} \StringTok{\textquotesingle{}bold\textquotesingle{}}\NormalTok{),}
    \AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-161-1.pdf}

\chapter{Descriptive Statistics}\label{descriptive-statistics}

Anytime you have some data, one of the first tasks you need to do is to find ways to summarize your data neatly. Raw data by itself will not make much sense. So, you want to calculate some summary statistics that describes your data. This is \textbf{descriptive statistics} (as opposed to \textbf{inferential statistics}).

Let us start with a simple dataset about the mammalian sleep hours.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(magrittr)}
\FunctionTok{library}\NormalTok{(lsr)}
\NormalTok{mammalian\_sleep }\OtherTok{\textless{}{-}} 
      \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./data/msleep\_ggplot2.csv"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
      \FunctionTok{select}\NormalTok{(name, sleep\_total, bodywt) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{rename}\NormalTok{(}\AttributeTok{sleep\_total\_h =}\NormalTok{ sleep\_total, }\AttributeTok{bodywt\_kg =}\NormalTok{ bodywt) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sleep\_total\_h =} \FunctionTok{round}\NormalTok{(sleep\_total\_h) )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 83 Columns: 11
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (5): name, genus, vore, order, conservation
## dbl (6): sleep_total, sleep_rem, sleep_cycle, awake, brainwt, bodywt
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mammalian\_sleep)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 6 x 3}
\NormalTok{\#\#   name                       sleep\_total\_h bodywt\_kg}
\NormalTok{\#\#   \textless{}chr\textgreater{}                              \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 Cheetah                               12    50    }
\NormalTok{\#\# 2 Owl monkey                            17     0.48 }
\NormalTok{\#\# 3 Mountain beaver                       14     1.35 }
\NormalTok{\#\# 4 Greater short{-}tailed shrew            15     0.019}
\NormalTok{\#\# 5 Cow                                    4   600    }
\NormalTok{\#\# 6 Three{-}toed sloth                      14     3.85}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  There are three variables here, \texttt{name}, \texttt{sleep\_total\_h} and \texttt{bodywt\_kg}. For each animal named in \texttt{name}, the \texttt{sleep\_total\_h} variable contains the average number of hours animals of this kind sleep per day. The variable \texttt{bodywt\_kg} contains the average weight of that animal in kg.
\item
  Let's have a look at the \texttt{sleep\_total\_h} variable:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] 12 17 14 15  4 14  9  7 10  3  5  9 10 12 10  8  9 17  5 18  4 20  3  3 10}
\NormalTok{\#\# [26] 11 15 12 10  2  3  6  6  8 10  3 19 10 14 14 13 12 20 15 11  8 14  8  4 10}
\NormalTok{\#\# [51] 16 10 14  9 10 11 12 14  4  6 11 18  5 13  9 10  8 11 11 17 14 16 13  9  9}
\NormalTok{\#\# [76] 16  4 16  9  5  6 12 10}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  This output doesn't make it easy to get a sense of what the data are actually saying. Just ``looking at the data'' isn't a terribly effective way of understanding data. In order to get some idea about what's going on, we need to calculate some descriptive statistics and draw some nice pictures.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mammalian\_sleep, }\FunctionTok{aes}\NormalTok{(sleep\_total\_h)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\DecValTok{1}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/histogram1-1.pdf}
\caption{\label{fig:histogram1}A histogram of the average amount of sleep by animal (the \texttt{sleep\_total\_h} variable). As you might expect, the larger the margin the less frequently you tend to see it.}
\end{figure}

\section{Distributions}\label{distributions}

Let us see a couple more data examples to get a sense of what data might look like in the wild. First, let us generate some random data with a \textbf{uniform distribution} using the \texttt{runif()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uniform }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble\_col}\NormalTok{(}\FunctionTok{runif}\NormalTok{(}\DecValTok{120}\NormalTok{, }\AttributeTok{min =} \DecValTok{1}\NormalTok{, }\AttributeTok{max =} \DecValTok{6}\NormalTok{),}\AttributeTok{column\_name =} \StringTok{"some\_value"}\NormalTok{)}

\NormalTok{uniform}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 120 x 1}
\NormalTok{\#\#    some\_value}
\NormalTok{\#\#         \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1       2.23}
\NormalTok{\#\#  2       1.21}
\NormalTok{\#\#  3       2.64}
\NormalTok{\#\#  4       5.77}
\NormalTok{\#\#  5       5.45}
\NormalTok{\#\#  6       4.46}
\NormalTok{\#\#  7       4.20}
\NormalTok{\#\#  8       5.97}
\NormalTok{\#\#  9       4.28}
\NormalTok{\#\# 10       4.54}
\NormalTok{\#\# \# i 110 more rows}
\end{Highlighting}
\end{Shaded}

Let us plot the uniformly distributed data using a histogram.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(uniform, }\FunctionTok{aes}\NormalTok{(some\_value)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{boundary=}\DecValTok{0}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/histogram2-1.pdf}
\caption{\label{fig:histogram2}Histogram of a uniform distribution.}
\end{figure}

This looks good but it doesn't make as much intuitive sense as we'd like. Let us tweak this slightly. Assume that you have a fair dice with 6 sides. So, whenever we roll the dice, each side has an equal probability (i.e.~1/6). Let us simulate this. The data is going to be very similar, except that this time we will need \textbf{discrete} values rather than \textbf{continuous} values. For that, we need to use the \texttt{rdunif()} function which generates random values with a discrete uniform distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uniform }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble\_col}\NormalTok{(}\FunctionTok{rdunif}\NormalTok{(}\DecValTok{120}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{column\_name=}\StringTok{"dice\_value"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `rdunif()` was deprecated in purrr 1.0.0.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uniform}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 120 x 1}
\NormalTok{\#\#    dice\_value}
\NormalTok{\#\#         \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1          2}
\NormalTok{\#\#  2          2}
\NormalTok{\#\#  3          6}
\NormalTok{\#\#  4          4}
\NormalTok{\#\#  5          4}
\NormalTok{\#\#  6          6}
\NormalTok{\#\#  7          1}
\NormalTok{\#\#  8          6}
\NormalTok{\#\#  9          6}
\NormalTok{\#\# 10          6}
\NormalTok{\#\# \# i 110 more rows}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(uniform, }\FunctionTok{aes}\NormalTok{(dice\_value)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
           \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-165-1.pdf}

\begin{verbatim}
Just a quick point to think about. Why did we use a histogram for the 
continuous uniform distribution and a bar graph for a discrete one? 
\end{verbatim}

Now, let us generate some random data with a \textbf{normal distribution} using the \texttt{rnorm}()` function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{normal }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{160}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Let us plot the normally distributed data using a histogram.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(normal, }\FunctionTok{aes}\NormalTok{(value)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.2}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/histogram3-1.pdf}
\caption{\label{fig:histogram3}Histogram of a normal distribution.}
\end{figure}

Here's another one where we provide the \textbf{mean} and \textbf{standard deviation} parameteres.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{normal2 }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{160}\NormalTok{, }\AttributeTok{mean =} \DecValTok{8}\NormalTok{, }\AttributeTok{sd=} \FloatTok{0.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Let us plot the second normally distributed data using a histogram.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(normal2, }\FunctionTok{aes}\NormalTok{(value)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.2}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/histogram4-1.pdf}
\caption{\label{fig:histogram4}Histogram of a normal distribution.}
\end{figure}

Finally, let us plot both of the normally distributed data on the same plot to see them side by side.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(normal, }\FunctionTok{aes}\NormalTok{(value)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.2}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
          \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{data=}\NormalTok{normal2, }\AttributeTok{binwidth=}\FloatTok{0.2}\NormalTok{,}\AttributeTok{boundary=}\DecValTok{0}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/histogram5-1.pdf}
\caption{\label{fig:histogram5}Histogram of two normal distributions side by side.}
\end{figure}

\begin{figure}
\centering
\includegraphics{./img/descriptives2/data_distribution.png}
\caption{\label{fig:normaldatadistributions}Distributions with different means and standard deviations.}
\end{figure}

\begin{figure}
\centering
\includegraphics{./img/descriptives2/normal_distribution.png}
\caption{\label{fig:normalparameterdistributions}Distributions with different means and standard deviations. The light gray area covers the 68\% of the data and the total of the gray areas cover the 95\% of the data.}
\end{figure}

\section{Measures of central tendency}\label{centraltendency}

Drawing pictures of the data, as I did in Figure \ref{fig:histogram1} is an excellent way to convey the ``gist'' of what the data is trying to tell you, it's often extremely useful to try to condense the data into a few simple ``summary'' statistics. In most situations, the first thing that you'll want to calculate is a measure of \textbf{\emph{central tendency}}. That is, you'd like to know something about the ``average'' or ``middle'' of your data lies. The three most commonly used measures are the \textbf{mean}, \textbf{median} and \textbf{mode}; occasionally people will also report a trimmed mean. I'll explain each of these in turn, and then discuss when each of them is useful.

\subsection{The mean}\label{mean}

\begin{itemize}
\item
  The \textbf{\emph{mean}} of a set of observations is just a normal, old-fashioned average: add all of the values up, and then divide by the total number of values. The first five animals' typical amount of sleep is 12 + 17 + 14 + 15 + 4, so the mean of these observations is just:
  \[
  \frac{12 + 17 + 14 + 15 + 4}{5} = \frac{62.4}{5} = 12.48
  \]
\item
  Of course, this definition of the mean isn't news to anyone: averages (i.e., means) are used so often in everyday life that this is pretty familiar stuff. However, since the concept of a mean is something that everyone already understands, I'll use this as an excuse to start introducing some of the mathematical notation that statisticians use to describe this calculation, and talk about how the calculations would be done in R.
\item
  The first piece of notation to introduce is \(N\), which we'll use to refer to the number of observations that we're averaging (in this case \(N = 5\)).
\item
  Next, we need to attach a label to the observations themselves. It's traditional to use \(X\) for this, and to use subscripts to indicate which observation we're actually talking about.
\item
  That is, we'll use \(X_1\) to refer to the first observation, \(X_2\) to refer to the second observation, and so on, all the way up to \(X_N\) for the last one. Or, to say the same thing in a slightly more abstract way, we use \(X_i\) to refer to the \(i\)-th observation. Just to make sure we're clear on the notation, the following table lists the 5 observations in the \texttt{sleep\_total\_h} variable, along with the mathematical symbol used to refer to it, and the actual value that the observation corresponds to:
\end{itemize}

\begin{tabular}{lll}
\toprule
the observation & its symbol & the observed value\\
\midrule
Cheetah (animal 1) & \$X\_1\$ & 12 hours\\
Owl monkey (animal 2) & \$X\_2\$ & 17 hours\\
Mountain beaver (animal 3) & \$X\_3\$ & 14 hours\\
Greater short-tailed shrew (animal 4) & \$X\_4\$ & 15 hours\\
Cow (animal 5) & \$X\_5\$ & 4 hours\\
\bottomrule
\end{tabular}

\begin{itemize}
\item
  Okay, now let's try to write a formula for the mean. By tradition, we use \(\bar{X}\) as the notation for the mean. So the calculation for the mean could be expressed using the following formula:
  \[
  \bar{X} = \frac{X_1 + X_2 + ... + X_{N-1} + X_N}{N}
  \]
\item
  This formula is entirely correct, but it's terribly long, so we make use of the \textbf{\emph{summation symbol}} \(\scriptstyle\sum\) to shorten it.\footnote{The choice to use \(\Sigma\) to denote summation isn't arbitrary: it's the Greek upper case letter sigma, which is the analogue of the letter S in that alphabet. Similarly, there's an equivalent symbol used to denote the multiplication of lots of numbers: because multiplications are also called ``products'', we use the \(\Pi\) symbol for this; the Greek upper case pi, which is the analogue of the letter P.} If I want to add up the first five observations, I could write out the sum the long way, \(X_1 + X_2 + X_3 + X_4 +X_5\) or I could use the summation symbol to shorten it to this:
  \[
  \sum_{i=1}^5 X_i
  \]
\item
  Taken literally, this could be read as ``the sum, taken over all \(i\) values from 1 to 5, of the value \(X_i\)''. But basically, what it means is ``add up the first five observations''. In any case, we can use this notation to write out the formula for the mean, which looks like this:
  \[
  \bar{X} = \frac{1}{N} \sum_{i=1}^N X_i 
  \]
\item
  In all honesty, I can't imagine that all this mathematical notation helps clarify the concept of the mean at all. In fact, it's really just a fancy way of writing out the same thing I said in words: add all the values up, and then divide by the total number of items. However, that's not really the reason I went into all that detail.
\item
  My goal was to try to make sure that everyone reading this book is clear on the notation that we'll be using throughout the book: \(\bar{X}\) for the mean, \(\scriptstyle\sum\) for the idea of summation, \(X_i\) for the \(i\)th observation, and \(N\) for the total number of observations.
\item
  We're going to be re-using these symbols a fair bit, so it's important that you understand them well enough to be able to ``read'' the equations, and to be able to see that it's just saying ``add up lots of things and then divide by another thing''.
\end{itemize}

\subsection{Calculating the mean in R}\label{calculating-the-mean-in-r}

Okay that's the maths, how do we get the magic computing box to do the work for us? If you really wanted to, you could do this calculation directly in R. For the first numbers, do this just by typing it in as if R were a calculator\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\DecValTok{12} \SpecialCharTok{+} \DecValTok{17} \SpecialCharTok{+} \DecValTok{14} \SpecialCharTok{+} \DecValTok{15} \SpecialCharTok{+} \DecValTok{4}\NormalTok{) }\SpecialCharTok{/} \DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 12.4}
\end{Highlighting}
\end{Shaded}

\ldots{} in which case R outputs the answer 12.4, just as if it were a calculator.

\begin{itemize}
\tightlist
\item
  However, we learned quicker ways of doing that
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{] )}\SpecialCharTok{/} \DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 12.4}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# or:}
\FunctionTok{mean}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{] )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 12.4}
\end{Highlighting}
\end{Shaded}

\subsection{The median}\label{median}

\begin{itemize}
\item
  The second measure of central tendency that people use a lot is the \textbf{\emph{median}}, and it's even easier to describe than the mean. The median of a set of observations is just the middle value.
\item
  As before let's imagine we were interested only in the first 5 animals: They sleep 12, 17, 14, 15, and 4 hours respectively. To figure out the median, we sort these numbers into ascending order:
  \[
  4, 12, \color{red}{14}, 15, 17
  \]
\item
  From inspection, it's obvious that the median value of these 5 observations is 14, since that's the middle one in the sorted list (I've put it in red to make it even more obvious). Easy stuff.
\item
  But what should we do if we were interested in the first 6 animals rather than the first 5? Since the sixth animal sleeps for 14 hours, our sorted list is now:
  \[
  4, 12, \color{red}{14}, \color{red}{14}, 15, 17
  \]
\item
  That's also easy. It's still 14.
\item
  But what we do if we were interested in the first 8 animals? Here is our new sorted list.
  \[
  4,  7,  9, \color{red}{12}, \color{red}{14}, 14, 15, 17
  \]
\item
  There are now \emph{two} middle numbers, 12 and 14. The median is defined as the average of those two numbers, which is of course 13.
\item
  To understand why, think of the median as the value that divides the sorted list of numbers into two halves -- those on its left, and those on its right.
\item
  As before, it's very tedious to do this by hand when you've got lots of numbers. To illustrate this, here's what happens when you use R to sort all the sleep durations. First, I'll use the \texttt{sort()} function to display the 83 numbers in increasing numerical order:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  2  3  3  3  3  3  4  4  4  4  4  5  5  5  5  6  6  6  6  7  8  8  8  8  8}
\NormalTok{\#\# [26]  9  9  9  9  9  9  9  9 10 10 10 10 10 10 10 10 10 10 10 10 11 11 11 11 11}
\NormalTok{\#\# [51] 11 12 12 12 12 12 12 13 13 13 14 14 14 14 14 14 14 14 15 15 15 16 16 16 16}
\NormalTok{\#\# [76] 17 17 17 18 18 19 20 20}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Because the vector is 83 elements long, the middle value is at position 42. This means that the median of this vector is 10. In real life, of course, no-one actually calculates the median by sorting the data and then looking for the middle value. In real life, we use the median command:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 10}
\end{Highlighting}
\end{Shaded}

which outputs the median value of 10.

\subsection{Mean or median? What's the difference?}\label{mean-or-median-whats-the-difference}

\includegraphics{./img/descriptives2/meanmedian.png}

\begin{itemize}
\item
  Knowing how to calculate means and medians is only a part of the story. You also need to understand what each one is saying about the data, and what that implies for when you should use each one. This is illustrated in Figure \ref{fig:meanmedian} the mean is kind of like the ``centre of gravity'' of the data set, whereas the median is the ``middle value'' in the data. What this implies, as far as which one you should use, depends a little on what type of data you've got and what you're trying to achieve. As a rough guide:
\item
  One consequence is that there's systematic differences between the mean and the median when the histogram is asymmetric (skewed). This is illustrated in Figure \ref{fig:meanmedian} notice that the median (right hand side) is located closer to the ``body'' of the histogram, whereas the mean (left hand side) gets dragged towards the ``tail'' (where the extreme values are).
\item
  To give a concrete example, suppose Bob (income \$50,000), Kate (income \$60,000) and Jane (income \$65,000) are sitting at a table: the average income at the table is \$58,333 and the median income is \$60,000. Then Bill sits down with them (income \$100,000,000). The average income has now jumped to \$25,043,750 but the median rises only to \$62,500. If you're interested in looking at the overall income at the table, the mean might be the right answer; but if you're interested in what counts as a typical income at the table, the median would be a better choice here.
\end{itemize}

\begin{figure}
\centering
\includegraphics{./img/descriptives2/mean_median.png}
\caption{\label{fig:meanmedian2}Another example of mean and median where mean is moved by the outliers but median is constant.}
\end{figure}

\subsection{Trimmed mean}\label{trimmedmean}

\begin{itemize}
\item
  One of the fundamental rules of applied statistics is that the data are messy. Real life is never simple, and so the data sets that you obtain are never as straightforward as the statistical theory says.\footnote{Or at least, the basic statistical theory -- these days there is a whole subfield of statistics called \emph{robust statistics} that tries to grapple with the messiness of real data and develop theory that can cope with it.} This can have awkward consequences. To illustrate, consider this rather strange looking data set (nevermind what it represents):
  \[
  -100,2,3,4,5,6,7,8,9,10
  \]
\item
  If you were to observe this in a real life data set, you'd probably suspect that something funny was going on with the \(-100\) value. It's probably an \textbf{\emph{outlier}}, a value that doesn't really belong with the others. You might consider removing it from the data set entirely, and in this particular case I'd probably agree with that course of action.
\item
  In real life, however, you don't always get such cut-and-dried examples. For instance, you might get this instead:
  \[
  -15,2,3,4,5,6,7,8,9,12
  \]
\item
  The \(-15\) looks a bit suspicious, but not anywhere near as much as that \(-100\) did. In this case, it's a little trickier. It \emph{might} be a legitimate observation, it might not.
\item
  When faced with a situation where some of the most extreme-valued observations might not be quite trustworthy, the mean is not necessarily a good measure of central tendency. It is highly sensitive to one or two extreme values, and is thus not considered to be a \textbf{\emph{robust}} measure.
\item
  One remedy that we've seen is to use the median. A more general solution is to use a ``trimmed mean''. To calculate a trimmed mean, what you do is ``discard'' the most extreme examples on both ends (i.e., the largest and the smallest), and then take the mean of everything else. The goal is to preserve the best characteristics of the mean and the median:

  \begin{itemize}
  \tightlist
  \item
    just like a median, you aren't highly influenced by extreme outliers, but \ldots{}
  \item
    like the mean, you ``use'' more than one of the observations.
  \end{itemize}
\item
  Generally, we describe a trimmed mean in terms of the percentage of observation on either side that are discarded. So, for instance, a 10\% trimmed mean discards the largest 10\% of the observations \emph{and} the smallest 10\% of the observations, and then takes the mean of the remaining 80\% of the observations.
\item
  Not surprisingly, the 0\% trimmed mean is just the regular mean, and the 50\% trimmed mean is the median. In that sense, trimmed means provide a whole family of central tendency measures that span the range from the mean to the median.
\item
  For our toy example above, we have 10 observations, and so a 10\% trimmed mean is calculated by ignoring the largest value (i.e., \texttt{12}) and the smallest value (i.e., \texttt{-15}) and taking the mean of the remaining values. First, let's enter the data
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{( }\SpecialCharTok{{-}}\DecValTok{15}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{12}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

Next, let's calculate means and medians:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{( dataset )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 4.1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{( dataset )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  That's a fairly substantial difference, but I'm tempted to think that the mean is being influenced a bit too much by the extreme values at either end of the data set, especially the \(-15\) one. So let's just try trimming the mean a bit. If I take a 10\% trimmed mean, we'll drop the extreme values on either side, and take the mean of the rest:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{( dataset, }\AttributeTok{trim =}\NormalTok{ .}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 5.5}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  In this case it gives exactly the same answer as the median. Note that, to get a 10\% trimmed mean you write \texttt{trim\ =\ .1}, not \texttt{trim\ =\ 10}.
\end{itemize}

\subsection{Mode}\label{mode}

\begin{itemize}
\item
  The \textbf{\emph{mode}} is the last measure of central tendency we'll look at. It is very simple: it is the value that occurs most frequently.
\item
  Let's look at the some soccer data: specifically, the European Cup and Champions League results in the time from 1955-2016.
\item
  Lets find out which team has won the most matches. The command below tells R we just want the first 25 rows of the data.frame.
\end{itemize}

\subsection{Summary}\label{summary}

\begin{itemize}
\tightlist
\item
  There are multiple measures of central tendency that can be used to summarize an aspect of a distribution: \textbf{\_ (arithmetic) mean, median, and mode\_}.
\item
  They answer different questions about distribution. For example, in the distribution of number of goals per game in the previous section

  \begin{itemize}
  \tightlist
  \item
    mean: ``If the same number of goals were scored in each game, how many goals would be scored?''
  \item
    median: ``What is a `mediocre' game like?''
  \item
    mode: ``What is the most typical game like?''
  \end{itemize}
\end{itemize}

\section{Measures of variability}\label{var}

\begin{itemize}
\tightlist
\item
  The statistics that we've discussed so far all relate to \emph{central tendency}. That is, they all talk about which values are ``in the middle'' or ``popular'' in the data.
\item
  The second thing that we really want is a measure of the \textbf{\emph{variability}} of the data.

  \begin{itemize}
  \tightlist
  \item
    That is, how ``spread out'' are the data?
  \item
    In other words, how `representative' is our measure of central tendency of most data points.
  \end{itemize}
\item
  Let's consider interval and ratio scale data.
\end{itemize}

\subsection{Range}\label{range}

\begin{itemize}
\tightlist
\item
  The \textbf{\emph{range}} of a variable is very simple: it's the biggest value minus the smallest value. For the sleep data, the maximum value is 20, and the minimum value is 2. We can calculate these values in R using the \texttt{max()} and \texttt{min()} functions:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{max}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 20}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{min}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

where I've omitted the output because it's not interesting.

\begin{itemize}
\tightlist
\item
  The other possibility is to use the \texttt{range()} function; which outputs both the minimum value and the maximum value in a vector, like this:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{range}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1]  2 20}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Although the range is the simplest way to quantify the notion of ``variability'', it's one of the worst. Recall from our discussion of the mean that we want our summary measure to be robust. If the data set has one or two extremely bad values in it, we'd like our statistics not to be unduly influenced by these cases. If we look once again at our toy example of a data set containing very extreme outliers\ldots{}
  \[
  -100,2,3,4,5,6,7,8,9,10
  \]
  \ldots{} it is clear that the range is not robust, since this has a range of 110, but if the outlier were removed we would have a range of only 8.
\end{itemize}

\subsection{Quantiles and percentile}\label{quantiles-and-percentile}

\begin{itemize}
\item
  A key concept we will need to build on to conceptualize several other measures of variability are \textbf{\emph{quantiles}} or \textbf{\emph{percentiles}}.
\item
  A \textbf{\emph{percentile}} is the smallest value in a dataset such that a set percentage is smaller than it. (A \textbf{\emph{quantile}} does pretty much the same but is more generic.)
\item
  For example, if the 10-th percentile (i.e., the \(0.1\) quantile) of a list of values is 73, this means that 10 percent of the values are smaller than or equal to 73.
\item
  Let's take a look at the 20 shortest sorted sleep durations and determine the 10-th percentile (\(0.1\) quantile), 30-th percentile (\(0.3\) quantile), 50-th percentile (\(0.5\) quantile), and the 90-th percentile (\(0.9\) quantile).
\item
  Here are the values:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] 2 3 3 3 3 3 4 4 4 4 4 5 5 5 5 6 6 6 6 7}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  And here is a sorted plot of the 20 smallest values:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quantile }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.3}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.9}\NormalTok{)}
\NormalTok{quantile\_points }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{,}\FloatTok{0.3}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.9}\NormalTok{)}\SpecialCharTok{*}\DecValTok{20}
\NormalTok{quantile\_labels }\OtherTok{\textless{}{-}} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%0.1f quantile}\SpecialCharTok{\textbackslash{}n}\StringTok{(point \%d of 20)"}\NormalTok{, quantile, quantile\_points)}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{, }\AttributeTok{y=}\FunctionTok{sort}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{])) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ quantile\_points) }\SpecialCharTok{+}
    \FunctionTok{geom\_label}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{quantile\_points, }\AttributeTok{y=}\FloatTok{6.5}\NormalTok{, }\AttributeTok{label=}\NormalTok{quantile\_labels )) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{"Position in ordered vector"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Sleep (hours)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-179-1.pdf}

\begin{itemize}
\tightlist
\item
  As you can see:

  \begin{itemize}
  \tightlist
  \item
    10-th percentile (\(0.1\) quantile): 2 {[}to be found at position 2, since 2 data points constitute 10 percent of the data{]}
  \item
    30-th percentile (\(0.3\) quantile): 6 {[}to be found at position 6, since 6 data points constitute 30 percent of the data{]}
  \item
    50-th percentile (\(0.5\) quantile): 10 {[}to be found at position 10, since 10 data points constitute 50 percent of the data{]}
  \item
    90-th percentile (\(0.9\) quantile): 18 {[}to be found at position 18, since 18 data points constitute 90 percent of the data{]}
  \end{itemize}
\item
  The 50-th percentile is the median.
\end{itemize}

\subsection{Interquartile range}\label{interquartile-range}

\begin{itemize}
\tightlist
\item
  The \textbf{\emph{interquartile range}} (IQR) is like the range, but instead of calculating the difference between the biggest and smallest value, it calculates the difference between the 25th quantile and the 75th quantile.
\item
  R provides you with a way of calculating quantiles, using the (surprise, surprise) \texttt{quantile()} function. Let's use it to calculate the median sleep durations:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{( }\AttributeTok{x =}\NormalTok{ mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h, }\AttributeTok{probs =}\NormalTok{ .}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# 50\% }
\NormalTok{\#\#  10}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  And not surprisingly, this agrees with the answer that we saw earlier with the \texttt{median()} function. Now, we can actually input lots of quantiles at once, by specifying a vector for the \texttt{probs} argument. So lets do that, and get the 25th and 75th percentile:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{( }\AttributeTok{x =}\NormalTok{ mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h, }\AttributeTok{probs =} \FunctionTok{c}\NormalTok{(.}\DecValTok{25}\NormalTok{,.}\DecValTok{75}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# 25\% 75\% }
\NormalTok{\#\#   8  14}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  And, by noting that \(14 - 8 = 6\), we can see that the interquartile range for the sleep durations is 6. Of course, that seems like too much work to do all that typing, so R has a built in function called \texttt{IQR()} that we can use:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{( }\AttributeTok{x =}\NormalTok{ mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 6}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  While it's obvious how to interpret the range, it's a little less obvious how to interpret the IQR. The simplest way to think about it is like this: the interquartile range is the range spanned by the ``middle half'' of the data. That is, one quarter of the data falls below the 25th percentile, one quarter of the data is above the 75th percentile, leaving the ``middle half'' of the data lying in between the two. And the IQR is the range covered by that middle half.
\item
  IQR is used to identify the outliers (i.e.~extreme values). Any value above \texttt{Q3\ +\ IQR\ *1.5} or below \texttt{Q1\ -\ IQR*1.5} is considered to be an outlier.
\end{itemize}

\subsection{Mean absolute deviation}\label{aad}

\begin{itemize}
\item
  The range and the interquartile range, both rely on the idea that we can measure the spread of the data by looking at the quantiles of the data.
\item
  However, this isn't the only way to think about the problem. A different approach is to select a meaningful reference point (usually the mean or the median) and then report the \textbf{\emph{``typical'' deviations}} from that reference point.
\item
  Let's go through the \textbf{\emph{mean absolute deviation}} (AAD for average absolute deviation, since MAD is reserved for the median absolute deviation) from the mean a little more slowly. One useful thing about this measure is that the name actually tells you exactly how to calculate it:
  \[
  AAD(X) = \frac{1}{N} \sum_{i = 1}^N |X_i - \bar{X}|
  \]
\item
  Let's compute the AAD for the first data points in the sleep data:
  \[
  12, 17, 14, 15, 4
  \]
\item
  The mean of the dataset is 12.4. That is, \(\bar{X} = 12.4\)
\item
  The deviations \(X_i - \bar{X}\) are:
  \[
  -0.4, 4.6, 1.6, 2.6, -8.4
  \]
\item
  The absolute deviations \(|X_i - \bar{X}|\) are:
  \[
  0.4, 4.6, 1.6, 2.6, 8.4
  \]
\item
  The sum of the absolute deviations \(\sum_{i = 1}^N |X_i - \bar{X}|\) is 17.6.
\item
  And \(N=5\), which means, that, in our case: \(AAD(X) = \frac{1}{N} \sum_{i = 1}^N |X_i - \bar{X}| = 3.52\)
\item
  In R, we can compute it for the entire vector.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mean\_sleep }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)}
\NormalTok{deviation\_sleep }\OtherTok{\textless{}{-}}\NormalTok{ mean\_sleep }\SpecialCharTok{{-}}\NormalTok{ mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h}
\FunctionTok{mean}\NormalTok{( }\FunctionTok{abs}\NormalTok{(deviation\_sleep) )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 3.576717}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  An alternative, more compact way to write it is using (lots) pipes:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{subtract}\NormalTok{(., }\FunctionTok{mean}\NormalTok{(.)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{abs}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mean}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 3.576717}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  The interpretation of the AAD is quite straightforward: It is the average distance from the average. When it's big, the values are quite spread out. When it's small, they are close. The units are the same (hours in our case).
\end{itemize}

\subsection{Variance}\label{variance}

\begin{itemize}
\item
  Although the mean absolute deviation measure has its uses, it's not the best measure of variability to use.
\item
  For a number of practical reasons, there are some solid reasons to prefer squared deviations rather than absolute deviations. A measure of variability based on \emph{squared deviations} has a number of useful properties in \emph{inferential statistics} and \emph{statistical modeling}.\footnote{I will very briefly mention the one that I think is coolest, for a very particular definition of ``cool'', that is. Variances are \emph{additive}. Here's what that means: suppose I have two variables \(X\) and \(Y\), whose variances are \(\mbox{Var}(X)\) and \(\mbox{Var}(Y)\) respectively. Now imagine I want to define a new variable \(Z\) that is the sum of the two, \(Z = X+Y\). As it turns out, the variance of \(Z\) is equal to \(\mbox{Var}(X) + \mbox{Var}(Y)\). This is a \emph{very} useful property, but it's not true of the other measures that I talk about in this section.}
\item
  If we do that, we obtain a measure is called the \textbf{\emph{variance}}, which for a specific set of observations \(X\) is written \(\mbox{s}_X^2\). It is the most wide-spread measure of variability because it is a key concept in \emph{inferential statistics}.
\item
  The formula that we use to calculate the variance of a set of observations is as follows:
  \[
  \mbox{s}_X^2 = \frac{1}{N-1} \sum_{i=1}^N \left( X_i - \bar{X} \right)^2
  \]
\item
  As you can see, it's basically the same formula that we used to calculate the mean absolute deviation, except that:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Instead of using ``absolute deviations'' we use ``squared deviations''.
  \item
    Instead of dividing by \(N\) (which gives us the average deviation), we divide by \(N-1\) (which gives us \emph{`sort-of-the-average'}). {[}We will talk about this in a little while.{]}
  \end{enumerate}
\end{itemize}

\begin{itemize}
\tightlist
\item
  Now that we've got the basic idea, let's have a look at a concrete example. Once again, let's use the first five sleep durations. If we follow the same approach that we took last time, we end up with the following table:
\end{itemize}

\begin{table}

\caption{\label{tab:unnamed-chunk-188}Regular, abssolute, and squared deviations}
\centering
\begin{tabular}[t]{lllll}
\toprule
Notation [English] & \$i\$ [animal] & \$X\_i\$ [value] & \$X\_i - \textbackslash{}bar\{X\}\$ [deviation from mean] & \$(X\_i - \textbackslash{}bar\{X\})\textasciicircum{}2\$ [squared deviation]\\
\midrule
 & 1 & 12 & -0.4 & 0.16\\
 & 2 & 17 & 4.6 & 21.16\\
 & 3 & 14 & 1.6 & 2.56\\
 & 4 & 15 & 2.6 & 6.76\\
 & 5 & 4 & -8.4 & 70.56\\
\bottomrule
\end{tabular}
\end{table}

\begin{itemize}
\tightlist
\item
  That last column contains all of our squared deviations, so all we have to do is average them. If we do that by typing all the numbers into R by hand\ldots{}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{( }\FloatTok{0.16+21.16+2.56+6.76+70.56}\NormalTok{ ) }\SpecialCharTok{/}\NormalTok{ (}\DecValTok{5{-}1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 25.3}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  We end up with a variance of 25.3. Exciting, isn't it? For the moment, let's ignore the burning question that you're all probably thinking (i.e., what the heck does a variance of 25.3 actually mean?) and instead talk a bit more about how to do the calculations in R.
\item
  As always, we want to avoid having to type in a whole lot of numbers ourselves. And as it happens, we have the vector \texttt{X} lying around, which we created in the previous section. With this in mind, we can calculate the variance of \texttt{X} by using the following command,
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OtherTok{\textless{}{-}}\NormalTok{ mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]}
\NormalTok{(X }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(X) )}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{/}\NormalTok{ (}\FunctionTok{length}\NormalTok{(X) }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1]  0.04  5.29  0.64  1.69 17.64}
\end{Highlighting}
\end{Shaded}

and as usual we get the same answer as the one that we got when we did everything by hand. However, I \emph{still} think that this is too much typing. Fortunately, R has a built in function called \texttt{var()} which does calculate variances. So we could also do this\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{var}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 25.3}
\end{Highlighting}
\end{Shaded}

and you get the same answer. Great.

\subsection{Standard deviation}\label{sd}

\begin{itemize}
\item
  One problem with the variance is that it is expressed in odd units. In the case above it's \(h^2\) (\emph{hours squared}). I know what \(m^2\) is, but what are \(h^2\)? No idea.
\item
  Suppose that you'd like to have a measure that is expressed in the same units as the data itself (i.e., points, not points-squared). What should you do?
\item
  The solution to the problem is obvious: take the square root of the variance, known as the \textbf{\emph{standard deviation}}, also called the ``root mean squared deviation'', or RMSD. This solves out problem fairly neatly.
\item
  While nobody has a clue what \emph{``a variance of 19.95 hours-squared''} really means, it's much easier to understand \emph{``a standard deviation of 4.5 hours''}, since it's expressed in the original units.
\item
  It is traditional to refer to the standard deviation of a sample of data as \(s_x\), though ``sd'' and ``std dev.'' are also used at times. Because the standard deviation is equal to the square root of the variance, you probably won't be surprised to see that the formula is:
  \[
  s_x = \sqrt{ \frac{1}{N-1} \sum_{i=1}^N \left( X_i - \bar{X} \right)^2 }
  \]
\item
  Interpreting standard deviations is slightly more complex. Because the standard deviation is derived from the variance, and the variance is a quantity that has little to no meaning that makes sense to us humans, the standard deviation doesn't have a simple interpretation.
\item
  As a consequence, most of us just rely on a \textbf{simple rule of thumb}: \textbf{``in general, you should expect 68\% of the data to fall within 1 standard deviation of the mean, 95\% of the data to fall within 2 standard deviation of the mean, and 99.7\% of the data to fall within 3 standard deviations of the mean''}. This rule tends to work pretty well most of the time, but it's not exact: it's actually calculated based on an \emph{assumption} that the histogram is symmetric and ``bell shaped''. (Strictly, the assumption is that the data are \emph{normally} distributed, which is an important concept that we'll discuss more later).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{  p }\OtherTok{\textless{}{-}}\NormalTok{ mammalian\_sleep }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(sleep\_total\_h)) }\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{"black"}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{"lightgrey"}\NormalTok{)}

\NormalTok{  sleep\_sd }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)}
\NormalTok{  sleep\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h)}
\NormalTok{  bars }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(sleep\_mean}\SpecialCharTok{{-}}\NormalTok{sleep\_sd, sleep\_mean, sleep\_mean}\SpecialCharTok{+}\NormalTok{sleep\_sd)}
\NormalTok{  bar\_labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"mean{-}1*sd"}\NormalTok{, }\StringTok{"mean"}\NormalTok{, }\StringTok{"mean+1*sd"}\NormalTok{)}
\NormalTok{  p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ bars, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{bars[}\DecValTok{1}\NormalTok{], }\AttributeTok{y=} \DecValTok{10}\NormalTok{, }\AttributeTok{label =}\NormalTok{ bar\_labels[}\DecValTok{1}\NormalTok{])) }\SpecialCharTok{+}
      \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{bars[}\DecValTok{2}\NormalTok{], }\AttributeTok{y=} \DecValTok{10}\NormalTok{, }\AttributeTok{label =}\NormalTok{ bar\_labels[}\DecValTok{2}\NormalTok{])) }\SpecialCharTok{+}
      \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{bars[}\DecValTok{3}\NormalTok{], }\AttributeTok{y=} \DecValTok{10}\NormalTok{, }\AttributeTok{label =}\NormalTok{ bar\_labels[}\DecValTok{3}\NormalTok{]))}
\NormalTok{  p}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{main_files/figure-latex/aflsd-1.pdf}
\caption{\label{fig:aflsd}An illustration of the standard deviation.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{with}\NormalTok{(mammalian\_sleep, }\FunctionTok{mean}\NormalTok{(sleep\_total\_h}\SpecialCharTok{\textgreater{}}\NormalTok{(sleep\_mean}\SpecialCharTok{{-}}\NormalTok{sleep\_sd) }\SpecialCharTok{\&}\NormalTok{ sleep\_total\_h}\SpecialCharTok{\textless{}}\NormalTok{(sleep\_mean}\SpecialCharTok{+}\NormalTok{sleep\_sd) ))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.6385542}
\end{Highlighting}
\end{Shaded}

\subsubsection{\texorpdfstring{Bessel's correction: What's up with all those \(N-1\)s in the denominator?}{Bessel's correction: What's up with all those N-1s in the denominator?}}\label{bessels-correction-whats-up-with-all-those-n-1s-in-the-denominator}

\begin{itemize}
\item
  Now, what's going on with that \(N-1\), and why do I still call the sample variance a \emph{`sort-of-the-average'} of the squared deviations? Let's address these questions in turn.
\item
  The important thing to note about variance and standard deviation is they serve \emph{two} purposes: They are used to (i) describe a \textbf{sample}, but also to (ii) tentatively characterize the larger population from which the sample is.
\item
  You are \emph{usually} not really interested in the variance of a particular set of numbers, but rather in what they represent. So function number (ii) is the far more dominant use.
\item
  In our case, when I want to quantify the variability of the sleep durations dataset, it is not these 83 specific mammals I am interested in -- I want to get a sense of the variability among mammals in general. That is, I want to know -- how much do mammals vary \emph{in general}. These just happen to be a \textbf{\emph{sample}} (83 mammals) from the \textbf{\emph{population}} (all mammals).
\item
  What I actually want to compute are not the (squared) deviations from the \textbf{sample mean} (\(\bar{X}\); the average sleep duration of \textbf{these} mammals), but from the actual \textbf{population mean} (\(\mu\); the average sleep duration of \textbf{all} mammals). That is, I don't want \(( X_i - \bar{X})^2\), I want \(( X_i - \mu)^2\).
\item
  But I don't know \(\mu\), and the \emph{best guess} I have about it is \(\bar{X}\). And this has consequences: \(( X_i - \bar{X})^2\) underestimates the distance between \(X_i\) and \(\mu\) because we use the same data points (\(X_i\)) to compute the mean (\(\bar{X}\)) and then determine the distance to them.
\end{itemize}

\begin{itemize}
\item
  The problem becomes smaller as \(N\) increases, because it becomes less and less likely that all \(N\) points are squarely on one side of the mean.
\item
  Dividing by \(N-1\) \emph{`corrects'} this underestimation problem:

  \begin{itemize}
  \tightlist
  \item
    Dividing by a smaller number makes the estimate of the variance bigger.
  \item
    As \(N\) increases the difference between dividing by \(N\) and \(N-1\) becomes less and less important, and ultimately negligible.
  \end{itemize}
\end{itemize}

\paragraph{Summary}\label{summary-1}

\begin{itemize}
\tightlist
\item
  To recap, these are the two estimators of the variance, but the second one requires knowledge of the true population mean \(\mu\), which we don't know.
\item
  Therefore, we use the first one (\(s_X^2\)), and divide by \(N-1\) to avoid underestimating the `true variance'.
\end{itemize}

\[
\mbox{s}_X^2 = \frac{1}{N-1} \sum_{i=1}^N \left( X_i - \bar{X} \right)^2
\]

\[
\mbox{Var}_X = \frac{1}{N} \sum_{i=1}^N \left( X_i - \mu \right)^2
\]

\subsection{Which measure to use?}\label{which-measure-to-use}

We've discussed quite a few measures of spread (range, IQR, variance and standard deviation). Below is a quick summary.
In short, the IQR and the standard deviation are easily the two most common measures used to report the variability of the data.

\begin{itemize}
\tightlist
\item
  \emph{Range}. Gives you the full spread of the data. It's very vulnerable to outliers, and as a consequence it isn't often used unless you have good reasons to care about the extremes in the data.
\item
  \emph{Interquartile range}. Tells you where the ``middle half'' of the data sits. It's pretty robust, and complements the median nicely. This is used a lot.
\item
  \emph{Variance}. Tells you the average squared deviation from the mean. It's mathematically elegant, and is probably the ``right'' way to describe variation around the mean, but it's completely uninterpretable because it doesn't use the same units as the data. Almost never used except as a mathematical tool; but it's buried ``under the hood'' of a very large number of statistical tools.
\item
  \emph{Standard deviation}. This is the square root of the variance. It's fairly elegant mathematically, and it's expressed in the same units as the data so it can be interpreted pretty well. In situations where the mean is the measure of central tendency, this is the default. This is by far the most popular measure of variation.
\end{itemize}

\section{Getting an overall summary of a variable}\label{summary}

\begin{itemize}
\tightlist
\item
  It's kind of annoying to have to separately calculate means, medians, standard deviations, etc. Wouldn't it be nice if R had some helpful functions that would do all these tedious calculations at once? Something like \texttt{summary()}, perhaps?
\item
  The basic idea behind the \texttt{summary()} function is that it prints out some useful information about whatever object it receives (e.g., a vector or data frame).
\item
  Let's take a look at some examples:
\end{itemize}

\subsection{Summarising a vector}\label{summarising-a-vector}

\subsubsection{Numerical vectors}\label{numerical-vectors}

\begin{itemize}
\tightlist
\item
  For numeric variables, we get a whole bunch of useful descriptive statistics. It gives us the minimum and maximum values (and thus the range), the first and third quartiles (25th and 75th percentiles; and thus the IQR), the mean and the median.
\item
  In sum, it gives us a pretty good collection of descriptive statistics related to the central tendency and the spread of the data.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. }
\NormalTok{\#\#    2.00    8.00   10.00   10.41   14.00   20.00}
\end{Highlighting}
\end{Shaded}

\subsubsection{Logical vectors}\label{logical-vectors}

\begin{itemize}
\tightlist
\item
  Returns the number of \texttt{TRUE} and \texttt{FALSE} values.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{sleep\_total\_h }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#    Mode   FALSE    TRUE }
\NormalTok{\#\# logical      45      38}
\end{Highlighting}
\end{Shaded}

\subsubsection{Factors vectors}\label{factors-vectors}

\begin{itemize}
\tightlist
\item
  Returns the number of observations for each factor level.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{( }\FunctionTok{as.factor}\NormalTok{(mammalian\_sleep}\SpecialCharTok{$}\NormalTok{name[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]) )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#                    Cheetah                        Cow }
\NormalTok{\#\#                          1                          1 }
\NormalTok{\#\#                        Dog Greater short{-}tailed shrew }
\NormalTok{\#\#                          1                          1 }
\NormalTok{\#\#            Mountain beaver          Northern fur seal }
\NormalTok{\#\#                          1                          1 }
\NormalTok{\#\#                 Owl monkey                   Roe deer }
\NormalTok{\#\#                          1                          1 }
\NormalTok{\#\#           Three{-}toed sloth               Vesper mouse }
\NormalTok{\#\#                          1                          1}
\end{Highlighting}
\end{Shaded}

\subsubsection{Character vectors}\label{character-vectors}

\begin{itemize}
\tightlist
\item
  Returns almost no useful information except for length.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{( mammalian\_sleep}\SpecialCharTok{$}\NormalTok{name )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#    Length     Class      Mode }
\NormalTok{\#\#        83 character character}
\end{Highlighting}
\end{Shaded}

\subsection{Summarising a data frame}\label{summarising-a-data-frame}

\begin{itemize}
\tightlist
\item
  \texttt{summary()} can also be called on a data frame, in which case it returns summaries of all variables.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{( mammalian\_sleep )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#      name           sleep\_total\_h     bodywt\_kg       }
\NormalTok{\#\#  Length:83          Min.   : 2.00   Min.   :   0.005  }
\NormalTok{\#\#  Class :character   1st Qu.: 8.00   1st Qu.:   0.174  }
\NormalTok{\#\#  Mode  :character   Median :10.00   Median :   1.670  }
\NormalTok{\#\#                     Mean   :10.41   Mean   : 166.136  }
\NormalTok{\#\#                     3rd Qu.:14.00   3rd Qu.:  41.750  }
\NormalTok{\#\#                     Max.   :20.00   Max.   :6654.000}
\end{Highlighting}
\end{Shaded}

\section{Correlations}\label{correlations}

The descriptive statistics we discussed so far were all about a single variable. Sometimes, we want to describe the relation between two variables. For this we need to calculate \textbf{correlations}. Correlations range between -1 and 1. 0 means no no correlation, 1 means strong positive correlation and -1 means strong negative correlation. Correlation is indicated by the letter \texttt{r}.

\begin{figure}
\centering
\includegraphics{./img/corr-1.png}
\caption{\label{fig:correlations}Different correlations.}
\end{figure}

In R, we can calculate the correlations of two variables using the \texttt{cor()} function. Consider the following example.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{20}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ (x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y=}\NormalTok{y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-199-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(x,y)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.9713482}
\end{Highlighting}
\end{Shaded}

\chapter{Linear Regression with one Predictor}\label{linear-regression-with-one-predictor}

In the previous section, we looked at some descriptive statistics about data. In all of these cases, we looked at the descriptive statistics of a \textbf{single variable}. For example, we looked at the mean and standard deviation of total sleep hours for various animals. The variable we considered was \texttt{total\_sleep\_hours}. This is also called \textbf{univariate statistics} because we were interested in the statistics of a \textbf{single variable}.

Now, we are moving onto \textbf{bivariate statistics}. In other words, we will analyze the relationship between two variables. Instead of calculating the \textbf{mean} of a single variable, we will calculate the \textbf{conditional mean} of a variable based on some other variable. For example, we could try calculating the relationship between \texttt{total\_sleep\_hours} and \texttt{bodyweight}.

\section{Word Frequency Effects}\label{word-frequency-effects}

Instead of looking at animal sleep hours, this time let's look at something more relevant for linguistics. Earlier, we discussed the role of frequency in processing.

\begin{itemize}
\tightlist
\item
  Our hypothesis was that more frequent words will be processed more easily.
\item
  We operationalized this hypothesis by picking

  \begin{itemize}
  \tightlist
  \item
    \textbf{word frequency} as our \textbf{independent variable} (also called a \textbf{predictor})
  \item
    \textbf{reaction time} as our \textbf{dependent variable} (also called \textbf{response} or \textbf{outcome variable})
  \end{itemize}
\end{itemize}

The typical dataset we will be working with has a structure similar to the one below:

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2692}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2308}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2692}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2308}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
dependent var.(\(Y\))
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
predictor 1(\(X_1\))
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
predictor 2(\(X_2\))
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
other predictors (\(X_3\)\ldots{}\(X_n\))
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
705 & 1.2 & 2.2 & (\ldots) \\
209 & 8.3 & -4.0 & (\ldots) \\
334 & 7.2 & -1.4 & (\ldots) \\
\ldots{} & \ldots{} & \ldots{} & (\ldots) \\
\end{longtable}

\begin{itemize}
\tightlist
\item
  What the variables represent will depend on the problem you're studying and the question you're asking

  \begin{itemize}
  \tightlist
  \item
    dependent variable (e.g., reaction time)
  \item
    predictor 1 (e.g., frequency)
  \item
    predictor 2 (e.g., familiarity)
  \end{itemize}
\end{itemize}

Let us take a look at a linear regression model where \texttt{x\ =\ frequency} and \texttt{y=response\ time}.

\begin{figure}
\centering
\includegraphics{./img/lr/lr1.png}
\caption{\label{fig:linearregression1}Response duration as a function of word frequency. The frequencies are not raw frequencies. Instead, log frequencies are used. We'll talk more about this.}
\end{figure}

\begin{itemize}
\tightlist
\item
  Each point on the plot above indicates the average response time of multiple participants.
\item
  The somewhat diagonal line is called the \textbf{regression line}.
\end{itemize}

\section{Simple Linear Regression}\label{simple-linear-regression}

In simple regression, our goal is to find the \textbf{regression line} as IT IS our model. The line extends to infinity and makes predictions about every point on its path. For example, our \textbf{model} can make a prediction about the reaction time if I were to find a word that has the log frequency 7. It would tell me that the reaction time would be a little below 400 miliseconds.

An important point regarding simple linear regression is that it can be used for data where the dependent variable is \textbf{continuous} (e.g.~436 miliseconds) but not \textbf{categorial} (e.g.~grammatical/ungrammatical).

\section{Finding the Regression Line}\label{finding-the-regression-line}

In simple linear regression, the value for a \textbf{dependent variable} is a \textbf{linear function of} the \textbf{predictor variable}. A linear function looks like the following.

\[y = a + b * x\]

Let us try to understand these values a bit.

\[ \underbrace{Y}_{\text{dependent variable}} =
            \overbrace{\underbrace{a}_{\text{intercept}}}^{\text{additive term}} + 
            \overbrace{\underbrace{b}_{\text{slope}} * \underbrace{X}_{\text{predictor}}}^{\text{additive term}} \]

Mathematically, a line is defined in terms of an \textbf{intercept} and \textbf{slope}.

\begin{itemize}
\tightlist
\item
  \textbf{Slope} can be defined as the amount of change in \texttt{y} as \texttt{x} changes one unit.
  \[ slope = \frac{\Delta y}{\Delta x}  \]
\item
  A rising slope will have a positive value whereas a descending slope will have a negative value.
\item
  For example, the slope in the Response Duration Model above is -70. This means that for each unit of increase in frequency, we observe a 70ms decrease in reaction time.
\end{itemize}

A slope is not enough to define a line on a plot. There can be an infinite number of lines that have the same slope. We also need the \textbf{intercept}. Intercept determines the value predicted for y when x is 0. Consider the following graphs.

\begin{figure}
\centering
\includegraphics{./img/lr/lr2.png}
\caption{\label{fig:interceptslope}Lines with different intercept and slope values.}
\end{figure}

The intercept for the data Response Duration Model above is 880ms. So, our Response Duration Model is:

\[response\ duration = 880ms + (-70 \frac{ms}{freq}) * word\ frequecny   \]

A good way to remember the intercept and the slope and a linear model is to remember the \textbf{taxi fares}. The taxi fares will usually start with a constant fee (a minimum fee). This is your intercept. It's the 0th kilometers and it already costs you 30 TLs. Then the cost for each kilometer is your slope. At the time of writing these notes, it is 20TLs.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}

\NormalTok{distance }\OtherTok{=} \DecValTok{1}\SpecialCharTok{:}\DecValTok{20}
\NormalTok{cost }\OtherTok{=} \DecValTok{30}\SpecialCharTok{+}\NormalTok{(}\DecValTok{20}\SpecialCharTok{*}\NormalTok{distance)}

\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(distance,cost)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\AttributeTok{by =}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{500}\NormalTok{, }\AttributeTok{by =} \DecValTok{20}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{, }\AttributeTok{formula =}\NormalTok{y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x }\SpecialCharTok{+} \FunctionTok{I}\NormalTok{(}\DecValTok{30}\SpecialCharTok{+}\DecValTok{20}\SpecialCharTok{*}\NormalTok{x))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-200-1.pdf}

\textbf{Slope} and \textbf{intercept} are the \textbf{coefficients} of our linear regression model. Our task is to find the \textbf{coefficients} from the data.

\section{Estimating the Coefficients}\label{estimating-the-coefficients}

A Linear Regression analysis of a particular data is essentially all about \textbf{estimating coefficients} and \textbf{interpreting the results}. In the \textbf{taxi model}, we already knew the coefficients. So, we had a model about the world and we can use the model to make predictions about taxi costs. In the Response Duration Model, the coefficients were learnt from the data but I gave them to you directly. So, how are we going to estimate the coefficients when what we have is just data but nothing else?

Let's not get into the weeds of how to find the right linear regression model. Instead, let's just use R to estimate the coefficients. This is called \textbf{fitting a model}. So, let's fit a linear model on the taxi model and interpret its results. We'll start with the taxi model simply because we already know the coefficients. We'll let R estimate some coefficients for us and then compare them with the coefficients we used to generate the \texttt{cost} data above from the \texttt{distance} variables and our coefficients.

The simplest way to fit a linear model on some data is the \texttt{lm()} function. \texttt{lm()} takes two variables \texttt{x} (predictor) and \texttt{y} (dependent variable) and fits a model by modeling \texttt{y} as a linear function of \texttt{x}. The tilde \texttt{\textasciitilde{}} means: element on the left as a function of element on the right.

For our taxi model, we will model cost as a function of duration. The following lines of code does that.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# fit a linear regression model of cost as a function of distance}
\NormalTok{taxi\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(cost }\SpecialCharTok{\textasciitilde{}}\NormalTok{ distance)}

\CommentTok{\# print the model coefficients}
\NormalTok{taxi\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = cost \textasciitilde{} distance)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\# (Intercept)     distance  }
\NormalTok{\#\#          30           20}
\end{Highlighting}
\end{Shaded}

\textbf{Unbelievable!} The model estimated the intercept (start cost) as 30 and the slope (cost per km) as 20. Simple as that. Notice that the model estimated these coefficients simply from the data but nothing else.

The model object that we stored in the variable \texttt{taxi\_model} has a lot more information. Let us take a look at the results of our model. To do this, we'll take use the \texttt{glance()} function from the \texttt{broom} package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(broom)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{glance}\NormalTok{(taxi\_model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in summary.lm(x): essentially perfect fit: summary may be unreliable

## Warning in summary.lm(x): essentially perfect fit: summary may be unreliable
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 1 x 12}
\NormalTok{\#\#   r.squared adj.r.squared    sigma statistic   p.value    df logLik    AIC}
\NormalTok{\#\#       \textless{}dbl\textgreater{}         \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1         1             1 2.10e{-}14   6.00e32 3.63e{-}285     1   603. {-}1199.}
\NormalTok{\#\# \# i 4 more variables: BIC \textless{}dbl\textgreater{}, deviance \textless{}dbl\textgreater{}, df.residual \textless{}int\textgreater{}, nobs \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

There are a lot of details. For now, we'll focus on only two values \textbf{R2} and the \textbf{p value}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results }\OtherTok{\textless{}{-}} \FunctionTok{glance}\NormalTok{(taxi\_model) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(r.squared, p.value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in summary.lm(x): essentially perfect fit: summary may be unreliable

## Warning in summary.lm(x): essentially perfect fit: summary may be unreliable
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 1 x 2}
\NormalTok{\#\#   r.squared   p.value}
\NormalTok{\#\#       \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1         1 3.63e{-}285}
\end{Highlighting}
\end{Shaded}

Without going into any detail yet, I can tell you that we got an excellent model. Our \textbf{R2} is 1, which is perfect and our p value is very small \texttt{3.63e-285} (This means that there are 284 zeroes after 0. and before 363 So, a very small number). When the p value is so small, we can conclude that the relation between distance and cost is \textbf{statistically significant} (i.e.~not random).

\section{Data is messy}\label{data-is-messy}

In the taxi model above, we worked with a very simplistic and ideal dataset. We know that in theory that is what a tax fare should look like. However, İstanbul is a crowded city and there are lots of traffic jams and traffic is quite unpredictable as there are so many random variables. Since the taxi charges you not only for the distance but also the duration you wait at the lights, there is always going to be some random addition to the fare. Let us incorporate that randomness to our taxi cost data and rerun our model to see what it looks like.

All we are going to do is to add some random values to our taxi prices. Let's generate some random numbers and bind it to a new cost variable.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{42}\NormalTok{)}
\NormalTok{hidden\_cost }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\AttributeTok{mean=}\DecValTok{15}\NormalTok{, }\AttributeTok{sd=}\DecValTok{5}\NormalTok{)}
\NormalTok{total\_cost }\OtherTok{\textless{}{-}}\NormalTok{ cost }\SpecialCharTok{+}\NormalTok{ hidden\_cost}
\end{Highlighting}
\end{Shaded}

Let us plot the theoretical costs and the total costs side by side. We'll use the \texttt{gridExtra} package to plot two plots side by side.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gridExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(distance,cost)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\AttributeTok{by =}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{500}\NormalTok{, }\AttributeTok{by =} \DecValTok{20}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Taxi cost without traffic"}\NormalTok{)}

\NormalTok{plot2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(distance,total\_cost)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{20}\NormalTok{, }\AttributeTok{by =}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{500}\NormalTok{, }\AttributeTok{by =} \DecValTok{20}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Taxi cost with traffic"}\NormalTok{)}

\FunctionTok{grid.arrange}\NormalTok{(plot1, plot2, }\AttributeTok{ncol=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-205-1.pdf}

OK, now it looks like we have some more realistic data. Let us rerun our linear model to see what the coefficients look like.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{better\_taxi\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(total\_cost}\SpecialCharTok{\textasciitilde{}}\NormalTok{distance)}

\NormalTok{better\_taxi\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = total\_cost \textasciitilde{} distance)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\# (Intercept)     distance  }
\NormalTok{\#\#       50.09        19.61}
\end{Highlighting}
\end{Shaded}

Notice that we got a new intercept and slope. It's kinda weird. We know that the taxi start fare is 30TL. However, our intercept is a lot higher (this will differ as each time you run your code as the traffic cost we calculated is random unless you set some seed number to generate the random values). This is quite off given our original intercept.

Notice that the slope is a little off too. It's not exactly 20 but it's not way off like the intercept. So, did our linear model do well? Before answering this question more formally, I'll draw your attention to one point. Our model predicts that your initial taxi fare will be a little higher at the beginning and it will sort of even out as your distance increases. Even though our model doesn't guess the intercept correctly, it still does a very decent job in modeling the real life taxi costs (or a simulation of it). Just add up the intercept and slope and that should give you around the minimum cost you'll pay for a taxi ride.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(better\_taxi\_model)[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{coef}\NormalTok{(better\_taxi\_model)[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# (Intercept) }
\NormalTok{\#\#    69.69523}
\end{Highlighting}
\end{Shaded}

At this point, I want to remind you that taxi rides in İstanbul have a minimum of 100 TLs for short distance trips (2km or less). So, our model does pretty good for a real life scenario.

\section{Simplified Frequency Data}\label{simplified-frequency-data}

Let us use a simple frequency data. Go ahead and download the \texttt{log10ELP\_frequency.csv} file from Moodle. This is the same data in Bodo Winter's ELP\_frequency.csv file with an added column for log10 normalization. We will plot the data using a scatterplot with geom\_point and also draw a regression line.

We will use log normal values as the x axis and the reaction time as the y axis.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggrepel)}


\NormalTok{freq\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"/Users/umit/ling\_411/data/log10ELP\_frequency.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 12 Columns: 4
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (1): Word
## dbl (3): RT, Freq, log10freq
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(freq\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{log10freq, }\AttributeTok{y=}\NormalTok{RT)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Word)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-208-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(freq\_data}\SpecialCharTok{$}\NormalTok{RT }\SpecialCharTok{\textasciitilde{}}\NormalTok{ freq\_data}\SpecialCharTok{$}\NormalTok{log10freq)}
\end{Highlighting}
\end{Shaded}

OK, let us also get a glace at our model. We'll first take a look at the slope and the intercept and then \textbf{R2} and the \textbf{p value}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(freq\_model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#         (Intercept) freq\_data$log10freq }
\NormalTok{\#\#           870.90539           {-}70.27646}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glance}\NormalTok{(freq\_model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 1 x 12}
\NormalTok{\#\#   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC}
\NormalTok{\#\#       \textless{}dbl\textgreater{}         \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1     0.737         0.711  63.3      28.1 0.000348     1  {-}65.7  137.  139.}
\NormalTok{\#\# \# i 3 more variables: deviance \textless{}dbl\textgreater{}, df.residual \textless{}int\textgreater{}, nobs \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

\section{Residuals}\label{residuals}

So far, we built and plotted linear models by estimating the intercept and slope of a line that seems to best describe our data. In the simple taxi model, we were in a perfect position. Our model had a \textbf{perfect fit} on our data. However, once we introduced some \textbf{random noise} (e.g.~random traffic jams) into our data, our linear model still did a decent job but it was not a perfect fit.

Next, we tried modeling the simple frequency data and we got a decent model that describes the trend in our data but the fit is not perfect. Can we find a way to quantify how good our model fits our data (``goodness of fit''). That's what we will do here. Let us reconsider the frequency data plot. This time, we'll draw lines from the data points to the regression line. The distance for each data point is called a \textbf{residual}. It describes the amount by which our model missed the actual value.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(freq\_data}\SpecialCharTok{$}\NormalTok{RT }\SpecialCharTok{\textasciitilde{}}\NormalTok{ freq\_data}\SpecialCharTok{$}\NormalTok{log10freq)}
\FunctionTok{ggplot}\NormalTok{(freq\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{log10freq, }\AttributeTok{y=}\NormalTok{RT)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Word)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{se=}\NormalTok{F)}\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ log10freq, }\AttributeTok{y =}\NormalTok{ RT,}
                   \AttributeTok{xend =}\NormalTok{ log10freq, }\AttributeTok{yend =} \FunctionTok{fitted}\NormalTok{(freq\_model)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-211-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(freq\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{log10freq, }\AttributeTok{y=}\NormalTok{RT)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Word)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept =} \DecValTok{680}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ log10freq, }\AttributeTok{y =}\NormalTok{ RT,}
                   \AttributeTok{xend =}\NormalTok{ log10freq, }\AttributeTok{yend =} \DecValTok{680}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-212-1.pdf}

Now, we have two models:

\begin{itemize}
\tightlist
\item
  A model where there is a relation between frequency and reaction time
\item
  A null model where there is no relation between frequency and reaction time (reaction time is independent of frequency)
\end{itemize}

\subsection{Sum of Squared Errors}\label{sum-of-squared-errors}

One way to describe the errors of the model is to sum the squares of each error value. This is called the Sum of Squared Errors.

To do this, we need to get the residuals of the model, square them and then sum them. Let us do this for the linear model.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SSE\_freq\_model }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((}\FunctionTok{residuals}\NormalTok{(freq\_model))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{SSE\_freq\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 40114.97}
\end{Highlighting}
\end{Shaded}

Let us also calculate it for the null model. The intercept for the null model was 680 I found this value by taking the average reaction time. This will be my null model. The mean was 679.9167. So, we'll deduce the the mean from the actual values to find the residuals. The rest is just the same.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{null\_model\_residuals }\OtherTok{\textless{}{-}}\NormalTok{ freq\_data}\SpecialCharTok{$}\NormalTok{RT }\SpecialCharTok{{-}} \DecValTok{680}
\NormalTok{SSE\_null\_model }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(null\_model\_residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{SSE\_null\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 152743.3}
\end{Highlighting}
\end{Shaded}

These numbers are very similar to what Bodo Winter reports in his chapter. He might not have done the rounding I did. We use the null model to calculate a \textbf{standardized measure of fit}. One measure is \textbf{R2} and it is calculated as follows.

\[R^2 = 1 - \frac{SSE_{model}}{SSE_{null}} \]
Let's calculate \textbf{R2}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r\_squared }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (SSE\_freq\_model}\SpecialCharTok{/}\NormalTok{SSE\_null\_model)}

\NormalTok{r\_squared}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.73737}
\end{Highlighting}
\end{Shaded}

\textbf{Excellent!} We've calculated \textbf{R2} and it is the same as what we found earlier when we took at a look at the model report using the \texttt{glance()} function.

So, what is this \textbf{R2}? When we interpret \textbf{R2}, we say ``n'' amount of the variance in the dependent variable (RT) can be accounted for by incorporating the independent variable (word frequency). In this case, 73\% of the variance is due to word frequency. The remaining 27\% is due to chance or some other factors we didn't consider.

\chapter{Linear Regression with Many Predictors}\label{linear-regression-with-many-predictors}

In the previous section, we built linear models with \textbf{one predictor}. In other words, we had only one dependent variable and one independent variable.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
\textbf{Model} & \textbf{Dependent Variable} & \textbf{Predictor} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Taxi & Cost & Travel Distance \\
Processing & Reaction Time & Word Frequency \\
\end{longtable}

In many real life scenarios, multiple factors will be involved in the outcome of a particular experiments. In other words, a particular dependent variable will be the outcome of more than one independent variable (predictors).

Let us consider our taxi example again. While our taxi model is primarily based on the distance we travel, sometimes we need to cross bridges or toll roads. These factors will obviously increase the cost as they get added to our total cost. The following is a simple example. You can download the data from Moodle or by just clicking this \href{'https://github.com/umitatlamaz/ling_411/blob/main/data/taxi_fares_2024.csv'}{data link}.

Let us see if there is any relationship between the number of bridges and the cost when we travel only 10 kilometers.

\includegraphics{main_files/figure-latex/carsPerfect2A-1.pdf}

It looks like there is a decent positive correlation between the fare and the number of bridges crossed. So, we need to find a way to incorporate this into our linear model. The nice thing about linear models is that they allow us to incorporate multiple predictors each with its own slope.

\[ \underbrace{Y}_{\text{dependent variable}} =
            \overbrace{\underbrace{a}_{\text{intercept}}}^{\text{additive term}} + 
            \overbrace{\underbrace{b_1}_{\text{slope}} * \underbrace{X_{1}}_{\text{predictor}}}^{\text{additive term}} + 
            \overbrace{\underbrace{b_2}_{\text{slope}} * \underbrace{X_{2} }_{\text{predictor}}}^{\text{additive term}} +  
            \ldots\]

In R, fitting a linear model with multiple predictors is quite simple. All we have to do is to add the predictors with a \texttt{+} in the \texttt{lm()} function as in \texttt{lm(dependent\ variable\ \textasciitilde{}\ Predictor\ 1\ +\ Predictor\ 2\ +\ ...)}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{taxi\_model\_two\_preds }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(cab\_fares}\SpecialCharTok{$}\NormalTok{taxi\_fare }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cab\_fares}\SpecialCharTok{$}\NormalTok{distance\_km }\SpecialCharTok{+}\NormalTok{ cab\_fares}\SpecialCharTok{$}\NormalTok{n\_bridges)}

\NormalTok{taxi\_model\_two\_preds}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = cab\_fares$taxi\_fare \textasciitilde{} cab\_fares$distance\_km + cab\_fares$n\_bridges)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#           (Intercept)  cab\_fares$distance\_km    cab\_fares$n\_bridges  }
\NormalTok{\#\#                 49.52                  19.99                  33.08}
\end{Highlighting}
\end{Shaded}

The model is doing pretty well. The data coefficients I used to generate the data are as follows:

\begin{itemize}
\tightlist
\item
  intercept = 30
\item
  distance slope = 20
\item
  bridge slope = 33
\end{itemize}

I also added some random noise with the mean=20, sd=15. Let us also glance at the \textbf{R2} and the \textbf{p.values} using the summary function. Alternatively, we could use the \texttt{glance()} function from the \texttt{broom} package. Give it a shot to see if you obsrve any differences.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(taxi\_model\_two\_preds)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = cab\_fares$taxi\_fare \textasciitilde{} cab\_fares$distance\_km + cab\_fares$n\_bridges)}
\NormalTok{\#\# }
\NormalTok{\#\# Residuals:}
\NormalTok{\#\#     Min      1Q  Median      3Q     Max }
\NormalTok{\#\# {-}50.124  {-}9.837   0.271  10.319  53.013 }
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#                       Estimate Std. Error t value Pr(\textgreater{}|t|)    }
\NormalTok{\#\# (Intercept)           49.51540    1.25546   39.44   \textless{}2e{-}16 ***}
\NormalTok{\#\# cab\_fares$distance\_km 19.98762    0.03293  606.90   \textless{}2e{-}16 ***}
\NormalTok{\#\# cab\_fares$n\_bridges   33.08101    0.14820  223.21   \textless{}2e{-}16 ***}
\NormalTok{\#\# {-}{-}{-}}
\NormalTok{\#\# Signif. codes:  0 \textquotesingle{}***\textquotesingle{} 0.001 \textquotesingle{}**\textquotesingle{} 0.01 \textquotesingle{}*\textquotesingle{} 0.05 \textquotesingle{}.\textquotesingle{} 0.1 \textquotesingle{} \textquotesingle{} 1}
\NormalTok{\#\# }
\NormalTok{\#\# Residual standard error: 15.05 on 997 degrees of freedom}
\NormalTok{\#\# Multiple R{-}squared:  0.9976, Adjusted R{-}squared:  0.9976 }
\NormalTok{\#\# F{-}statistic: 2.043e+05 on 2 and 997 DF,  p{-}value: \textless{} 2.2e{-}16}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(broom)}
\FunctionTok{tidy}\NormalTok{(taxi\_model\_two\_preds)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 3 x 5}
\NormalTok{\#\#   term                  estimate std.error statistic   p.value}
\NormalTok{\#\#   \textless{}chr\textgreater{}                    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)               49.5    1.26        39.4 9.67e{-}206}
\NormalTok{\#\# 2 cab\_fares$distance\_km     20.0    0.0329     607.  0        }
\NormalTok{\#\# 3 cab\_fares$n\_bridges       33.1    0.148      223.  0}
\end{Highlighting}
\end{Shaded}

\section{Fitting two Linear Models}\label{fitting-two-linear-models}

In the previous section, we fir a linear model with two variables. The \textbf{R2} we got was quite high. Let us run two models with one variable and see how the \textbf{R2} values change.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{distance\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(cab\_fares}\SpecialCharTok{$}\NormalTok{taxi\_fare }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cab\_fares}\SpecialCharTok{$}\NormalTok{distance\_km)}
\NormalTok{bridge\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(cab\_fares}\SpecialCharTok{$}\NormalTok{taxi\_fare }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cab\_fares}\SpecialCharTok{$}\NormalTok{n\_bridges)}

\NormalTok{distance\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = cab\_fares$taxi\_fare \textasciitilde{} cab\_fares$distance\_km)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#           (Intercept)  cab\_fares$distance\_km  }
\NormalTok{\#\#                226.69                  19.71}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bridge\_model}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = cab\_fares$taxi\_fare \textasciitilde{} cab\_fares$n\_bridges)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#         (Intercept)  cab\_fares$n\_bridges  }
\NormalTok{\#\#              582.14                29.69}
\end{Highlighting}
\end{Shaded}

It looks like the models are still doing pretty well in identifying the slopes. Let us now take a look at their \textbf{R2} values.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glance}\NormalTok{(distance\_model)}\SpecialCharTok{$}\NormalTok{r.squared}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.8759}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glance}\NormalTok{(bridge\_model)}\SpecialCharTok{$}\NormalTok{r.squared}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.09816758}
\end{Highlighting}
\end{Shaded}

The results are very interesting. It looks like the number of bridges explains the cost more than the distance. Let us add the two \textbf{R2} values to see if they add up to the same value as our multiple regression model did.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glance}\NormalTok{(taxi\_model\_two\_preds)}\SpecialCharTok{$}\NormalTok{r.squared}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.9975654}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glance}\NormalTok{(distance\_model)}\SpecialCharTok{$}\NormalTok{r.squared }\SpecialCharTok{+}\FunctionTok{glance}\NormalTok{(bridge\_model)}\SpecialCharTok{$}\NormalTok{r.squared}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.9740676}
\end{Highlighting}
\end{Shaded}

Very close. Not too bad. It looks like when both of the predictors are taken into account, we might be able to explain even more variance but the difference is not huge.

\section{Model Comparison}\label{model-comparison}

AIC lower is better.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{AIC}\NormalTok{(taxi\_model\_two\_preds,distance\_model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#                      df       AIC}
\NormalTok{\#\# taxi\_model\_two\_preds  4  8265.568}
\NormalTok{\#\# distance\_model        3 12194.893}
\end{Highlighting}
\end{Shaded}

\chapter{Linear \& Non-Linear Transformations}\label{linear-non-linear-transformations}

\section{Linear Transformations}\label{linear-transformations}

A \textbf{linear transformation} of a value is addition, subtraction, multiplication, or division with a constant value. Consider the following data:

\begin{itemize}
\tightlist
\item
  {[}2, 4, 6, 8{]}
\end{itemize}

Each of the number on the right is 2 more than the number on the left. Adding 1 to each of the values is a linear transformation of this data.

\begin{itemize}
\tightlist
\item
  {[}3, 5, 7, 9{]}
\end{itemize}

While the numbers themselves change, the relationship among them does not.

Linear transformations are especially useful in describing data at a level of measurement that is useful to you. For example, the following descriptions are equal and they are linear transformations of each other.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
\textbf{Measured Value} & \textbf{Metric 1} & \textbf{Metric 2} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Distance & 700m & 0.7km \\
Time & 2100ms & 2.1s \\
\end{longtable}

The crucial point in linear transformations is that they won't change the relationship among your data point and thus won't impact your models significantly. There are many different types of linear transformations. For our purposes we will focus on two linear transformations \textbf{centering} and \textbf{standardizing}.

\subsection{Centering}\label{centering}

Let us consider one of our previous examples.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(ggrepel)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"/Users/umit/ling\_411/data/log10ELP\_frequency.csv"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(freq\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{log10freq, }\AttributeTok{y=}\NormalTok{RT)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Word)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{se=}\NormalTok{F, }\AttributeTok{fullrange=}\ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\DecValTok{0}\NormalTok{, }\AttributeTok{y=} \DecValTok{870}\NormalTok{, }\AttributeTok{label=}\StringTok{"870"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-225-1.pdf}

Overall, our model does a decent job in showing us that there is a trend in our data. As the frequency of a word increases, reaction time decreases. However, the model also makes some hard to interpret prediction. Our model predicts that when the frequency of a word is 0, RT is expected to be 870. But that's kinda odd. What does it mean for a word to have 0 frequency. If a word has 0 frequency, does it even exist?

At this point, we can step back and ask ourselves a question regarding the \textbf{intercept}. When we defined the intercept, we defined it as the value y takes when x is 0. We mentioned that this was the way to define a line mathematically. But why x=0?

Maybe setting the intercept as the value y takes when x=0 is mathematically meaningful. We can assume that x=0 is the \textbf{center} of the positive and negative integers both of which go to infinity. However, our data are usually finite and their center is usually not 0. We have talked about various measures of \textbf{central tendency} to identify the center of our data (e.g.~mean, median, mode). How about we take the \textbf{mean} as the center of our data. In other words, how about we take the mean to be our x=0 point? This is called \textbf{centering}.

When you \textbf{center} your data, your intercept becomes the value y assumes when x = mean(x). Thus, everything is interpreted relative to the mean. In other words, instead of measuring the distance from the absolute 0, we measure the distance from the mean.

\textbf{To center a predictor variable}, we subtract the mean from each of the predictor variables. Let us center the log frequency data and plot it again.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{centered\_freq\_data }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(freq\_data, }\AttributeTok{centered\_log\_freq =}\NormalTok{ log10freq }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(log10freq))}

\NormalTok{centered\_freq\_data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 12 x 5}
\NormalTok{\#\#    Word        RT  Freq log10freq centered\_log\_freq}
\NormalTok{\#\#    \textless{}chr\textgreater{}    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}             \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 thing     622. 55522     4.74              2.03 }
\NormalTok{\#\#  2 life      520. 40629     4.61              1.89 }
\NormalTok{\#\#  3 door      507. 14895     4.17              1.46 }
\NormalTok{\#\#  4 angel     637.  3992     3.60              0.884}
\NormalTok{\#\#  5 beer      587.  3850     3.59              0.868}
\NormalTok{\#\#  6 disgrace  705    409     2.61             {-}0.106}
\NormalTok{\#\#  7 kitten    611.   241     2.38             {-}0.336}
\NormalTok{\#\#  8 bloke     794.   238     2.38             {-}0.341}
\NormalTok{\#\#  9 mocha     725.    66     1.82             {-}0.898}
\NormalTok{\#\# 10 gnome     810.    32     1.51             {-}1.21 }
\NormalTok{\#\# 11 nihilism  764.     4     0.602            {-}2.12 }
\NormalTok{\#\# 12 puffball  878.     4     0.602            {-}2.12}
\end{Highlighting}
\end{Shaded}

We can see that the centered data has smaller values compared to the log frequencies. We also observe that there are negative values. What does a negative value mean? How can the frequency of a word be negative? In this case, the negative value is relative to the mean. Thus, it means that it is less than the mean (but still above 0).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(centered\_freq\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{centered\_log\_freq, }\AttributeTok{y=}\NormalTok{RT)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Word)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{"lm"}\NormalTok{,}\AttributeTok{se=}\NormalTok{F, }\AttributeTok{fullrange=}\ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_label}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NULL}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\FunctionTok{mean}\NormalTok{(centered\_log\_freq), }\AttributeTok{y=} \DecValTok{675}\NormalTok{, }\AttributeTok{label=}\StringTok{"680"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-227-1.pdf}

Let us take a look at the intercept and slope values of the two models as well as their \textbf{R2} values to see if centering has any effect on the model and its interpretation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 2}
\NormalTok{\#\#   names                   x}
\NormalTok{\#\#   \textless{}chr\textgreater{}               \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)         871. }
\NormalTok{\#\# 2 freq\_data$log10freq {-}70.3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 2}
\NormalTok{\#\#   names                                    x}
\NormalTok{\#\#   \textless{}chr\textgreater{}                                \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)                          680. }
\NormalTok{\#\# 2 centered\_freq\_data$centered\_log\_freq {-}70.3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.7373698}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.7373698}
\end{Highlighting}
\end{Shaded}

You can see that both the slope and the \textbf{R2} values remain unchanged. This shows that the model is remaining the same in all the crucial aspects except that it's now treating its 0 point as the mean. This is more meaningful for most measurements. In addition, centering helps interpreting the coefficients especially when multiple predictors interact (to be discussed later).

\subsection{Standardizing}\label{standardizing}

The second type of linear transformation that is very common is \textbf{standardizing} a.k.a. \textbf{z-scoring}. Standardizing also helps identifying a \textbf{standard scale} that helps us define a metric in terms of the sample mean and standard deviation. This is a little counter-intuitive but helps a lot especially when we are interpreting models with multiple predictor variables.

Imagine that you have your taxi data set with the fare and distance variables. One very basic question you have to answer is what metric to use to report the distance. Should you use kilometers, miles, yards, meters, etc. Now, further imagine that you're comparing two data sets with different reported distance measures (e.g.~mile vs km). This is actually a relatively simple problem as you can transform miles to kms and vice versa. However, what if you are trying to measure the relative impact of distance and the number of bridges you pass. These are two different variables with two different measurement units. We cannot directly compare kilometers with the number of bridges. They're not on the same scale. Standardizing helps us make such comparisons (sometimes).

To standardize a variable, we divide the centered values by the standard deviation of the (sample) values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{centered\_freq\_data }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(centered\_freq\_data, }\AttributeTok{z\_log\_freq =}\NormalTok{ centered\_log\_freq}\SpecialCharTok{/}\FunctionTok{sd}\NormalTok{(log10freq))}

\NormalTok{centered\_freq\_data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 12 x 6}
\NormalTok{\#\#    Word        RT  Freq log10freq centered\_log\_freq z\_log\_freq}
\NormalTok{\#\#    \textless{}chr\textgreater{}    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}             \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 thing     622. 55522     4.74              2.03      1.41  }
\NormalTok{\#\#  2 life      520. 40629     4.61              1.89      1.31  }
\NormalTok{\#\#  3 door      507. 14895     4.17              1.46      1.01  }
\NormalTok{\#\#  4 angel     637.  3992     3.60              0.884     0.614 }
\NormalTok{\#\#  5 beer      587.  3850     3.59              0.868     0.603 }
\NormalTok{\#\#  6 disgrace  705    409     2.61             {-}0.106    {-}0.0736}
\NormalTok{\#\#  7 kitten    611.   241     2.38             {-}0.336    {-}0.233 }
\NormalTok{\#\#  8 bloke     794.   238     2.38             {-}0.341    {-}0.237 }
\NormalTok{\#\#  9 mocha     725.    66     1.82             {-}0.898    {-}0.624 }
\NormalTok{\#\# 10 gnome     810.    32     1.51             {-}1.21     {-}0.842 }
\NormalTok{\#\# 11 nihilism  764.     4     0.602            {-}2.12     {-}1.47  }
\NormalTok{\#\# 12 puffball  878.     4     0.602            {-}2.12     {-}1.47}
\end{Highlighting}
\end{Shaded}

Let us plot a histogram of z scores to see what they look like.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(centered\_freq\_data, }\FunctionTok{aes}\NormalTok{(z\_log\_freq)) }\SpecialCharTok{+}
    \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.1}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (`geom_bar()`).
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-230-1.pdf}

\section{Scaling and Standardizing in R}\label{scaling-and-standardizing-in-r}

In the previous sections, we calculated the centered values and the standardized values by hand. R has a dedicated function \texttt{scale()} which does both.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\NormalTok{cab\_fares }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}data/cab\_fares.csv\textquotesingle{}}\NormalTok{)}
\NormalTok{cab\_fares}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 1,000 x 3}
\NormalTok{\#\#    distance\_km n\_bridges taxi\_fare}
\NormalTok{\#\#          \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1          20         3     180. }
\NormalTok{\#\#  2          10        10     202. }
\NormalTok{\#\#  3          15         4     158. }
\NormalTok{\#\#  4          19         5     196. }
\NormalTok{\#\#  5          18         1     137. }
\NormalTok{\#\#  6          16         7     201. }
\NormalTok{\#\#  7          14         8     209. }
\NormalTok{\#\#  8          18         8     226. }
\NormalTok{\#\#  9           5         2      79.6}
\NormalTok{\#\# 10           9         2      94.2}
\NormalTok{\#\# \# i 990 more rows}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# only centering}
\NormalTok{cab\_fares }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(cab\_fares, }\AttributeTok{distance\_c =} \FunctionTok{scale}\NormalTok{(distance\_km, }\AttributeTok{scale =} \ConstantTok{FALSE}\NormalTok{))}

\CommentTok{\# centering and standardizing}
\NormalTok{cab\_fares }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(cab\_fares, }\AttributeTok{distance\_c\_z =} \FunctionTok{scale}\NormalTok{(distance\_km))}

\CommentTok{\#printing the dataframe}
\NormalTok{cab\_fares}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 1,000 x 5}
\NormalTok{\#\#    distance\_km n\_bridges taxi\_fare distance\_c[,1] distance\_c\_z[,1]}
\NormalTok{\#\#          \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}          \textless{}dbl\textgreater{}            \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1          20         3     180.            8.39            1.61 }
\NormalTok{\#\#  2          10        10     202.           {-}1.61           {-}0.309}
\NormalTok{\#\#  3          15         4     158.            3.39            0.651}
\NormalTok{\#\#  4          19         5     196.            7.39            1.42 }
\NormalTok{\#\#  5          18         1     137.            6.39            1.23 }
\NormalTok{\#\#  6          16         7     201.            4.39            0.843}
\NormalTok{\#\#  7          14         8     209.            2.39            0.459}
\NormalTok{\#\#  8          18         8     226.            6.39            1.23 }
\NormalTok{\#\#  9           5         2      79.6          {-}6.61           {-}1.27 }
\NormalTok{\#\# 10           9         2      94.2          {-}2.61           {-}0.501}
\NormalTok{\#\# \# i 990 more rows}
\end{Highlighting}
\end{Shaded}

Let us plot a histogram of the raw, centered and the z\_scored data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gridExtra)}
\FunctionTok{ggplot}\NormalTok{(cab\_fares, }\FunctionTok{aes}\NormalTok{(distance\_km)) }\SpecialCharTok{+}
        \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{25}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{10}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{boundary=}\DecValTok{0}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (`geom_bar()`).
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-232-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(cab\_fares, }\FunctionTok{aes}\NormalTok{(distance\_c)) }\SpecialCharTok{+}
        \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{, }\DecValTok{10}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{10}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{boundary=}\DecValTok{0}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (`geom_bar()`).
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-232-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(cab\_fares, }\FunctionTok{aes}\NormalTok{(distance\_c\_z)) }\SpecialCharTok{+}
        \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{10}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth=}\FloatTok{0.1}\NormalTok{,}\AttributeTok{boundary=}\DecValTok{0}\NormalTok{,}
                       \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                       \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-232-3.pdf}

\textbf{Important} A z-score above 3 or below -3 is usually interpreted as an extreme value.

\section{Non-linear Transformations}\label{non-linear-transformations}

\subsection{Logarithms \& Log Transformation}\label{logarithms-log-transformation}

One of the problems we often face in raw data is \textbf{skewness}. Technically, skewness is a measure of asymmetry in the data. In practice, it looks like the bulk of the data is rested on one side of a histogram plot with a long tail on the other side. When the tail of the data extends towards a positive value, data is \textbf{positively skewed}. When the tail extends towards a negative value, we call it \textbf{negatively skewed}.

\begin{figure}
\centering
\includegraphics{./img/skewness.jpg}
\caption{\label{fig:skewness}Skewness. Image by \href{https://www.allaboutcircuits.com/technical-articles/understanding-the-normal-distribution-parametric-tests-skewness-and-kurtosis/}{Robert Keim}}
\end{figure}

Many types of data in linguistics have a positive skew. For example, frequency data is highly skewed. Let us take a look at a frequency data for 50K words from Turkish. (I got this data from some corpus but I don't remember where. Apologies for not being able to provide credit.)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{turkish\_freq }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/tr\_50k\_freq.csv"}\NormalTok{, }\AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"word"}\NormalTok{, }\StringTok{"frequency"}\NormalTok{))}

\NormalTok{turkish\_freq}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 50,000 x 2}
\NormalTok{\#\#    word  frequency}
\NormalTok{\#\#    \textless{}chr\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 bir     6034903}
\NormalTok{\#\#  2 bu      3529532}
\NormalTok{\#\#  3 ne      2550646}
\NormalTok{\#\#  4 ve      2544175}
\NormalTok{\#\#  5 için    1795506}
\NormalTok{\#\#  6 mi      1713472}
\NormalTok{\#\#  7 de      1647867}
\NormalTok{\#\#  8 o       1639226}
\NormalTok{\#\#  9 ben     1597395}
\NormalTok{\#\# 10 çok     1572658}
\NormalTok{\#\# \# i 49,990 more rows}
\end{Highlighting}
\end{Shaded}

Let us now get a histogram to see what the data distribution looks like.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(turkish\_freq, }\FunctionTok{aes}\NormalTok{(frequency)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0100}\NormalTok{, }\DecValTok{10000}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{10}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins=}\DecValTok{150}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                 \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(turkish\_freq}\SpecialCharTok{$}\NormalTok{frequency), }\AttributeTok{linetype=}\StringTok{"dashed"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2288 rows containing non-finite values (`stat_bin()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (`geom_bar()`).
\end{verbatim}

\includegraphics{main_files/figure-latex/unnamed-chunk-234-1.pdf}

It looks like most of the words are quite infrequent and a handful of words are very frequent. In fact, word frequencies are skewed in a very interesting way and they have a special distribution name called \textbf{Zipfian} distribution named after George Kingsley Zipf. But we're not interested in that for now.

The important point to notice is where the mean is in this distribution. The mean is shown with the dashed line and it does not in any way reflect the majority of the data. What is more important is that when the data is skewed, its linear modeling will usually result in \textbf{residuals that are not normal}. If the residuals are not normal, then the model will lose its validity. It is important that you notice what matters is the \textbf{normality of the residuals} not the normality of the data. Non-normal data is still fine for liner models as long as the residuals are normal.

\textbf{So, what are logarithms and how do they help?}

Logarithms are inverses of exponentiation.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
\textbf{Logatihm} & \textbf{Exponentiation} & \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
log10(1) =0 & 100 = 1 & \\
log10(10) =1 & 101 = 10 & \\
log10(100) =2 & 102 = 100 & \\
log10(1000) =3 & 103 = 1000 & \\
log10(10000) =4 & 104 = 10000 & \\
\end{longtable}

Transforming the data into a log space has a very interesting normalizing impact on your data. It shrinks your data in a non-linear fashion by reducing smaller numbers less than the big numbers. Consider the following example.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2500}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Raw Value}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{log10 Value}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Difference}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{\% Shrunk}
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
10 & 1 & 9 & 90\% \\
100 & 2 & 98 & 98\% \\
1000 & 3 & 997 & 99.7\% \\
\end{longtable}

Log transformation keeps some of the relation among data points but removes a decent bit of information as well. When we log transform our data, it becomes \textbf{more normal} and \textbf{less skewed}. It doesn't always become completely normal but it is more normal.

Let us log10 transform the frequency data for Turkish and plot a histogram to see what the data looks like now.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create a new column with the log10 frequency values}
\NormalTok{turkish\_freq }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(turkish\_freq, }\AttributeTok{log10freq =} \FunctionTok{log10}\NormalTok{(frequency))}


\CommentTok{\#plot a histogram of the log10 frequency values}
\FunctionTok{ggplot}\NormalTok{(turkish\_freq, }\FunctionTok{aes}\NormalTok{(log10freq)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{8}\NormalTok{), }\AttributeTok{n.breaks=}\DecValTok{8}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins=}\DecValTok{150}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
                 \AttributeTok{fill =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(turkish\_freq}\SpecialCharTok{$}\NormalTok{log10freq), }\AttributeTok{linetype=}\StringTok{"dashed"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-235-1.pdf}

Notice that the data is still skewed but it's not as bad as before and the mean is closer to the bulk of the data.

\subsection{Linear Regression with Log Transformation}\label{linear-regression-with-log-transformation}

You should run a linear model with and without log transformation to see how the model performs. You can do that by looking at various values.

\begin{itemize}
\tightlist
\item
  SSE
\item
  R2
\item
  p value
\end{itemize}

You can also fit a linear regression plot against a point plot to see how they differ. Let us do this for the \texttt{log10ELP\_frequency} data. It's the smaller dataset. You should also consider log10 transforming your dependent variable as well.

\chapter{Categorical Predictors}\label{categorical-predictors}

Remember that we talked about four basic types of models in terms of their dependent and independent variable types. Variables can assume \textbf{continuous} values (e.g.~reaction time, voicing duration, word count, etc.) or \textbf{categorical} values (e.g.~positive-negative, gender, agreement type, word order (SVO - SOV) etc.).

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Predictor Type (independent var.)}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Outcome Type (dependent var.)}
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Continuous & Continuous \\
\textbf{Categorical} & \textbf{Continuous} \\
Continuous & Categorical \\
Categorical & Categorical \\
\end{longtable}

So far we built models where both the predictor and and the outcome are \textbf{continuous}. Now, we are moving to modeling data where the predictors are \textbf{categorical} and the outcomes are \textbf{continuous}.

\section{Categorical Predictor - Continuous Outcome}\label{categorical-predictor---continuous-outcome}

Models with categorical predictors are quite common in linguistics as well as in many fields that rely on data analytics. Here are some examples:

\begin{itemize}
\tightlist
\item
  What are the reaction times of children vs.~adults for a picture naming task?
\item
  How does pro-drop impact the acceptability ratings of clauses. (Assuming ratings are continuous).
\item
  How does NP ellipsis impact time to comprehend a linguistic expression?
\end{itemize}

Outside linguistics, especially in UX Research, people carry out a lot of A/B testing. For example, they check to see if a particular change to the UI has a significant impact on the user behavior. Here are some examples:

\begin{itemize}
\tightlist
\item
  What is the impact of the background color on the length of stay on a webpage?
\item
  How much money do people from different cities spend on our platform?
\item
  How does the language of a campaign affect the amount of donations made by people?
\end{itemize}

Categorical predictors are used whenever you compare two or more groups based on some classification (e.g.~age, education level, native speaker status, and so on.).

\section{Taste vs.~Smell Words}\label{taste-vs.-smell-words}

The data and analysis for this section comes from Bodo Winter's Chapter 7.

Smell words have been claimed to be more negative than taste words. I don't know if this is true for every language or not but Turkish presents some very nice data points in this direction. Consider the following two expressions.

\begin{itemize}
\tightlist
\item
  Burası (çok) kokuyor.
\item
  Bu (çok) tatlı.
\end{itemize}

Just the verb \emph{kok} ``smell'' seems to have a negative connotation. On the other hand, the adjective \emph{tatlı} ``tasty'' whose root \emph{tat} ``taste'' and the suffix \emph{-lı} simply means ``with'' has a positive connotation. While this is simply a hunch, we don't have enough evidence for Turkish to claim that this is in fact true. Let's hope that someone will run an experiment for Turkish and report the results. For now, we'll use the \textbf{senses\_valence} dataset from Bodo Winter's book.

Let us read in the dataset and see what it looks like.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Import tidyverse}
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\#Read in the data}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}data/winter\_2016\_senses\_valence.csv\textquotesingle{}}\NormalTok{)}
\CommentTok{\#print the head to see what it looks like}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 405 x 3}
\NormalTok{\#\#    Word      Modality   Val}
\NormalTok{\#\#    \textless{}chr\textgreater{}     \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 abrasive  Touch     5.40}
\NormalTok{\#\#  2 absorbent Sight     5.88}
\NormalTok{\#\#  3 aching    Touch     5.23}
\NormalTok{\#\#  4 acidic    Taste     5.54}
\NormalTok{\#\#  5 acrid     Smell     5.17}
\NormalTok{\#\#  6 adhesive  Touch     5.24}
\NormalTok{\#\#  7 alcoholic Taste     5.56}
\NormalTok{\#\#  8 alive     Sight     6.04}
\NormalTok{\#\#  9 amber     Sight     5.72}
\NormalTok{\#\# 10 angular   Sight     5.48}
\NormalTok{\#\# \# i 395 more rows}
\end{Highlighting}
\end{Shaded}

The dataset consists of three variables:

\begin{itemize}
\tightlist
\item
  \textbf{Word}: A word associated with some sense.
\item
  \textbf{Modality}: Modality of the sense (touch, smell, etc.)
\item
  \textbf{Valence}: A numeric value representing the attractiveness-aversiveness of a word.

  \begin{itemize}
  \tightlist
  \item
    Higher Valence is better. See \href{https://en.wikipedia.org/wiki/Valence_(psychology)}{Wikipedia for more on valence}.
  \end{itemize}
\end{itemize}

For now, we're only interested in \textbf{smell} and \textbf{taste}. Yet, it looks like the data has more than that. Let's print the unique values in the Modality column to see all the categories.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Modality)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "Touch" "Sight" "Taste" "Smell" "Sound"}
\end{Highlighting}
\end{Shaded}

Let's now select the rows that have only \textbf{smell} and \textbf{taste} values. For this, we will use the filter function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Filter the data}
\NormalTok{senses\_data }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(data, Modality }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Smell\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Taste\textquotesingle{}}\NormalTok{))}

\CommentTok{\# Check the unique values to make sure}
\FunctionTok{unique}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{Modality)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "Taste" "Smell"}
\end{Highlighting}
\end{Shaded}

Let us quickly get some summary statistics using the `summarize()' function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#pipe the data to a group\_by function}
\CommentTok{\#then pipe the groupings to the summarize function}
\CommentTok{\# create the summary variables for mean and sd}
\NormalTok{senses\_data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{group\_by}\NormalTok{(Modality) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{M =} \FunctionTok{mean}\NormalTok{(Val), }\AttributeTok{SD =} \FunctionTok{sd}\NormalTok{(Val))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 3}
\NormalTok{\#\#   Modality     M    SD}
\NormalTok{\#\#   \textless{}chr\textgreater{}    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 Smell     5.47 0.336}
\NormalTok{\#\# 2 Taste     5.81 0.303}
\end{Highlighting}
\end{Shaded}

It looks like the mean valence for the two groups (smell and taste) are slightly different. Without fitting a model, we won't yet know if this difference is significant (i.e.~meaningful but not by chance).

Before fitting a model though, let us visualize the data to see what it looks like. For categorical variables, it is often useful to plot a box-and-whiskers plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{senses\_data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Modality, }\AttributeTok{y =}\NormalTok{ Val, }\AttributeTok{fill =}\NormalTok{ Modality)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-240-1.pdf}

An alternative way to plot the data is to use density graphs, which are essentially smoothed histograms.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{senses\_data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Val, }\AttributeTok{fill =}\NormalTok{ Modality, }\FunctionTok{after\_stat}\NormalTok{(scaled))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.5}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-241-1.pdf}

\section{Contrasts \& Coding}\label{contrasts-coding}

Linear models are essentially linear equations. This means that they are defined on numeric values (e.g.~5, 0.2, etc.) but not categorical values (e.g.~child-adult, SOV-VSO, etc.). To be able to use linear models with categorical values, we need to convert our categories into some numeric values that can be used in a linear equation. This conversion of categorical values into numeric values is called \textbf{contrast coding}. There are various ways in which this coding can be done and they have slightly different interpretations. While numbers are somewhat arbitrary, the interpretation of the coefficients depends on the choice of the coding technique.

\subsection{Treatment Coding.}\label{treatment-coding.}

One way of coding the difference between two categories is to convert them into ones and zeroes. This is called \textbf{treatment coding}. Sometimes it is also called \textbf{dummy coding}.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
\textbf{Word} & \textbf{Category} & \textbf{Treatment Coding} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
odor & smell & 0 \\
sweet & taste & 1 \\
acrid & smell & 0 \\
\end{longtable}

Let us do this by hand before training a model.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a new column with 0 for smell and 1 for taste}
\NormalTok{senses\_data }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(senses\_data, }\AttributeTok{treatment =} \FunctionTok{ifelse}\NormalTok{(Modality }\SpecialCharTok{==} \StringTok{\textquotesingle{}Taste\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{))}

\NormalTok{senses\_data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 72 x 4}
\NormalTok{\#\#    Word       Modality   Val treatment}
\NormalTok{\#\#    \textless{}chr\textgreater{}      \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 acidic     Taste     5.54         1}
\NormalTok{\#\#  2 acrid      Smell     5.17         0}
\NormalTok{\#\#  3 alcoholic  Taste     5.56         1}
\NormalTok{\#\#  4 antiseptic Smell     5.51         0}
\NormalTok{\#\#  5 aromatic   Smell     5.95         0}
\NormalTok{\#\#  6 astringent Taste     5.96         1}
\NormalTok{\#\#  7 barbecued  Taste     6.05         1}
\NormalTok{\#\#  8 beery      Taste     6.07         1}
\NormalTok{\#\#  9 bitter     Taste     5.12         1}
\NormalTok{\#\# 10 bland      Taste     5.75         1}
\NormalTok{\#\# \# i 62 more rows}
\end{Highlighting}
\end{Shaded}

Now that our categories are turned into numeric values, we can run a model. Let us fit a model where \textbf{valence} is a function of \textbf{modality} using our \textbf{treatment} codes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_1 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Val }\SpecialCharTok{\textasciitilde{}}\NormalTok{ treatment, }\AttributeTok{data =}\NormalTok{ senses\_data)}

\NormalTok{model\_1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = Val \textasciitilde{} treatment, data = senses\_data)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\# (Intercept)    treatment  }
\NormalTok{\#\#      5.4710       0.3371}
\end{Highlighting}
\end{Shaded}

In treatment coding, the intercept becomes the mean of one of your variables whereas the slope is the difference between the two means. You can see this clearly once you plot a linear function between the two variables.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(senses\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ treatment, }\AttributeTok{y=}\NormalTok{ Val))}\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-244-1.pdf}

Let us now take a look at the usual numbers R2 and p-value to interpret how our model is doing.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(model\_1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = Val \textasciitilde{} treatment, data = senses\_data)}
\NormalTok{\#\# }
\NormalTok{\#\# Residuals:}
\NormalTok{\#\#      Min       1Q   Median       3Q      Max }
\NormalTok{\#\# {-}0.99315 {-}0.20870  0.04343  0.19115  0.62788 }
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#             Estimate Std. Error t value Pr(\textgreater{}|t|)    }
\NormalTok{\#\# (Intercept)  5.47101    0.06297  86.889  \textless{} 2e{-}16 ***}
\NormalTok{\#\# treatment    0.33711    0.07793   4.326 4.95e{-}05 ***}
\NormalTok{\#\# {-}{-}{-}}
\NormalTok{\#\# Signif. codes:  0 \textquotesingle{}***\textquotesingle{} 0.001 \textquotesingle{}**\textquotesingle{} 0.01 \textquotesingle{}*\textquotesingle{} 0.05 \textquotesingle{}.\textquotesingle{} 0.1 \textquotesingle{} \textquotesingle{} 1}
\NormalTok{\#\# }
\NormalTok{\#\# Residual standard error: 0.3148 on 70 degrees of freedom}
\NormalTok{\#\# Multiple R{-}squared:  0.2109, Adjusted R{-}squared:  0.1997 }
\NormalTok{\#\# F{-}statistic: 18.71 on 1 and 70 DF,  p{-}value: 4.951e{-}05}
\end{Highlighting}
\end{Shaded}

Normally, you don't have to do the treatment coding by hand. R will do it automatically for you. We did it manually to make sure we understand what's under the hood.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_2 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Val }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Modality, }\AttributeTok{data =}\NormalTok{ senses\_data)}

\NormalTok{model\_2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = Val \textasciitilde{} Modality, data = senses\_data)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#   (Intercept)  ModalityTaste  }
\NormalTok{\#\#        5.4710         0.3371}
\end{Highlighting}
\end{Shaded}

\textbf{Interpreting the coefficients:} Our model is simply the following mathematical model.

\[valence = 5.8 + (−0.3) * modality\]
So, our model predicts only two values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Create a dataset consisting of categories in the data}
\NormalTok{preds }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Modality =} \FunctionTok{unique}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{Modality))}
\CommentTok{\# Print to see what they look like}
\NormalTok{preds}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 1}
\NormalTok{\#\#   Modality}
\NormalTok{\#\#   \textless{}chr\textgreater{}   }
\NormalTok{\#\# 1 Taste   }
\NormalTok{\#\# 2 Smell}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# See the predictions}
\FunctionTok{predict}\NormalTok{(model\_2, preds)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#        1        2 }
\NormalTok{\#\# 5.808124 5.471012}
\end{Highlighting}
\end{Shaded}

\subsection{Sum Coding}\label{sum-coding}

Sum coding is a slightly different coding mechanism. Instead of using 0 and 1 as the coding scheme, we use -1 and 1 as the coding scheme. This has the benefit of having the mean of the means as the intercept. To be able to use R's coding functionality, we should convert our categorical values as \textbf{factors}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{senses\_data}\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(senses\_data, }\AttributeTok{Modality =} \FunctionTok{factor}\NormalTok{(Modality))}

\NormalTok{senses\_data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 72 x 4}
\NormalTok{\#\#    Word       Modality   Val treatment}
\NormalTok{\#\#    \textless{}chr\textgreater{}      \textless{}fct\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 acidic     Taste     5.54         1}
\NormalTok{\#\#  2 acrid      Smell     5.17         0}
\NormalTok{\#\#  3 alcoholic  Taste     5.56         1}
\NormalTok{\#\#  4 antiseptic Smell     5.51         0}
\NormalTok{\#\#  5 aromatic   Smell     5.95         0}
\NormalTok{\#\#  6 astringent Taste     5.96         1}
\NormalTok{\#\#  7 barbecued  Taste     6.05         1}
\NormalTok{\#\#  8 beery      Taste     6.07         1}
\NormalTok{\#\#  9 bitter     Taste     5.12         1}
\NormalTok{\#\# 10 bland      Taste     5.75         1}
\NormalTok{\#\# \# i 62 more rows}
\end{Highlighting}
\end{Shaded}

Next, we can use the contrasts function to see what the current coding scheme looks like.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{contrasts}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{Modality)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#       Taste}
\NormalTok{\#\# Smell     0}
\NormalTok{\#\# Taste     1}
\end{Highlighting}
\end{Shaded}

We can also use R's built in cont function to get various coding types.

\textbf{For treatment coding:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Treatment coding with two variables}
\FunctionTok{contr.treatment}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   2}
\NormalTok{\#\# 1 0}
\NormalTok{\#\# 2 1}
\end{Highlighting}
\end{Shaded}

\textbf{For Sum coding:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Sum coding with two variables}
\FunctionTok{contr.sum}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   [,1]}
\NormalTok{\#\# 1    1}
\NormalTok{\#\# 2   {-}1}
\end{Highlighting}
\end{Shaded}

\textbf{More than 2 variables:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Treatment coding with 3 variables}
\FunctionTok{contr.treatment}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   2 3}
\NormalTok{\#\# 1 0 0}
\NormalTok{\#\# 2 1 0}
\NormalTok{\#\# 3 0 1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Sum coding with 3 variables}
\FunctionTok{contr.sum}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   [,1] [,2]}
\NormalTok{\#\# 1    1    0}
\NormalTok{\#\# 2    0    1}
\NormalTok{\#\# 3   {-}1   {-}1}
\end{Highlighting}
\end{Shaded}

\textbf{More than 2 variables:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Treatment coding with 5 variables}
\FunctionTok{contr.treatment}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   2 3 4 5}
\NormalTok{\#\# 1 0 0 0 0}
\NormalTok{\#\# 2 1 0 0 0}
\NormalTok{\#\# 3 0 1 0 0}
\NormalTok{\#\# 4 0 0 1 0}
\NormalTok{\#\# 5 0 0 0 1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Sum coding with 5 variables}
\FunctionTok{contr.sum}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   [,1] [,2] [,3] [,4]}
\NormalTok{\#\# 1    1    0    0    0}
\NormalTok{\#\# 2    0    1    0    0}
\NormalTok{\#\# 3    0    0    1    0}
\NormalTok{\#\# 4    0    0    0    1}
\NormalTok{\#\# 5   {-}1   {-}1   {-}1   {-}1}
\end{Highlighting}
\end{Shaded}

Let us use sum coding on our data.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Create a new column by copying the modality factors (Taste and Smell)}
\NormalTok{senses\_data }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(senses\_data, }\AttributeTok{sum\_coding=}\NormalTok{Modality)}
\CommentTok{\#Use sum coding using contrasts() and contr.sum()}
\FunctionTok{contrasts}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{sum\_coding) }\OtherTok{\textless{}{-}} \FunctionTok{contr.sum}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\CommentTok{\#run constrasts to see if it worked}
\FunctionTok{contrasts}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{sum\_coding)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#       [,1]}
\NormalTok{\#\# Smell    1}
\NormalTok{\#\# Taste   {-}1}
\end{Highlighting}
\end{Shaded}

Now we can fit a linear model and see what the coefficients look like.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_3 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Val }\SpecialCharTok{\textasciitilde{}}\NormalTok{ sum\_coding, }\AttributeTok{data=}\NormalTok{senses\_data)}

\NormalTok{model\_3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = Val \textasciitilde{} sum\_coding, data = senses\_data)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\# (Intercept)  sum\_coding1  }
\NormalTok{\#\#      5.6396      {-}0.1686}
\end{Highlighting}
\end{Shaded}

The intercept is now the mean of the means. The slope is halved.

Let us also plot the model to see where the intercept is.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(senses\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ sum\_coding, }\AttributeTok{y=}\NormalTok{ Val))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-256-1.pdf}

\section{Categorical Predictors with more than 2 levels}\label{categorical-predictors-with-more-than-2-levels}

Remember that originally our data had 5 levels (``Touch'' ``Sight'' ``Taste'' ``Smell'' ``Sound''). Let us build a linear model that includes all of them.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_4 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Val }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Modality, }\AttributeTok{data=}\NormalTok{data)}
\NormalTok{model\_4}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Call:}
\NormalTok{\#\# lm(formula = Val \textasciitilde{} Modality, data = data)}
\NormalTok{\#\# }
\NormalTok{\#\# Coefficients:}
\NormalTok{\#\#   (Intercept)  ModalitySmell  ModalitySound  ModalityTaste  ModalityTouch  }
\NormalTok{\#\#       5.57966       {-}0.10865       {-}0.17447        0.22846       {-}0.04523}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ Modality, }\AttributeTok{y=}\NormalTok{ Val, }\AttributeTok{color=}\NormalTok{Modality))}\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-258-1.pdf}

\chapter{Effect Size \& Significance}\label{effect-size-significance}

Often times, we will observe a difference between the means of two groups. These groups could be variables of any factor. For example, age could be a factor an we are investigating the difference in voice pitch between children and adults. Or, we could be looking at the difference between the frequency of using the word \textbf{darlamak} between members of Gen X and Gen Z. Yet another example would be looking at the difference between the average valence of smell and taste words.

In all these cases, we are comparing two means. So, let's say we collect data from 100 adults and 100 children and observe that on average children's fundamental frequencies in their voice pitch is 100Hz higher than those of adults.

What have we found? Is this a big difference? (As humans we are usually able to distinguish between an adult and a child when they speak. So, assuming that fundamental frequency is a predictor of adult vs child, then we know that some level of difference in Hertz is the source of this difference. But what is that level?)

Let's say we run another experiment with 5 children and 5 adults. Now, we find the average difference to be 200. So, once again, we face the same question. Is 100 big? Is 200 big? Obviously 200 is bigger than 100 but we don't know if these are big numbers or not.

Once again, we need to think of magnitude not in terms of absolute values but relative to a population (e.g.~humans, children, adults, men, women, etc.). So, it would be great if we could figure out a way to calculate the \textbf{effect size} of a predictor (e.g.~being adult or being a child) in a \textbf{standardized way}. If we have a standard definition of effect size, then we can compute this for any kind of metric.

As we are trying to figure out a standardized effect size (and other values), we'll keep three main points in mind:

\begin{itemize}
\tightlist
\item
  \textbf{Magnitude of difference}

  \begin{itemize}
  \tightlist
  \item
    The bigger the difference between (means of) two sample groups, the more you should expect to see a difference in the population.
  \end{itemize}
\item
  \textbf{Variability in the data}

  \begin{itemize}
  \tightlist
  \item
    The less variability in the data, the more certain you'll be about the estimate.
  \end{itemize}
\item
  \textbf{Sample Size}

  \begin{itemize}
  \tightlist
  \item
    The bigger the sample size, the more accurate is your measurement of the difference.
  \end{itemize}
\end{itemize}

\section{\texorpdfstring{Cohen's \emph{d}}{Cohen's d}}\label{cohens-d}

Cohen's \emph{d} is the measure used to quantify the \textbf{strength} of a difference between two means (m1 and m2). The formula for Cohen's \emph{d} is given below:

\[d = \frac{m_1-m_2}{s}\]
where:
\[m_1 = \text{mean of group 1}\]
\[m_2 = \text{mean of group 2}\]

\[s = \text{pooled standard deviation}\]

We'll calculate s using the formula below for \textbf{pooled} standard deviation:

\[s = \sqrt{\frac{(n_1-1)*sd_1^2 + (n_2-1)*sd_2^2}{n_1+n_2-2}}\]

where:

\[n_1 = \text{number of items in group 1}\]

\[n_2 = \text{number of items in group 2}\]

\[sd_1 = \text{standard deviation of group 1}\]

\[sd_2 = \text{standard deviation of group 2}\]

The reason why we are calculating the \textbf{pooled} standard deviation is to make sure that our standard deviations that come from different means (i.e.~groups of data) are weighted. Below, we'll see that the pooled standard deviation has a slightly different value than the standard deviation of the whole data.

\textbf{Let us try Cohen's \emph{d} for the Smell and Taste data. }

First, load the data and select the relevant data using the filter function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Import tidyverse}
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\#Read in the data}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}data/winter\_2016\_senses\_valence.csv\textquotesingle{}}\NormalTok{)}
\CommentTok{\#filter in the data for the relevant conditions (Taste and Smell)}
\NormalTok{senses\_data }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(data, Modality }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Taste\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Smell\textquotesingle{}}\NormalTok{))}
\CommentTok{\#print the head to see what it looks like}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 405 x 3}
\NormalTok{\#\#    Word      Modality   Val}
\NormalTok{\#\#    \textless{}chr\textgreater{}     \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 abrasive  Touch     5.40}
\NormalTok{\#\#  2 absorbent Sight     5.88}
\NormalTok{\#\#  3 aching    Touch     5.23}
\NormalTok{\#\#  4 acidic    Taste     5.54}
\NormalTok{\#\#  5 acrid     Smell     5.17}
\NormalTok{\#\#  6 adhesive  Touch     5.24}
\NormalTok{\#\#  7 alcoholic Taste     5.56}
\NormalTok{\#\#  8 alive     Sight     6.04}
\NormalTok{\#\#  9 amber     Sight     5.72}
\NormalTok{\#\# 10 angular   Sight     5.48}
\NormalTok{\#\# \# i 395 more rows}
\end{Highlighting}
\end{Shaded}

Let us get the means for each category.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate means for each condition (Taste, Smell)}
\NormalTok{means }\OtherTok{\textless{}{-}}\NormalTok{ senses\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Modality) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{avg =} \FunctionTok{mean}\NormalTok{(Val))}

\CommentTok{\#print means to see what it looks like}
\NormalTok{means}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 2}
\NormalTok{\#\#   Modality   avg}
\NormalTok{\#\#   \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 Smell     5.47}
\NormalTok{\#\# 2 Taste     5.81}
\end{Highlighting}
\end{Shaded}

Let us get the length of each group (i.e.~number of items in each group).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#get the number of items for each condition (Taste, Smell)}
\NormalTok{lengths  }\OtherTok{\textless{}{-}}\NormalTok{ senses\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Modality) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{N =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

Let us now calculate s (pooled standard deviation).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate standard deviation for each condition (Taste, Smell)}
\NormalTok{s\_devs  }\OtherTok{\textless{}{-}}\NormalTok{ senses\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Modality) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{s =} \FunctionTok{sd}\NormalTok{(Val))}

\CommentTok{\#calculate pooled standard deviation using the formula above}
\NormalTok{s }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(((lengths}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(s\_devs}\SpecialCharTok{$}\NormalTok{s[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}\NormalTok{ (lengths}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(s\_devs}\SpecialCharTok{$}\NormalTok{s[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}\SpecialCharTok{/}\NormalTok{(lengths}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{lengths}\SpecialCharTok{$}\NormalTok{N[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{))}

\CommentTok{\#print the pooled standard deviation}
\NormalTok{s}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.3148274}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate and print the standard deviation of the whole data for comparison}
\FunctionTok{sd}\NormalTok{(senses\_data}\SpecialCharTok{$}\NormalTok{Val)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.3519115}
\end{Highlighting}
\end{Shaded}

Now we can calculate Cohen's \emph{d}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{=}\NormalTok{ (means}\SpecialCharTok{$}\NormalTok{avg[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ means}\SpecialCharTok{$}\NormalTok{avg[}\DecValTok{2}\NormalTok{]) }\SpecialCharTok{/}\NormalTok{ s}
\NormalTok{d}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] {-}1.070784}
\end{Highlighting}
\end{Shaded}

We can also use the package \texttt{effsize} to calculate Cohen's d.~You'll see observe a difference between our calculation and the calculation given by the effsize package This is mainly because they use a slightly difference way of calculating variation in the data (the denominator). That's not a huge difference.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(effsize)}
\FunctionTok{cohen.d}\NormalTok{(Val }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Modality, }\AttributeTok{data =}\NormalTok{ senses\_data)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Cohen\textquotesingle{}s d}
\NormalTok{\#\# }
\NormalTok{\#\# d estimate: {-}1.070784 (large)}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#      lower      upper }
\NormalTok{\#\# {-}1.5955866 {-}0.5459824}
\end{Highlighting}
\end{Shaded}

How to interpret Cohen's d?

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
\textbf{Cohen's \emph{d} } & \textbf{Magnitude} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbar0.2\textbar{} & small \\
\textbar0.5\textbar{} & medium \\
\textbar0.8\textbar{} & large \\
\end{longtable}

\begin{figure}
\centering
\includegraphics{./img/cohens.png}
\caption{\label{fig:cohens}Cohen's \emph{d}.}
\end{figure}

\section{Standard Error}\label{standard-error}

Cohen's \emph{d} is a standard measure of difference in magnitude between two samples. It does not care about the sample size though. Your sample size for each group could be 2, 200, 2K, 2M, and so on.

Although, Cohen's \emph{d} can tell us whether the difference between the two samples is large, it won't tell us much about our population.

Here's a small example. I want to test if there is a difference between the voice pitch of people who wear \textbf{blue shirts} and people who wear \textbf{red shirts}. Assume that the following is my data.

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
\textbf{Participant (by shirt color) } & \textbf{Fundamental Frequency} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Blue 1 & 175 \\
Blue 2 & 125 \\
Red 1 & 220 \\
Red 2 & 190 \\
\end{longtable}

Let us run Cohen's d on this data to see what the magnitude of the difference is.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{blue }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{175}\NormalTok{,}\DecValTok{125}\NormalTok{)}
\NormalTok{red }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{220}\NormalTok{,}\DecValTok{190}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(blue) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(red)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] {-}55}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cohen.d}\NormalTok{(blue,red)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Cohen\textquotesingle{}s d}
\NormalTok{\#\# }
\NormalTok{\#\# d estimate: {-}1.886484 (large)}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#     lower     upper }
\NormalTok{\#\# {-}7.058361  3.285392}
\end{Highlighting}
\end{Shaded}

We get a large effect. However, there's no way we can conclude that shirt color has anything to do with someone's voice pitch. We cannot generalize to the population. We observe a difference but we probably have a decent error margin in our prediction. To quantify this error, we need to introduce a new metric \textbf{standard error}.

Standard Error (SE) is a combination of the \textbf{variability} in the data and the \textbf{sample size}

\[SE = \frac{s}{\sqrt{N}}\]

\begin{itemize}
\tightlist
\item
  s = standard deviation
\item
  N = sample size
\end{itemize}

The bigger the standard error, the less accurate is your estimation of the population parameters. This means your estimation (of the parameters, i.e.~mean and standard deviation) is less reliable. The smaller the SE, the more accurate is your calculation of the population parameter estimates.

As you can see from the formula:

\begin{itemize}
\tightlist
\item
  SE will increase as your standard deviation grows (i.e.~there is more variance in the data)
\item
  SE will decrease as your sample size grows
\end{itemize}

Let us calculate the standard error for each of our means.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Calculate Standard Errors}
\NormalTok{SE\_blue }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(blue)}\SpecialCharTok{/}\FunctionTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{SE\_red }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(red)}\SpecialCharTok{/}\FunctionTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{)}

\CommentTok{\#print Standard Error for blue shirts}
\NormalTok{SE\_blue}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 25}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print Standard Error for red shirts}
\NormalTok{SE\_red}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 15}
\end{Highlighting}
\end{Shaded}

Standard Error tells us how close or far away from the true population mean. In this example, we were trying to get the average voice pitch for people wearing a blue shirt and people wearing a red shirt. In each sample, we have only 2 samples. Obviously, this is very little data and the Standard Errors are going to be big.

\section{Confidence Interval}\label{confidence-interval}

Confidence interval is a metric that helps you determine the level of confidence in your population parameter estimates. The formula for 95\% Confidence Interval is as follows:

\[CI = [mean \pm 1.96 * SE ]\]
Let us decompose this formula a bit.

\begin{itemize}
\tightlist
\item
  \textbf{mean} is the sample mean of some sample
\item
  \textbf{SE} is the standard error of the sample
\item
  \(\pm\) indicates that the value is going to be somewhere between \emph{mean plus or minus some value}.
\item
  \textbf{1.96} is a special number that indicates the 95\% CI.\footnote{In fact, it corresponds to the z-score value of 95\%. For calculating the 90\% interval, we would use the corresponding z-score value 1.64.}
\end{itemize}

As the name suggests, CI is an interval and the numbers returned define the range of possible values for 95\% of the time.

Let us calculate the 95\% confidence intervals for our our means for the blue and red data.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate means}
\NormalTok{mean\_blue }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(blue)}
\NormalTok{mean\_red }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(red)}


\CommentTok{\#calculate CIs}
\NormalTok{CI\_blue }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mean\_blue }\SpecialCharTok{{-}} \FloatTok{1.96} \SpecialCharTok{*}\NormalTok{ SE\_blue, mean\_blue }\SpecialCharTok{+} \FloatTok{1.96} \SpecialCharTok{*}\NormalTok{ SE\_blue)}
\NormalTok{CI\_red }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mean\_red }\SpecialCharTok{{-}} \FloatTok{1.96} \SpecialCharTok{*}\NormalTok{ SE\_red, mean\_red }\SpecialCharTok{+} \FloatTok{1.96} \SpecialCharTok{*}\NormalTok{ SE\_red)}


\NormalTok{name }\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}mean\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}SE\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}CI\_min\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}CI\_max\textquotesingle{}}\NormalTok{)}
\NormalTok{val\_blue}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(mean\_blue,SE\_blue,CI\_blue)}
\NormalTok{val\_red}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(mean\_red,SE\_red,CI\_red)}

\CommentTok{\#print mean, SE, and CI for blue}
\NormalTok{blue\_st }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(name, val\_blue)}
\NormalTok{blue\_st}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#     name val\_blue}
\NormalTok{\#\# 1   mean      150}
\NormalTok{\#\# 2     SE       25}
\NormalTok{\#\# 3 CI\_min      101}
\NormalTok{\#\# 4 CI\_max      199}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#print mean, SE, and CI for red}
\NormalTok{red\_st }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(name, val\_red)}
\NormalTok{red\_st}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#     name val\_red}
\NormalTok{\#\# 1   mean   205.0}
\NormalTok{\#\# 2     SE    15.0}
\NormalTok{\#\# 3 CI\_min   175.6}
\NormalTok{\#\# 4 CI\_max   234.4}
\end{Highlighting}
\end{Shaded}

\section{Standard Error of the difference of two means}\label{standard-error-of-the-difference-of-two-means}

In the previous sections, we calculated the SE and CI for each sample (blue and red). However, what we are ultimately interested in is the difference in the means between two groups. The difference in the mean is what will tell us if there is a significant difference between the voice pitches of people wearing different colors. To calculate the Standard Error for the difference in mean of two samples, we use the formula below.

\[SE_{diff} = \sqrt{\frac{SD_1^2}{n_1}+\frac{SD_2^2}{n_2}}\]
Let us calculate the SE of the difference in mean.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate standard deviations}

\NormalTok{sd\_blue }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(blue)}
\NormalTok{sd\_red }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(red)}

\CommentTok{\# calculate SE\_diff}
\NormalTok{SE\_diff }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(sd\_blue}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{/}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ sd\_red}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{/}\DecValTok{2}\NormalTok{)}

\CommentTok{\#print SE\_diff}
\NormalTok{SE\_diff}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 29.15476}
\end{Highlighting}
\end{Shaded}

Let us now calculate the 95\% CI for the difference in means.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate the difference in means}
\NormalTok{diff\_mean }\OtherTok{\textless{}{-}}\NormalTok{ mean\_blue }\SpecialCharTok{{-}}\NormalTok{ mean\_red}

\CommentTok{\#calculate the 95\% CI}
\NormalTok{CI\_diff }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(diff\_mean}\FloatTok{{-}1.96}\SpecialCharTok{*}\NormalTok{SE\_diff, diff\_mean}\FloatTok{+1.96}\SpecialCharTok{*}\NormalTok{SE\_diff)}

\CommentTok{\#print the CI\_diff by rounding the numbers to 2 decimal point}
\FunctionTok{round}\NormalTok{(CI\_diff, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] {-}112.14    2.14}
\end{Highlighting}
\end{Shaded}

\section{Hypothesis Testing}\label{hypothesis-testing}

Remember that throughout the semester we talked about forming and testing hypotheses. Let us form our hypotheses and then test them.

Let us build our \textbf{alternative hypothesis}.

\begin{itemize}
\tightlist
\item
  H1: There is a difference in voice pitch between people who wear blue and people who wear red.
\end{itemize}

Now, let us build our null hypothesis.

\begin{itemize}
\tightlist
\item
  H0: There is \textbf{no} difference in voice pitch between people who wear blue and people who wear red.
\end{itemize}

In hypothesis testing framework, we do not try proving our alternative hypothesis (H1). Instead, we try \textbf{rejecting the null hypothesis}.

To reject the null hypothesis we do the following:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Make an observation.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  In this case, our observation is the difference in means between two colors.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Calculate the probability of making this observation.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  This means we need to find the \textbf{p-value} of the observation.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Check the \textbf{p-value} against a \textbf{critical value} called alpha (\(\alpha\)).
\end{enumerate}

\begin{itemize}
\tightlist
\item
  If the \textbf{p-value} is smaller than the \textbf{critical value}, then we \textbf{reject} the null hypothesis.
\item
  else, we maintain the null hypothesis.
\end{itemize}

What is the \textbf{critical value}. Critical value is a value that we define depending on the nature of our question. It's up to us and how we want to interpret the results. The scientific community has converged on using several critical values.

\begin{itemize}
\tightlist
\item
  \(\alpha\) = 0.05 (commonly adopted for social sciences)
\item
  \(\alpha\) = 0.01
\item
  \(\alpha\) = 0.001
\end{itemize}

\textbf{So, how do we calculate the p-value for our null hypothesis}?

In other words, how do we calculate the p-value for the difference we observe between people who wear blue and red? To do this, we need a particular method that allows us to calculate some statistics for the \textbf{difference between two means}. For this, we will use a \textbf{t-test} which allows us to calculate a standardized \textbf{t-score} which comes from a particular distribution called \textbf{t-distribution}. Once we have a \textbf{t-score}, we can check it against the \textbf{t-distribution} to calculate its \textbf{p-value}.

\section{Calculating the t-score}\label{calculating-the-t-score}

\textbf{t-score} is calculated using the following formula.

\[t = \frac{mean1-mean2}{SE_{diff}}\]
What the t-score encodes is 1) magnitude of the difference, 2)Variability in the data 3) Sample size. So, all of the information we need.

Let us calculate the t-score for our data.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#calculate the t{-}score}
\NormalTok{t }\OtherTok{\textless{}{-}}\NormalTok{ diff\_mean }\SpecialCharTok{/}\NormalTok{ SE\_diff}
\CommentTok{\#print the t{-}score}
\NormalTok{t}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] {-}1.886484}
\end{Highlighting}
\end{Shaded}

\textbf{How do we interpret the t-score}
t-score is going to be a value from a t-distribution. A t-distribution is very similar to a normal distribution except that it has \textbf{heavier tails}. What this means is that there is a higher probability of having more extreme values especially with small data sets. Let's take a look at the t-and normal distributions.

A t-distribution is like a normal distribution but has an additional parameter called \textbf{degrees of freedom}. This is relatively vague concept we won't go into. You can google it and find what it means intuitively. For our purposes, we will just assume that degrees of freedom is calculated by deducing 1 from our sample size.

\begin{itemize}
\tightlist
\item
  df\_blue = sample\_size\_blue - 1
\item
  df\_red = sample\_size\_red - 1
\end{itemize}

When we are calculating the degrees of freedom for both samples, then we calculate it using the formula below:

\begin{itemize}
\tightlist
\item
  df = sample\_size\_blue + sample\_size\_red -2
\end{itemize}

Given that we have a total of 4 data points, then our df will be 2.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dt}\NormalTok{(x, }\AttributeTok{df=}\DecValTok{2}\NormalTok{), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.5}\NormalTok{)) }\CommentTok{\# 2 degrees of freedom}
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(x), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{,}\AttributeTok{add=}\ConstantTok{TRUE}\NormalTok{) }

\FunctionTok{legend}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, .}\DecValTok{3}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"t (df=2)"}\NormalTok{, }\StringTok{"normal"}\NormalTok{),}
       \AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"steelblue"}\NormalTok{ ), }\AttributeTok{lty=}\DecValTok{5}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-271-1.pdf}

\textbf{t-distribution} approaches normal distribution (for z-scores) as the degrees of freedom increases. At 30 degrees of freedom or above, it becomes very similar to normal distribution.\footnote{This is part of the reason why people aim for at least 30 participants in each group.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dt}\NormalTok{(x, }\AttributeTok{df=}\DecValTok{10}\NormalTok{), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.5}\NormalTok{)) }\CommentTok{\#10 degrees of freedom}
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(x), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{,}\AttributeTok{add=}\ConstantTok{TRUE}\NormalTok{) }

\FunctionTok{legend}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, .}\DecValTok{3}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"t (df=2)"}\NormalTok{, }\StringTok{"normal"}\NormalTok{),}
       \AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"steelblue"}\NormalTok{ ), }\AttributeTok{lty=}\DecValTok{5}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-272-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dt}\NormalTok{(x, }\AttributeTok{df=}\DecValTok{30}\NormalTok{), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.5}\NormalTok{)) }\CommentTok{\#30 degrees of freedom}
\FunctionTok{curve}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(x), }\AttributeTok{from=}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\AttributeTok{to=}\DecValTok{4}\NormalTok{, }\AttributeTok{col =} \StringTok{\textquotesingle{}steelblue\textquotesingle{}}\NormalTok{,}\AttributeTok{add=}\ConstantTok{TRUE}\NormalTok{) }

\FunctionTok{legend}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, .}\DecValTok{3}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"t (df=2)"}\NormalTok{, }\StringTok{"normal"}\NormalTok{),}
       \AttributeTok{col=}\FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"steelblue"}\NormalTok{ ), }\AttributeTok{lty=}\DecValTok{5}\NormalTok{, }\AttributeTok{cex=}\FloatTok{1.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-273-1.pdf}

\section{p-value}\label{p-value}

p-value is the probability of observing a particular t-score given a t-distribution. So, all we need to do now is to calculate the p-value for the t-score we observed above. There are various ways of doing this. Many people use a t-table to do the calculation. See \href{https://www.sjsu.edu/faculty/gerstman/StatPrimer/t-table.pdf}{this link}.

Alternatively, we can calculate it using the \texttt{pt()} function, which takes the following arguments.

\begin{itemize}
\tightlist
\item
  t-score
\item
  degrees of freedom
\item
  A Boolean for lower.tail (optional)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pt}\NormalTok{(}\FunctionTok{abs}\NormalTok{(t),}\FloatTok{1.6374}\NormalTok{,}\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.1135606}
\end{Highlighting}
\end{Shaded}

The value we get is going to be the probability of t-score on one tail of the distribution (called \textbf{one-tailed}). This is used for a directional hypothesis (e.g.~red shirts have a higher voice pitch than blue ones). In our case, we are interested in the difference regardless of the direction. For this, we can simply multiply our p-value by 2 to get a \textbf{two-tailed} distribution.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{*}\FunctionTok{pt}\NormalTok{(}\FunctionTok{abs}\NormalTok{(t),}\FloatTok{1.6374}\NormalTok{, }\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.2271212}
\end{Highlighting}
\end{Shaded}

It looks like our p-value is larger than the critical value \(\alpha = 0.05\). So, we \textbf{cannot reject} our null hypothesis. This means that, there is a big chance of observing such a difference in mean when we have only a total of 4 data points.

Even though our effect size is large as can be seen below, our results are \textbf{not significant}. In other words, the big difference is due to chance and we cannot conclude that there is a difference in the voice pitches of people who wear blue and people who wear red.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cohen.d}\NormalTok{(blue,red)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\# Cohen\textquotesingle{}s d}
\NormalTok{\#\# }
\NormalTok{\#\# d estimate: {-}1.886484 (large)}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#     lower     upper }
\NormalTok{\#\# {-}7.058361  3.285392}
\end{Highlighting}
\end{Shaded}

\section{Type I and Type II Errors}\label{type-i-and-type-ii-errors}

Sometimes, we might find \(p < 0.05\) which suggests that we have found a significant result. However, this is not always true. Such errors are called Type I error (also known as False Positive). Other times, there might be a significant difference between our two groups but we might fail to identify this significance because we got \(p \geq 0.05\). Such errors are called Type II errors (a.k.a. False Negative). Such errors usually occur when we don't have sufficient data (i.e.~sample size is too small).

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Error Type}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Explanation}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{a.k.a.}
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Type I} & \(p < 0.05\) but in fact there is no significant difference & False Positive \\
\textbf{Type II} & \(p \geq 0.05\) but in fact there is a significant difference & False Negative \\
\end{longtable}

\subsection{Type I Error}\label{type-i-error}

Remember that the difference between two groups of data is \textbf{statistically significant} means that there is an actual meaningful difference in the way these data are generated. This difference can be small or big in terms of its effect size. This difference might be caused by one factor or by many factors. What matters is that there is an underlying difference in the mechanism that is generating the data. This underlying difference is causing the actual variance in the data from two distinct groups.

Also remember that the variance within or across two groups can also be caused by completely random factors. For example, when you are measuring the reaction time, a little insect in the room might lead to a bit of a distraction and increase the reaction time.

Given all this background, let us see a little bit of a random data that was generated from a single distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_1 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}
\NormalTok{data\_2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\NormalTok{data\_1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] {-}0.2918083  1.3658382  0.8477967  0.2659059  0.2180279  1.5515670}
\NormalTok{\#\#  [7] {-}0.6108410  1.7481764  1.4492960  0.1299375}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  0.902252069  1.893100214  2.350915095  2.488970394  1.371067213}
\NormalTok{\#\#  [6]  0.785526756  1.455494590  0.741888890 {-}0.002923752  1.844143483}
\end{Highlighting}
\end{Shaded}

You see that the data points are different but the parameters are the same. So underlyingly, they come from the same distribution, same data generation process, there is no actual difference between the two datasets in terms of the underlying mechanism.

Let us now pass the data through a t test for a few times to see if we can ever find a statistically significant difference.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{42}\NormalTok{)}
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 1, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = 1.2268, df = 13.421, p{-}value = 0.241}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}0.5369389  1.9584459}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 1.5472968 0.8365433}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 1, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = 0.36582, df = 17.977, p{-}value = 0.7188}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}0.8814711  1.2531201}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 0.8219205 0.6360959}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 1, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = {-}0.082117, df = 16.257, p{-}value = 0.9356}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}1.0340503  0.9568318}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 0.9797846 1.0183939}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 1, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = 2.3062, df = 17.808, p{-}value = 0.03335}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  0.06683172 1.44707262}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 1.5390768 0.7821246}
\end{Highlighting}
\end{Shaded}

As you can see, the fourth model came out to be statistically significant. This is a Type I Error.

\subsection{Typee II Error}\label{typee-ii-error}

Now, let us create data with different parameters. This time, the means are going to be different.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_1 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}
\NormalTok{data\_2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\NormalTok{data\_1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  1.51270701  0.25792144  0.08844023 {-}0.12089654 {-}1.19432890  0.61199690}
\NormalTok{\#\#  [7] {-}0.21713985 {-}0.18275671  0.93334633  0.82177311}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1]  2.3921164  0.5238261  1.6503486  2.3911105 {-}0.1107889  0.1392074}
\NormalTok{\#\#  [7] {-}0.1317387 {-}0.4592140  1.0799826  1.6532043}
\end{Highlighting}
\end{Shaded}

Now, let's run the model a few times again.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{42}\NormalTok{)}
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 0, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = {-}0.49924, df = 13.421, p{-}value = 0.6257}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}1.5369389  0.9584459}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 0.5472968 0.8365433}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 0, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = {-}1.6028, df = 17.977, p{-}value = 0.1264}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}1.8814711  0.2531201}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\#  mean of x  mean of y }
\NormalTok{\#\# {-}0.1780795  0.6360959}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 0, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = {-}2.209, df = 16.257, p{-}value = 0.04186}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}2.03405031 {-}0.04316822}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\#   mean of x   mean of y }
\NormalTok{\#\# {-}0.02021535  1.01839391}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# }
\NormalTok{\#\#  Welch Two Sample t{-}test}
\NormalTok{\#\# }
\NormalTok{\#\# data:  rnorm(10, mean = 0, sd = 1) and rnorm(10, mean = 1, sd = 1)}
\NormalTok{\#\# t = {-}0.74048, df = 17.808, p{-}value = 0.4687}
\NormalTok{\#\# alternative hypothesis: true difference in means is not equal to 0}
\NormalTok{\#\# 95 percent confidence interval:}
\NormalTok{\#\#  {-}0.9331683  0.4470726}
\NormalTok{\#\# sample estimates:}
\NormalTok{\#\# mean of x mean of y }
\NormalTok{\#\# 0.5390768 0.7821246}
\end{Highlighting}
\end{Shaded}

As you can see, the results end up being not significant despite an actual difference in the parameters that generate data.

\subsection{Statistical Power}\label{statistical-power}

The rate at which a model would makes a Type II error is called Type II Error rate represented as \(\beta\). We want to minimize \(\beta\) as much as possible. The lower the error rate, the more powerful our model is. A standard way of measuring how powerful our model is the concept of \textbf{statistical power}.

\begin{itemize}
\tightlist
\item
  Statistical power = 1-\(\beta\)
\end{itemize}

The higher the statistical power of a model, the more reliable it is. Often people aim for a value above 80\%. To calculate the statistical power of a t test in r, we can use the following code.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{effect\_size }\OtherTok{\textless{}{-}} \FunctionTok{cohen.d}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}\SpecialCharTok{$}\NormalTok{estimate}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{alpha }\OtherTok{\textless{}{-}} \FloatTok{0.05}

\NormalTok{power }\OtherTok{\textless{}{-}} \FunctionTok{power.t.test}\NormalTok{(}\AttributeTok{n =}\NormalTok{ n, }\AttributeTok{delta =}\NormalTok{ effect\_size, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{, }\AttributeTok{sig.level =}\NormalTok{ alpha, }\AttributeTok{type =} \StringTok{"two.sample"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{power}

\NormalTok{power}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.3273469}
\end{Highlighting}
\end{Shaded}

Now, let us try the same data with an increased number of observations.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{effect\_size }\OtherTok{\textless{}{-}} \FunctionTok{cohen.d}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{,}\AttributeTok{mean =}\DecValTok{1}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{))}\SpecialCharTok{$}\NormalTok{estimate}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{300}
\NormalTok{alpha }\OtherTok{\textless{}{-}} \FloatTok{0.05}

\NormalTok{power }\OtherTok{\textless{}{-}} \FunctionTok{power.t.test}\NormalTok{(}\AttributeTok{n =}\NormalTok{ n, }\AttributeTok{delta =}\NormalTok{ effect\_size, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{, }\AttributeTok{sig.level =}\NormalTok{ alpha, }\AttributeTok{type =} \StringTok{"two.sample"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{power}

\NormalTok{power}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.999999}
\end{Highlighting}
\end{Shaded}

\chapter{Logistic Regression}\label{logistic-regression}

So far, we built linear models where the outcome (i.e.~dependent variable) was a continuous value (e.g.~reaction time, frequency, etc.). Now, we turn to modeling data where the outcome is a \textbf{categorial} value. In particular, we will use \textbf{logistic regression} to model \textbf{categorical} outcomes where the number of categories is \textbf{two}. Some examples are:

\begin{itemize}
\tightlist
\item
  acceptable -- unacceptable expression
\item
  NP NP construction -- NP PP construction
\item
  SOV -- SVO word order
\item
  accusative present -- accusative absent
\item
  adult -- child
\end{itemize}

For example, we can use \textbf{average utterance length} as an indicator of \textbf{child speech} vs.~\textbf{adult speech}. Consider the following artificial toy dataset.

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
\textbf{Utterance length } & \textbf{Utterer} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
2 & child \\
8 & adult \\
12 & adult \\
3 & adult \\
3 & child \\
6 & adult \\
\textbf{5} & \textbf{???} \\
\end{longtable}

\textbf{Given the data set above, can we predict whether it was uttered by a child or an adult?}

Notice that the answer is not that straightforward as it is possible that the utterance belongs to a child because it is shortish but on the other hand, we do see that the adults also produce short sentences (e.g.~utterance length of 3).

\section{The Intuition}\label{the-intuition}

The core intuition behind logistic regression is very simple. The task is to \textbf{model the probability of an outcome given a predictor}. Going back to our toy example above, we would like a model that can produce probabilities like the following.

\begin{itemize}
\tightlist
\item
  \(p(child | length = 5)\)

  \begin{itemize}
  \tightlist
  \item
    read as \emph{probability of the utterer being a child given that the utterance length is 5}
    \\
  \end{itemize}
\item
  \(p(adult | length = 5)\)

  \begin{itemize}
  \tightlist
  \item
    read as \emph{probability of the utterer being an adult given that the utterance length is 5}
  \end{itemize}
\end{itemize}

For example, we want to build a model that returns something like the following.

\includegraphics{main_files/figure-latex/unnamed-chunk-283-1.pdf}

Once we estimate the probabilities, we have a model that can:

\begin{itemize}
\tightlist
\item
  \textbf{predict} the categorical outcome (e.g.~adult vs.~child)
\item
  help us \textbf{interpret} the relationship between a predictor and the outcome
\end{itemize}

Let us now turn to the math behind how the logistic regression works.

\section{The Math}\label{the-math}

Remember that our \textbf{linear regression} models assumed that our data is \textbf{normally distributed}. Normal distribution is a distribution of continuous values. Similarly, for \textbf{logistic regression}, we assume that the \textbf{outcome variables} come from a certain probability distribution.

\subsection{Binomial \& Bernoulli Distributions}\label{binomial-bernoulli-distributions}

\subsubsection{Binomial Distribution}\label{binomial-distribution}

The \textbf{Binomial Distribution} is a discrete probability distribution with a fixed number of \textbf{Bernoulli trials} with the parameters:

\begin{itemize}
\tightlist
\item
  \(n\) trials
\item
  \(p\) probability
\end{itemize}

where each trial has only two possible outcomes: \textbf{success} or \textbf{failure}. Success can be associated with any outcome that is relevant to you as long as there are only two outomes. For example:

\begin{itemize}
\tightlist
\item
  success = child -- failure = adult
\item
  success = acceptable -- failure = unacceptable
\item
  success = SVO -- failure = SOV
\item
  \ldots{}
\end{itemize}

A good way of understanding the binomial distribution is to think of a coin-flip experiment. Imagine that you have a fair coin and you flip the coin 10 times. What is the probability that you will have 5 heads (i.e.~successes)?

\includegraphics{main_files/figure-latex/unnamed-chunk-284-1.pdf}

To get the actual probability values in R, we can use the \texttt{dbinom()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n }\OtherTok{=} \DecValTok{10} \CommentTok{\#number of trials}
\NormalTok{p }\OtherTok{=} \FloatTok{0.5} \CommentTok{\#probability of success (e.g. heads)}
\NormalTok{s }\OtherTok{=} \DecValTok{5} \CommentTok{\#number of successes in n trails (e.g. number of heads in 10 trials)}

\FunctionTok{dbinom}\NormalTok{(s,n,p)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.2460938}
\end{Highlighting}
\end{Shaded}

Try it with different parameters to see how the probabilites change.

Notice that the binomial distribution is a discrete distribution (not continuous) but the plot looks very similar to a normal distribution especially when the number of trials is at or above 30.

\includegraphics{main_files/figure-latex/unnamed-chunk-286-1.pdf}

\includegraphics{main_files/figure-latex/unnamed-chunk-287-1.pdf}

\subsubsection{Bernoulli distribution}\label{bernoulli-distribution}

A Bernoulli distribution is a special case of a binomial distribution with where the number of trials is 1. The only relevant parameter is the \(p\). Thus, Bernoulli distribution for a fair coin would look like the following.

\includegraphics{main_files/figure-latex/unnamed-chunk-288-1.pdf}

What if the coin were a bit unfair. Assume that you want to cheat but not too much to avoid getting caught.

\includegraphics{main_files/figure-latex/unnamed-chunk-289-1.pdf}

Finally, going back to our toy example from above about the length of utterances. Notice that this is also a Bernoulli distribution.

\includegraphics{main_files/figure-latex/unnamed-chunk-290-1.pdf}

Bernoulli distribution will vary based on a single parameter \(p\), which is the probability of success for a given condition.

\section{Logistic Regression}\label{logistic-regression-1}

Remember that in \textbf{linear regression}, the goal was to estimate the model parameters that can describe a line.

\[ \underbrace{Y}_{\text{dependent variable}} =
            \overbrace{\underbrace{a}_{\text{intercept}}}^{\text{additive term}} + 
            \overbrace{\underbrace{b}_{\text{slope}} * \underbrace{X}_{\text{predictor}}}^{\text{additive term}} \]

In other words, our model took input some data, assumed that the variance in the data can be described by a line, then tried to estimate the parameters (i.e.~intercept and slope). For example, we tried to estimate the taxi fare cost and our linear model could predict it as follows:

\begin{itemize}
\tightlist
\item
  cost = Intercept + Slope * Distance (in km)
\item
  cost = 20 + 14 * 5
\end{itemize}

The values for the intercept and the slope were estimated by the model after analyzing the input data. The output of the model (i.e.~the cost) is an \textbf{arbitrary number} (e.g.~90 TL).

In \textbf{logistic regression}, we don't want an arbitrary number. Instead, we want a \textbf{category} (e.g.~adult or child) along with a \textbf{probability}. In fact, what we need is a probability for success and the Bernoulli distribution will handle the rest.

\begin{itemize}
\tightlist
\item
  \(y \sim Bernoulli(p)\)

  \begin{itemize}
  \tightlist
  \item
    read as \emph{\(y\) as a function of Bernoulli(p)}
  \item
    \(y\) is the predicted category
  \end{itemize}
\end{itemize}

So, we need a way to convert \textbf{arbitrary numbers} (output of the linear equation) to \textbf{probabilities}. Remember that probabilities range between {[}0,1{]}.

In mathematics, there is a really nice function that will squeeze arbitrary numbers between {[}0,1{]}. The name of this function is the \textbf{logistic function}.

\begin{figure}
\centering
\includegraphics{./img/logis.png}
\caption{\label{fig:unnamed-chunk-291}Logistic Function}
\end{figure}

In R, we can use the \texttt{plogis()} function to apply the logistic function to an arbitrary number. Try the following code with various values to see what you get.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plogis}\NormalTok{(}\DecValTok{90}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plogis}\NormalTok{(}\FloatTok{2.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.8909032}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plogis}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plogis}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.04742587}
\end{Highlighting}
\end{Shaded}

This is nice because we can use the logistic function to convert the output of our linear function to probabilities. Once we have the probabilities, we can get a Bernoulli distribution to predict the category we are interested in.

By now, it should be clear where the name \textbf{logistic regression} comes from.

\subsection{Log Odds \& Logits}\label{log-odds-logits}

In a nutshell, the logistic regression model works as follows:

\begin{itemize}
\tightlist
\item
  \(p = logistic(output)\)
\item
  \(y \sim Bernoulli(p)\)
\end{itemize}

You calculate some output:

\begin{itemize}
\tightlist
\item
  (\(output = Intercept + Slope * input\))
\end{itemize}

You convert it to a probability:

\begin{itemize}
\tightlist
\item
  \(p = logistic(output)\)
\end{itemize}

The rest is just a Bernoulli distribution with the parameter \(p\):

\begin{itemize}
\tightlist
\item
  \(y \sim Bernoulli(p)\)
\end{itemize}

There is an important difference though. In \textbf{linear regression} the output is just an arbitrary number :

\begin{itemize}
\tightlist
\item
  (\(output = Intercept + Slope * input\)).
\end{itemize}

In \textbf{logistic regression}, the model output is a \textbf{logit}. So, we calculate the probability of logits rather than arbitrary numbers.

\begin{itemize}
\tightlist
\item
  \(logit(p)= intercept + slope * x\)
\end{itemize}

\subsubsection{Odds, Log Odds, and Logits}\label{odds-log-odds-and-logits}

Yon understand \textbf{logits}, we need to understand the concept of \textbf{odds}. You must have heard questions like:

\begin{itemize}
\tightlist
\item
  What are the \textbf{odds} that our team will win this week?
\item
  The \textbf{odds} are in my favor.
\item
  The \textbf{odds} are 1 to 1.
\end{itemize}

The \textbf{odds} express the probability of an event occurring (p) over the probability of an event not occurring (1 − p).

\begin{itemize}
\tightlist
\item
  \(odds(X=win) = \frac{P(X=win)}{1-P(X=win)}\)
\end{itemize}

\textbf{Logits} are log odds (\(log(odd)\)). Converting the odds to log odds (i.e.~logits) turns them into a \textbf{continuous scale} from negative infinity to positive infinity. Thus, it allows us to model \textbf{categorical outcomes} similar to \textbf{continuous outcomes}.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
\textbf{Probability} & \textbf{Odds} & \textbf{log odds (logits}) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0.1 & 0.11 to 1 & --2.20 \\
0.4 & 0.67 to 1 & --0.41 \\
0.5 & 1 to 1 & 0.00 \\
0.8 & 4 to 1 & +1.39 \\
0.9 & 9 to 1 & +2.20 \\
\end{longtable}

\textbf{Logistic Regression} models estimate coefficients (intercept and slope) as \textbf{logits}. We can turn logits into probabilities, simply by feeding them into the \textbf{logistic function}.

\section{Logistic Regression in R}\label{logistic-regression-in-r}

\subsection{Data}\label{data}

Let us see \textbf{logistic regression} in action by using it on a dataset from Bodo Winter's book. For this task, we will use the \texttt{speech\_errors} dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{\textquotesingle{}\textasciitilde{}/ling\_411/data/speech\_errors.csv\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 40 Columns: 2
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## dbl (2): BAC, speech_error
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 40 x 2}
\NormalTok{\#\#       BAC speech\_error}
\NormalTok{\#\#     \textless{}dbl\textgreater{}        \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1 0.0737            0}
\NormalTok{\#\#  2 0.0973            0}
\NormalTok{\#\#  3 0.234             0}
\NormalTok{\#\#  4 0.138             1}
\NormalTok{\#\#  5 0.0933            0}
\NormalTok{\#\#  6 0.262             1}
\NormalTok{\#\#  7 0.357             0}
\NormalTok{\#\#  8 0.237             1}
\NormalTok{\#\#  9 0.352             1}
\NormalTok{\#\# 10 0.379             1}
\NormalTok{\#\# \# i 30 more rows}
\end{Highlighting}
\end{Shaded}

The data consists of two columns:

\begin{itemize}
\tightlist
\item
  \texttt{BAC}: A continuous value representing the level of Blood Alcohol Concentration
\item
  \texttt{speech\_error}: A binary value representing the presence and absence of a speech error.

  \begin{itemize}
  \tightlist
  \item
    1 = speech error
  \item
    0 = no speech error
  \end{itemize}
\end{itemize}

\subsection{Model}\label{model}

In R, we will use the \texttt{glm()} function, which stands for \textbf{generalized linear model}. \texttt{glm()} takes input

\begin{itemize}
\tightlist
\item
  an output variable,
\item
  predictors
\item
  a dataset
\item
  a \textbf{family} parameter, which will be \texttt{\textquotesingle{}binomial\textquotesingle{}} for our purposes
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{speech\_error\_model }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(speech\_error }\SpecialCharTok{\textasciitilde{}}\NormalTok{ BAC, }\AttributeTok{data =}\NormalTok{ data,}
                          \AttributeTok{family =} \StringTok{\textquotesingle{}binomial\textquotesingle{}}
\NormalTok{                          )}
\end{Highlighting}
\end{Shaded}

Simple as that, we have modeled the presence and absence of speech errors as a function of blood alcohol concentration using \textbf{logistic regression}. Let us inspect the model coefficients to understand what our model learnt from the data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(broom)}
\FunctionTok{tidy}\NormalTok{(speech\_error\_model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 5}
\NormalTok{\#\#   term        estimate std.error statistic  p.value}
\NormalTok{\#\#   \textless{}chr\textgreater{}          \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)    {-}3.64      1.12     {-}3.24 0.00118 }
\NormalTok{\#\# 2 BAC            16.1       4.86      3.32 0.000903}
\end{Highlighting}
\end{Shaded}

\textbf{We learn a few things:}

\begin{itemize}
\tightlist
\item
  The slope of BAC is positive (16.1). This means that an increase in BAC will lead to an increase in speech errors.
\item
  We also see that the p \textless{} 0.05. This indicates that our conclusion is statistically significant.
\item
  Remember that the output of logistic regression is a \textbf{logit}. Thus our coefficients (intercept and slope) are in logit units.
\end{itemize}

\textbf{The results of the model can be reported as:}

\begin{itemize}
\tightlist
\item
  There was a reliable effect of BAC (logit coefficient: +16.11, SE = 4.86, z=3.3, p = 0.0009).
\end{itemize}

\subsection{From logits to probabilities}\label{from-logits-to-probabilities}

Logits are a bit confusing. Let us turn our logits to probabilities to get a more intuitive understanding of the model results.

First, let us convert the intecept to a probability. Remember that the intercept is the logit for BAC = 0.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{intercept }\OtherTok{\textless{}{-}} \FunctionTok{tidy}\NormalTok{(speech\_error\_model)}\SpecialCharTok{$}\NormalTok{estimate[}\DecValTok{1}\NormalTok{]}
\NormalTok{slope }\OtherTok{\textless{}{-}} \FunctionTok{tidy}\NormalTok{(speech\_error\_model)}\SpecialCharTok{$}\NormalTok{estimate[}\DecValTok{2}\NormalTok{]}

\FunctionTok{plogis}\NormalTok{(intercept)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.02549508}
\end{Highlighting}
\end{Shaded}

This shows that a sober person will make a speech error with the probability \(P=0.025\), quite a small probability.

Now let us check the probability of a person with a BAC of 0.4 making speech errors.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logit }\OtherTok{\textless{}{-}}\NormalTok{ intercept }\SpecialCharTok{+}\NormalTok{ slope }\SpecialCharTok{*} \FloatTok{0.3}
\NormalTok{probablity }\OtherTok{\textless{}{-}} \FunctionTok{plogis}\NormalTok{(logit)}
\NormalTok{probablity}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.7670986}
\end{Highlighting}
\end{Shaded}

That is a huge jump. Our model predicts that someone with a \(BAC = 0.3\) will make a speech error with a probability \(P = 0.76\), a lot more likely.

Let's see what the data looks like.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_bac\_0}\FloatTok{.3} \OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(data,BAC}\SpecialCharTok{\textgreater{}=}\FloatTok{0.3}\NormalTok{)}
\NormalTok{data\_bac\_0}\FloatTok{.3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 9 x 2}
\NormalTok{\#\#     BAC speech\_error}
\NormalTok{\#\#   \textless{}dbl\textgreater{}        \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 0.357            0}
\NormalTok{\#\# 2 0.352            1}
\NormalTok{\#\# 3 0.379            1}
\NormalTok{\#\# 4 0.306            0}
\NormalTok{\#\# 5 0.382            1}
\NormalTok{\#\# 6 0.308            1}
\NormalTok{\#\# 7 0.394            1}
\NormalTok{\#\# 8 0.332            1}
\NormalTok{\#\# 9 0.395            1}
\end{Highlighting}
\end{Shaded}

Not bad. Using \textbf{logistic regression} we can:

\begin{itemize}
\tightlist
\item
  understand the relationship between variables where the outcome is categorical (two categories)
\item
  make predictions
\end{itemize}

Now that we have the model coefficients, we can predict some values and plot them.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{BAC\_vals }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\FloatTok{0.01}\NormalTok{)}
\NormalTok{y\_preds }\OtherTok{\textless{}{-}} \FunctionTok{plogis}\NormalTok{(intercept }\SpecialCharTok{+}\NormalTok{ slope }\SpecialCharTok{*}\NormalTok{ BAC\_vals)}

\NormalTok{mdl\_preds }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(BAC\_vals, y\_preds)}
\NormalTok{mdl\_preds}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 41 x 2}
\NormalTok{\#\#    BAC\_vals y\_preds}
\NormalTok{\#\#       \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}}
\NormalTok{\#\#  1     0     0.0255}
\NormalTok{\#\#  2     0.01  0.0298}
\NormalTok{\#\#  3     0.02  0.0349}
\NormalTok{\#\#  4     0.03  0.0407}
\NormalTok{\#\#  5     0.04  0.0475}
\NormalTok{\#\#  6     0.05  0.0553}
\NormalTok{\#\#  7     0.06  0.0644}
\NormalTok{\#\#  8     0.07  0.0748}
\NormalTok{\#\#  9     0.08  0.0867}
\NormalTok{\#\# 10     0.09  0.100 }
\NormalTok{\#\# \# i 31 more rows}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ BAC, }\AttributeTok{y =}\NormalTok{ speech\_error)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{4}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mdl\_preds,}
            \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ BAC\_vals, }\AttributeTok{y =}\NormalTok{ y\_preds)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{main_files/figure-latex/unnamed-chunk-299-1.pdf}

\subsection{Dative Dataset}\label{dative-dataset}

Let us now turn to another dataset we discussed earlier in the semester. This is the dative dataset by Bresnan et al.~(2007). The main goal of the experiment was to identify the factors in determining the dative alternation in English:

\begin{itemize}
\tightlist
\item
  Alex gave Sam a book. (NP NP)
\item
  Alex gave a book to Sam. (NP PP)
\end{itemize}

The dative data set can be found directly using the \texttt{languageR} library. Let us take a look at the columns in the dataset and also some values to get a sense of what it looks like.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(languageR)}

\FunctionTok{colnames}\NormalTok{(dative)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#  [1] "Speaker"                "Modality"               "Verb"                  }
\NormalTok{\#\#  [4] "SemanticClass"          "LengthOfRecipient"      "AnimacyOfRec"          }
\NormalTok{\#\#  [7] "DefinOfRec"             "PronomOfRec"            "LengthOfTheme"         }
\NormalTok{\#\# [10] "AnimacyOfTheme"         "DefinOfTheme"           "PronomOfTheme"         }
\NormalTok{\#\# [13] "RealizationOfRecipient" "AccessOfRec"            "AccessOfTheme"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(dative,}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   Speaker Modality Verb SemanticClass LengthOfRecipient AnimacyOfRec DefinOfRec}
\NormalTok{\#\# 1    \textless{}NA\textgreater{}  written feed             t                 1      animate   definite}
\NormalTok{\#\# 2    \textless{}NA\textgreater{}  written give             a                 2      animate   definite}
\NormalTok{\#\# 3    \textless{}NA\textgreater{}  written give             a                 1      animate   definite}
\NormalTok{\#\#     PronomOfRec LengthOfTheme AnimacyOfTheme DefinOfTheme PronomOfTheme}
\NormalTok{\#\# 1    pronominal            14      inanimate   indefinite nonpronominal}
\NormalTok{\#\# 2 nonpronominal             3      inanimate   indefinite nonpronominal}
\NormalTok{\#\# 3 nonpronominal            13      inanimate     definite nonpronominal}
\NormalTok{\#\#   RealizationOfRecipient AccessOfRec AccessOfTheme}
\NormalTok{\#\# 1                     NP       given           new}
\NormalTok{\#\# 2                     NP       given           new}
\NormalTok{\#\# 3                     NP       given           new}
\end{Highlighting}
\end{Shaded}

Next, let us take a look at the possible values for the RealizationOfRecipient column to see what they look like.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(dative}\SpecialCharTok{$}\NormalTok{RealizationOfRecipient)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "NP" "PP"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(dative}\SpecialCharTok{$}\NormalTok{AnimacyOfRec)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] "animate"   "inanimate"}
\end{Highlighting}
\end{Shaded}

OK so, we have only two values. This is a good task for logistic regression. Let us for now model the RealizationOfRecipient as a function of the AnimacyOfRec.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_1 }\OtherTok{\textless{}{-}}\NormalTok{ model }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(RealizationOfRecipient }\SpecialCharTok{\textasciitilde{}}\NormalTok{ AnimacyOfRec, dative, }\AttributeTok{family=}\StringTok{\textquotesingle{}binomial\textquotesingle{}}\NormalTok{)}

\FunctionTok{tidy}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 5}
\NormalTok{\#\#   term                  estimate std.error statistic   p.value}
\NormalTok{\#\#   \textless{}chr\textgreater{}                    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)              {-}1.15    0.0426    {-}27.1  1.15e{-}161}
\NormalTok{\#\# 2 AnimacyOfRecinanimate     1.23    0.136       9.02 1.87e{-} 19}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_2 }\OtherTok{\textless{}{-}}\FunctionTok{glm}\NormalTok{(RealizationOfRecipient }\SpecialCharTok{\textasciitilde{}}\NormalTok{ AnimacyOfRec}\SpecialCharTok{+}\NormalTok{LengthOfTheme}\SpecialCharTok{+}\NormalTok{LengthOfRecipient}\SpecialCharTok{+}\NormalTok{AnimacyOfTheme, dative, }\AttributeTok{family=}\StringTok{\textquotesingle{}binomial\textquotesingle{}}\NormalTok{)}

\FunctionTok{tidy}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# \# A tibble: 2 x 5}
\NormalTok{\#\#   term                  estimate std.error statistic   p.value}
\NormalTok{\#\#   \textless{}chr\textgreater{}                    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\NormalTok{\#\# 1 (Intercept)              {-}1.15    0.0426    {-}27.1  1.15e{-}161}
\NormalTok{\#\# 2 AnimacyOfRecinanimate     1.23    0.136       9.02 1.87e{-} 19}
\end{Highlighting}
\end{Shaded}

Now let us compare the two models.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lmtest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: zoo
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'zoo'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lr\_test }\OtherTok{\textless{}{-}} \FunctionTok{lrtest}\NormalTok{(model\_1, model\_2)}
\FunctionTok{print}\NormalTok{(lr\_test)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# Likelihood ratio test}
\NormalTok{\#\# }
\NormalTok{\#\# Model 1: RealizationOfRecipient \textasciitilde{} AnimacyOfRec}
\NormalTok{\#\# Model 2: RealizationOfRecipient \textasciitilde{} AnimacyOfRec + LengthOfTheme + LengthOfRecipient + }
\NormalTok{\#\#     AnimacyOfTheme}
\NormalTok{\#\#   \#Df  LogLik Df  Chisq Pr(\textgreater{}Chisq)    }
\NormalTok{\#\# 1   2 {-}1831.1                         }
\NormalTok{\#\# 2   5 {-}1379.5  3 903.19  \textless{} 2.2e{-}16 ***}
\NormalTok{\#\# {-}{-}{-}}
\NormalTok{\#\# Signif. codes:  0 \textquotesingle{}***\textquotesingle{} 0.001 \textquotesingle{}**\textquotesingle{} 0.01 \textquotesingle{}*\textquotesingle{} 0.05 \textquotesingle{}.\textquotesingle{} 0.1 \textquotesingle{} \textquotesingle{} 1}
\end{Highlighting}
\end{Shaded}

\section{Testing the model}\label{testing-the-model}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test\_data }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(dative, AnimacyOfRec,LengthOfTheme,LengthOfRecipient,AnimacyOfTheme,RealizationOfRecipient)}
\FunctionTok{head}\NormalTok{(test\_data)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\#   AnimacyOfRec LengthOfTheme LengthOfRecipient AnimacyOfTheme}
\NormalTok{\#\# 1      animate            14                 1      inanimate}
\NormalTok{\#\# 2      animate             3                 2      inanimate}
\NormalTok{\#\# 3      animate            13                 1      inanimate}
\NormalTok{\#\# 4      animate             5                 1      inanimate}
\NormalTok{\#\# 5      animate             3                 2      inanimate}
\NormalTok{\#\# 6      animate             4                 2      inanimate}
\NormalTok{\#\#   RealizationOfRecipient}
\NormalTok{\#\# 1                     NP}
\NormalTok{\#\# 2                     NP}
\NormalTok{\#\# 3                     NP}
\NormalTok{\#\# 4                     NP}
\NormalTok{\#\# 5                     NP}
\NormalTok{\#\# 6                     NP}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make predictions on the test set}
\NormalTok{predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model, }\AttributeTok{newdata =}\NormalTok{ test\_data, }\AttributeTok{type =} \StringTok{"response"}\NormalTok{)}


\CommentTok{\# For binary classification, calculate accuracy}
\NormalTok{predicted\_classes }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(predictions }\SpecialCharTok{\textgreater{}} \FloatTok{0.5}\NormalTok{, }\StringTok{\textquotesingle{}PP\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}NP\textquotesingle{}}\NormalTok{)}


\NormalTok{accuracy }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(predicted\_classes }\SpecialCharTok{==}\NormalTok{ test\_data}\SpecialCharTok{$}\NormalTok{RealizationOfRecipient)}

\NormalTok{accuracy}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#\# [1] 0.7425682}
\end{Highlighting}
\end{Shaded}


  \bibliography{book.bib,packages.bib}

\end{document}
